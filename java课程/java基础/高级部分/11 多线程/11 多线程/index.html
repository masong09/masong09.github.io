
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>多线程 - 我的文档</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="我的文档" class="md-header__button md-logo" aria-label="我的文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            我的文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              多线程
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/01%20Java%E6%A6%82%E8%BF%B0/01%20-%20Java%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0/" class="md-tabs__link md-tabs__link--active">
        Java课程
      </a>
    </li>
  

  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC1%E7%AB%A0%20%E9%9D%A2%E8%AF%95%E8%AF%B4%E6%98%8E/" class="md-tabs__link">
        Java就业面试
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../.." class="md-tabs__link">
      学习文档
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="我的文档" class="md-nav__button md-logo" aria-label="我的文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    我的文档
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Java课程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java课程" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Java课程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1" type="checkbox" id="__nav_1_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1">
          Java基础
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java基础" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          Java基础
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_1" type="checkbox" id="__nav_1_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1_1">
          基础部分
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="基础部分" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_1">
          <span class="md-nav__icon md-icon"></span>
          基础部分
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/01%20Java%E6%A6%82%E8%BF%B0/01%20-%20Java%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0/" class="md-nav__link">
        Java概述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/02%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/02%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        基本语法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/03%20%E6%95%B0%E7%BB%84/03%20%E6%95%B0%E7%BB%84/" class="md-nav__link">
        数组
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/04%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/04%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" class="md-nav__link">
        面向对象
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/05%20%E5%BC%82%E5%B8%B8/05%20%E5%BC%82%E5%B8%B8/" class="md-nav__link">
        异常
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_2" type="checkbox" id="__nav_1_1_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1_2">
          高级部分
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="高级部分" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_2">
          <span class="md-nav__icon md-icon"></span>
          高级部分
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../06%20%E5%B8%B8%E7%94%A8%E7%B1%BBAPI/06%20%E5%B8%B8%E7%94%A8%E7%B1%BBAPI/" class="md-nav__link">
        常用类API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../07%20%E9%9B%86%E5%90%88/07%20%E9%9B%86%E5%90%88/" class="md-nav__link">
        集合
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../08%20%E6%B3%9B%E5%9E%8B/08%20%E6%B3%9B%E5%9E%8B/" class="md-nav__link">
        泛型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../09%20File%E7%B1%BB%E4%B8%8EIO%E6%B5%81/09%20File%E7%B1%BB%E4%B8%8EIO%E6%B5%81/" class="md-nav__link">
        File类与IO流
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../10%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/10%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        网络编程
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          多线程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        多线程
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1.并发与并行
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 线程与进程
  </a>
  
    <nav class="md-nav" aria-label="2. 线程与进程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 举例说明
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 多线程的优点与应用场景
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 线程调度
  </a>
  
    <nav class="md-nav" aria-label="3. 线程调度">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 抢占式调度详解
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-java" class="md-nav__link">
    4. Java线程的创建
  </a>
  
    <nav class="md-nav" aria-label="4. Java线程的创建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 创建与启动
  </a>
  
    <nav class="md-nav" aria-label="4.1 创建与启动">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-thread" class="md-nav__link">
    4.1.1 继承Thread类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-runnable" class="md-nav__link">
    4.1.2 实现Runnable接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413" class="md-nav__link">
    4.1.3 匿名内部类对象创建线程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-callable" class="md-nav__link">
    4.1.4 实现Callable接口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-threadrunnable" class="md-nav__link">
    4.2 Thread类与Runnable接口的比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-thread" class="md-nav__link">
    5. Thread类
  </a>
  
    <nav class="md-nav" aria-label="5. Thread类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    5.1 构造方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    5.2 线程使用基础方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53" class="md-nav__link">
    5.3 线程控制常见方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54" class="md-nav__link">
    5.4 代码示例
  </a>
  
    <nav class="md-nav" aria-label="5.4 代码示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-join" class="md-nav__link">
    5.4.1 强行加塞：join()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-interrupt" class="md-nav__link">
    5.4.2 中断操作：interrupt()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-setdaemontrue" class="md-nav__link">
    5.4.3 设置守护线程：setDaemon(true)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#544" class="md-nav__link">
    5.4.4 小案例：龟兔赛跑
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. 线程的生命周期
  </a>
  
    <nav class="md-nav" aria-label="6. 线程的生命周期">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1 传统线程模型的五种线程状态
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-jdk" class="md-nav__link">
    6.2 JDK定义的六种线程状态
  </a>
  
    <nav class="md-nav" aria-label="6.2 JDK定义的六种线程状态">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621-new" class="md-nav__link">
    6.2.1 NEW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-runnable" class="md-nav__link">
    6.2.2 RUNNABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-blocked" class="md-nav__link">
    6.2.3 BLOCKED
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#624-waiting" class="md-nav__link">
    6.2.4 WAITING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#625-timed_waiting" class="md-nav__link">
    6.2.5 TIMED_WAITING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#626-terminated" class="md-nav__link">
    6.2.6 TERMINATED
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7. 程序状态转换
  </a>
  
    <nav class="md-nav" aria-label="7. 程序状态转换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-blockedrunnable" class="md-nav__link">
    7.1 BLOCKED与RUNNABLE状态的转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-timed_waitingrunnable" class="md-nav__link">
    7.2 TIMED_WAITING与RUNNABLE状态转换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8. 线程中断
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9. 线程安全
  </a>
  
    <nav class="md-nav" aria-label="9. 线程安全">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 线程安全问题引出
  </a>
  
    <nav class="md-nav" aria-label="9.1 线程安全问题引出">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#911" class="md-nav__link">
    9.1.1 静态变量是共享的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#912" class="md-nav__link">
    9.1.2 同一个对象的实例变量共享
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 线程安全问题原因分析
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93" class="md-nav__link">
    9.3 线程安全问题解决方式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    9.4 锁对象选择
  </a>
  
    <nav class="md-nav" aria-label="9.4 锁对象选择">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#941" class="md-nav__link">
    9.4.1 同步方法的锁对象问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#942" class="md-nav__link">
    9.4.2 同步代码块的锁对象
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95" class="md-nav__link">
    9.5 买票问题优化写法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#96" class="md-nav__link">
    9.6 锁的范围问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#97" class="md-nav__link">
    9.7 单例设计模式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10. 线程间的通信
  </a>
  
    <nav class="md-nav" aria-label="10. 线程间的通信">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101" class="md-nav__link">
    10.1 等待唤醒机制
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102" class="md-nav__link">
    10.2 案例：
  </a>
  
    <nav class="md-nav" aria-label="10.2 案例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1021" class="md-nav__link">
    10.2.1 生产者与消费者问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1022" class="md-nav__link">
    10.2.2 循环打印
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1023" class="md-nav__link">
    10.2.3 三个线程循环打印
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103" class="md-nav__link">
    10.3 释放锁操作与死锁
  </a>
  
    <nav class="md-nav" aria-label="10.3 释放锁操作与死锁">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1031" class="md-nav__link">
    10.3.1 释放锁的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1032" class="md-nav__link">
    10.3.2 不会释放锁的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1033" class="md-nav__link">
    10.3.3 死锁
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-sleepwait" class="md-nav__link">
    10.4 面试题：sleep()和wait()方法的区别
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-threadlocal" class="md-nav__link">
    11. ThreadLocal类简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-inheritablethreadlocal" class="md-nav__link">
    12. InheritableThreadLocal
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12%20%E5%8F%8D%E5%B0%84/12%20%E5%8F%8D%E5%B0%84/" class="md-nav__link">
        反射
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../13%20Java8%E6%96%B0%E7%89%B9%E6%80%A7/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" class="md-nav__link">
        Java8新特性
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_2">
          MySQL数据库
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MySQL数据库" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          MySQL数据库
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/14%20MySQL/MySQL5.7%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3/" class="md-nav__link">
        MySQL5.7安装文档
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/14%20MySQL/MySQL%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        MySQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/14%20MySQL/JDBC%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        JDBC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_3">
          JavaWeb阶段
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="JavaWeb阶段" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          JavaWeb阶段
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day01/day01_HTML%26CSS/" class="md-nav__link">
        HTML&CSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day02/day02_JS%26%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="md-nav__link">
        JS&正则表达式
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day03/day03_VUE%26%E4%B9%A6%E5%9F%8E%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        VUE&书城第一阶段
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day04/day04_XML%26Tomcat%26Http%E5%8D%8F%E8%AE%AE/" class="md-nav__link">
        XML&Tomcat&Http协议
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day05/day05_Servlet/" class="md-nav__link">
        Servlet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day06/day06_Request%26Response/" class="md-nav__link">
        Request&Response
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day07/day07_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第二阶
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day08/day08_Thymeleaf/" class="md-nav__link">
        Thymeleaf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day09/day09_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第三阶段
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day10/day10_%E4%BC%9A%E8%AF%9D%26%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5%281%29/" class="md-nav__link">
        会话&书城项目第四阶段1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day11/day11_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第四阶段2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day12/day12_Filter%26Listener%26%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%BA%94%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        Filter&Listener&书城项目第五阶段1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day13/day13_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%BA%94%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第五阶段2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../JavaWeb%E9%98%B6%E6%AE%B5/day14/day14_Ajax%26Axios%26%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E5%85%AD%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        Ajax&Axios&书城项目第六阶段
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4">
          经典框架
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="经典框架" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          经典框架
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/Spring%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        Spring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/SpringMVC%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        SpringMVC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/MyBatis%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        MyBatis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/SSM%20%E6%95%B4%E5%90%88%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        SSM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/Maven%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        Maven
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/%E6%A1%86%E6%9E%B6%E9%AB%98%E7%BA%A7%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97%E4%B9%8BLinuxCentOS7/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/Redis/" class="md-nav__link">
        Redis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          微服务相关
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="微服务相关" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          微服务相关
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%B8%E5%85%B3/Docker/Docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%B8%E5%85%B3/ElasticSearch/ElasticSearch/" class="md-nav__link">
        ElasticSearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%B8%E5%85%B3/RabbitMQ/RabbitMQ/" class="md-nav__link">
        RabbitMQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%B8%E5%85%B3/SpringBoot/SpringBoot/" class="md-nav__link">
        SpringBoot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%B8%E5%85%B3/SpringCloud/SpringCloud/" class="md-nav__link">
        SpringCloud
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6">
          高级技术
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="高级技术" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          高级技术
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/git/Git%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/juc/JUC/" class="md-nav__link">
        JUC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/jvm/jvm/" class="md-nav__link">
        jvm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/mysql%E9%AB%98%E7%BA%A7/MySQL%E9%AB%98%E7%BA%A7/" class="md-nav__link">
        mysql高级
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/mysql%E9%AB%98%E7%BA%A7/MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/" class="md-nav__link">
        MySQL主从复制
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/MyCat/Mycat/" class="md-nav__link">
        MyCat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/nginx/Nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" type="checkbox" id="__nav_1_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7">
          项目文档
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="项目文档" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          项目文档
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_1" type="checkbox" id="__nav_1_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_1">
          美年旅游
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="美年旅游" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_1">
          <span class="md-nav__icon md-icon"></span>
          美年旅游
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day01/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC1%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游01
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day02/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC2%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day03/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC3%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day04/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC4%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day05/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC5%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游05
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day06/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC6%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游06
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day07/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC7%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游07
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day08/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC8%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游08
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day09/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC9%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游09
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day10/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC10%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day11/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC11%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游11
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_2" type="checkbox" id="__nav_1_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_2">
          尚邻网
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="尚邻网" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_2">
          <span class="md-nav__icon md-icon"></span>
          尚邻网
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/1.%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        搭建环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/2.%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86/" class="md-nav__link">
        用户角色管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/3.Apache%20Dubbo/" class="md-nav__link">
        Apache Dubbo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/4.%E6%9C%8D%E5%8A%A1%E6%8B%86%E5%88%86/" class="md-nav__link">
        服务拆分
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/5.%E4%BA%8C%E6%89%8B%E6%88%BF%E7%AE%A1%E7%90%86/" class="md-nav__link">
        二手房管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/6.%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/" class="md-nav__link">
        图片上传
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/7.%E5%89%8D%E7%AB%AF%E6%88%BF%E6%BA%90%E5%B1%95%E7%A4%BA/" class="md-nav__link">
        前端房源展示
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/8.%E5%89%8D%E7%AB%AF%E7%99%BB%E5%BD%95%E4%B8%8E%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%85%B3%E6%B3%A8/" class="md-nav__link">
        前端登录与注册与关注
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/9.%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" class="md-nav__link">
        权限管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/10.spring%20security/" class="md-nav__link">
        spring security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/11.session%E5%85%B1%E4%BA%AB/" class="md-nav__link">
        session共享
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_3" type="checkbox" id="__nav_1_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_3">
          谷粒商城
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="谷粒商城" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_3">
          <span class="md-nav__icon md-icon"></span>
          谷粒商城
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/1.%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%88nginx%E3%80%81cors%E3%80%81oss%EF%BC%89/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        谷粒商城01
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/2.%E5%88%86%E7%B1%BB%E3%80%81%E8%A7%84%E6%A0%BC%E3%80%81%E5%95%86%E5%93%81%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/%E8%A7%84%E6%A0%BC%E5%8F%82%E6%95%B0%E5%8F%8A%E5%95%86%E5%93%81%E6%96%B0%E5%A2%9E/" class="md-nav__link">
        谷粒商城02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/3.%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%8F%8Aseata/%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%8F%8Aseata/" class="md-nav__link">
        谷粒商城03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/4.elasticsearch%28DSL%E5%8F%8ASpringData-Elasticsearch%29/elasticsearch/" class="md-nav__link">
        谷粒商城04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/5.%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2/%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2/" class="md-nav__link">
        谷粒商城05
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/6.%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%EF%BC%88Thymeleaf%EF%BC%89%E5%8F%8A%E6%90%9C%E7%B4%A2%E9%A1%B5%E6%B8%B2%E6%9F%93/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-Thymeleaf/" class="md-nav__link">
        谷粒商城06
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/7.%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%EF%BC%88RabbitMQ%EF%BC%89/%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/" class="md-nav__link">
        谷粒商城07
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/8.%E5%95%86%E5%93%81%E5%88%86%E7%B1%BB%28%E7%BC%93%E5%AD%98%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E3%80%81Redisson%E3%80%81%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8%29/%E9%A6%96%E9%A1%B5%E5%95%86%E5%93%81%E5%88%86%E7%B1%BB/" class="md-nav__link">
        谷粒商城08
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/9.%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5%E5%8F%8A%E5%BC%82%E6%AD%A5%E7%BC%96%E6%8E%92%EF%BC%88CompletableFuture%EF%BC%89/%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5/" class="md-nav__link">
        谷粒商城09
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/10.%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%88jwt%EF%BC%89/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%88jwt%EF%BC%89/" class="md-nav__link">
        谷粒商城10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/11.%E8%B4%AD%E7%89%A9%E8%BD%A6%EF%BC%88SpringTask%EF%BC%89/%E8%B4%AD%E7%89%A9%E8%BD%A6/" class="md-nav__link">
        谷粒商城11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/12.%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%88xxl-job%EF%BC%89/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%88xxl-job%EF%BC%89/" class="md-nav__link">
        谷粒商城12
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/13.%E8%AE%A2%E5%8D%95%E3%80%81%E5%BA%93%E5%AD%98/%E8%AE%A2%E5%8D%95%E3%80%81%E5%BA%93%E5%AD%98/" class="md-nav__link">
        谷粒商城13
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/14.%E6%94%AF%E4%BB%98%E3%80%81%E7%A7%92%E6%9D%80/%E6%94%AF%E4%BB%98%E3%80%81%E7%A7%92%E6%9D%80/" class="md-nav__link">
        谷粒商城14
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_4" type="checkbox" id="__nav_1_7_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_4">
          尚融宝
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="尚融宝" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_4">
          <span class="md-nav__icon md-icon"></span>
          尚融宝
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part01-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D/Part01-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        项目介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part02-MyBatis-Plus/Part02-MyBatis-Plus/" class="md-nav__link">
        MyBatis-Plus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part03-%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E5%B7%A5%E7%A8%8B%E6%90%AD%E5%BB%BA/Part03-%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E5%B7%A5%E7%A8%8B%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        后端接口工程搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part04-%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/Part04-%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/" class="md-nav__link">
        前端知识
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part05-%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/Part05-%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        管理平台前端搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part06-Alibaba%20EasyExcel/Part06-Alibaba%20EasyExcel/" class="md-nav__link">
        Alibaba EasyExcel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part07-%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/Part07-%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/" class="md-nav__link">
        数据字典
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part08-Redis%E7%BC%93%E5%AD%98/Part08-Redis%E7%BC%93%E5%AD%98/" class="md-nav__link">
        Redis缓存
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part09-NuxtJS%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B8%B2%E6%9F%93/Part09-NuxtJS%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B8%B2%E6%9F%93/" class="md-nav__link">
        NuxtJS服务器端渲染
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part10-%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1/Part10-%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1/" class="md-nav__link">
        阿里云短信
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java课程/项目文档/尚融宝/Part11-分布式文件系统-阿里云OSS/分布式文件系统-阿里云OSS" class="md-nav__link">
        阿里云OSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part12-%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/Part12-%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/" class="md-nav__link">
        用户注册
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part13-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C/Part13-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C/" class="md-nav__link">
        访问令牌
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part14-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81/Part14-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81/" class="md-nav__link">
        用户认证
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part15-%E4%BC%9A%E5%91%98%E7%AE%A1%E7%90%86/Part15-%E4%BC%9A%E5%91%98%E7%AE%A1%E7%90%86/" class="md-nav__link">
        会员管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part16-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-OAuth2/Part16-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-OAuth2/" class="md-nav__link">
        OAuth2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part17-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/Part17-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" class="md-nav__link">
        内网穿透
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part18-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/Part18-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/" class="md-nav__link">
        微信登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part19-%20SpringCloud/Part19-%20SpringCloud/" class="md-nav__link">
        SpringCloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part20-%E8%B4%A6%E6%88%B7%E7%BB%91%E5%AE%9A/Part20-%E8%B4%A6%E6%88%B7%E7%BB%91%E5%AE%9A/" class="md-nav__link">
        账户绑定
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part21-%E7%94%B3%E8%AF%B7%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6/Part21-%E7%94%B3%E8%AF%B7%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6/" class="md-nav__link">
        申请借款额度
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part22-%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6%E5%AE%A1%E6%A0%B8/Part22-%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6%E5%AE%A1%E6%A0%B8/" class="md-nav__link">
        借款额度审核
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part23-%E5%80%9F%E6%AC%BE%E7%94%B3%E8%AF%B7/Part23-%E5%80%9F%E6%AC%BE%E7%94%B3%E8%AF%B7/" class="md-nav__link">
        借款申请
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part24-%E5%80%9F%E6%AC%BE%E5%AE%A1%E6%A0%B8/Part24-%E5%80%9F%E6%AC%BE%E5%AE%A1%E6%A0%B8/" class="md-nav__link">
        借款审核
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part25-%E6%A0%87%E7%9A%84%E7%AE%A1%E7%90%86/Part25-%E6%A0%87%E7%9A%84%E7%AE%A1%E7%90%86/" class="md-nav__link">
        标的管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part26-%E6%88%91%E8%A6%81%E6%8A%95%E8%B5%84/Part26-%E6%88%91%E8%A6%81%E6%8A%95%E8%B5%84/" class="md-nav__link">
        我要投资
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part27-%E5%85%85%E5%80%BC/Part27-%E5%85%85%E5%80%BC/" class="md-nav__link">
        充值
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part28-%E6%8A%95%E6%A0%87/Part28-%E6%8A%95%E6%A0%87/" class="md-nav__link">
        投标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part29-%E6%94%BE%E6%AC%BE/Part29-%E6%94%BE%E6%AC%BE/" class="md-nav__link">
        放款
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part30-%E6%8A%95%E8%B5%84%E5%88%97%E8%A1%A8%E5%B1%95%E7%A4%BA/Part30-%E6%8A%95%E8%B5%84%E5%88%97%E8%A1%A8%E5%B1%95%E7%A4%BA/" class="md-nav__link">
        投资列表展示
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part31-%E6%8F%90%E7%8E%B0%E5%92%8C%E8%BF%98%E6%AC%BE/Part31-%E6%8F%90%E7%8E%B0%E5%92%8C%E8%BF%98%E6%AC%BE/" class="md-nav__link">
        提现和还款
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part32-%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83/Part32-%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83/" class="md-nav__link">
        个人中心
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part33-%E7%BD%91%E5%85%B3/Part33-%E7%BD%91%E5%85%B3/" class="md-nav__link">
        网关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part34-%E8%A1%A5%E5%85%85/Part34-%E8%A1%A5%E5%85%85/" class="md-nav__link">
        补充
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part35-%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/Part35-%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/" class="md-nav__link">
        微信支付
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_5" type="checkbox" id="__nav_1_7_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_5">
          尚医通
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="尚医通" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_5">
          <span class="md-nav__icon md-icon"></span>
          尚医通
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day01%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E4%B8%8EMyBatis%20Plus/day01%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E4%B8%8E%20Mybatis%20Plus/" class="md-nav__link">
        项目介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day02%20%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%E5%92%8C%E5%8C%BB%E9%99%A2%E8%AE%BE%E7%BD%AE/day02%20%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%E5%92%8C%E5%8C%BB%E9%99%A2%E8%AE%BE%E7%BD%AE/" class="md-nav__link">
        搭建环境和医院设置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day03%20%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/day03%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/" class="md-nav__link">
        前端基础知识（一）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day04%20%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E4%BA%8C%EF%BC%89/day04%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="md-nav__link">
        前端基础知识（二）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day05%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/day05%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        平台管理前端搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day06%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/day06%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/" class="md-nav__link">
        数据字典
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day07mongodb/day07mongodb/" class="md-nav__link">
        mongodb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day08%E5%8C%BB%E9%99%A2%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3/day08%E5%8C%BB%E9%99%A2%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3/" class="md-nav__link">
        医院上传接口
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day09%E5%8C%BB%E9%99%A2%E7%AE%A1%E7%90%86/day09%E5%8C%BB%E9%99%A2%E7%AE%A1%E7%90%86/" class="md-nav__link">
        医院管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day10%E6%8E%92%E7%8F%AD%E7%AE%A1%E7%90%86%E5%92%8C%E7%BD%91%E5%85%B3/day10%E6%8E%92%E7%8F%AD%E7%AE%A1%E7%90%86%E5%92%8C%E7%BD%91%E5%85%B3/" class="md-nav__link">
        排班管理和网关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day11%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%A6%96%E9%A1%B5/day11%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%A6%96%E9%A1%B5/" class="md-nav__link">
        平台前端搭建与首页
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day12%E6%89%8B%E6%9C%BA%E7%99%BB%E5%BD%95/day12%E6%89%8B%E6%9C%BA%E7%99%BB%E5%BD%95/" class="md-nav__link">
        手机登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day13%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/day13%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/" class="md-nav__link">
        微信登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day14%E9%98%BF%E9%87%8C%E4%BA%91OSS%E3%80%81%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%B0%B1%E8%AF%8A%E4%BA%BA/day14%E9%98%BF%E9%87%8C%E4%BA%91OSS%E3%80%81%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%B0%B1%E8%AF%8A%E4%BA%BA/" class="md-nav__link">
        阿里云OSS、用户认证与就诊人
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day15%E9%A2%84%E7%BA%A6%E6%8C%82%E5%8F%B7/day15%E9%A2%84%E7%BA%A6%E6%8C%82%E5%8F%B7/" class="md-nav__link">
        预约挂号
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day16%E9%A2%84%E7%BA%A6%E4%B8%8B%E5%8D%95/day16%E9%A2%84%E7%BA%A6%E4%B8%8B%E5%8D%95/" class="md-nav__link">
        预约下单
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day17%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/day17%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/" class="md-nav__link">
        微信支付
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day18%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E4%B8%8E%E7%BB%9F%E8%AE%A1/day18%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E4%B8%8E%E7%BB%9F%E8%AE%A1/" class="md-nav__link">
        定时任务与统计
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Java就业面试
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java就业面试" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Java就业面试
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC1%E7%AB%A0%20%E9%9D%A2%E8%AF%95%E8%AF%B4%E6%98%8E/" class="md-nav__link">
        第1章 面试说明
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC2%E7%AB%A0%20%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81/" class="md-nav__link">
        第2章 手写代码
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC3%E7%AB%A0%20JavaSE/" class="md-nav__link">
        第3章 JavaSE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC4%E7%AB%A0%20JVM/" class="md-nav__link">
        第4章 JVM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC5%E7%AB%A0%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="md-nav__link">
        第5章 设计模式
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC6%E7%AB%A0%20MySql/" class="md-nav__link">
        第6章 MySql
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC7%E7%AB%A0%20Java%20Web/" class="md-nav__link">
        第7章 Java Web
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC8%E7%AB%A0%20SSM%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        第8章 SSM框架
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC9%E7%AB%A0%20SpringBoot/" class="md-nav__link">
        第9章 SpringBoot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC10%E7%AB%A0%20SpringCloud/" class="md-nav__link">
        第10章 SpringCloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC11%E7%AB%A0%20Redis/" class="md-nav__link">
        第11章 Redis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC12%E7%AB%A0%20MQ/" class="md-nav__link">
        第12章 MQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC13%E7%AB%A0%20ElasticSearch/" class="md-nav__link">
        第13章 ElasticSearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC14%E7%AB%A0%20Dubbo/" class="md-nav__link">
        第14章 Dubbo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC15%E7%AB%A0%20Zookeeper/" class="md-nav__link">
        第15章 Zookeeper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC16%E7%AB%A0%20Git/" class="md-nav__link">
        第16章 Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC17%E7%AB%A0%20Linux/" class="md-nav__link">
        第17章 Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        学习文档
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1.并发与并行
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 线程与进程
  </a>
  
    <nav class="md-nav" aria-label="2. 线程与进程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 举例说明
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 多线程的优点与应用场景
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 线程调度
  </a>
  
    <nav class="md-nav" aria-label="3. 线程调度">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 抢占式调度详解
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-java" class="md-nav__link">
    4. Java线程的创建
  </a>
  
    <nav class="md-nav" aria-label="4. Java线程的创建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 创建与启动
  </a>
  
    <nav class="md-nav" aria-label="4.1 创建与启动">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-thread" class="md-nav__link">
    4.1.1 继承Thread类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-runnable" class="md-nav__link">
    4.1.2 实现Runnable接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413" class="md-nav__link">
    4.1.3 匿名内部类对象创建线程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-callable" class="md-nav__link">
    4.1.4 实现Callable接口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-threadrunnable" class="md-nav__link">
    4.2 Thread类与Runnable接口的比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-thread" class="md-nav__link">
    5. Thread类
  </a>
  
    <nav class="md-nav" aria-label="5. Thread类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    5.1 构造方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    5.2 线程使用基础方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53" class="md-nav__link">
    5.3 线程控制常见方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54" class="md-nav__link">
    5.4 代码示例
  </a>
  
    <nav class="md-nav" aria-label="5.4 代码示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-join" class="md-nav__link">
    5.4.1 强行加塞：join()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-interrupt" class="md-nav__link">
    5.4.2 中断操作：interrupt()方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-setdaemontrue" class="md-nav__link">
    5.4.3 设置守护线程：setDaemon(true)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#544" class="md-nav__link">
    5.4.4 小案例：龟兔赛跑
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. 线程的生命周期
  </a>
  
    <nav class="md-nav" aria-label="6. 线程的生命周期">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1 传统线程模型的五种线程状态
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-jdk" class="md-nav__link">
    6.2 JDK定义的六种线程状态
  </a>
  
    <nav class="md-nav" aria-label="6.2 JDK定义的六种线程状态">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621-new" class="md-nav__link">
    6.2.1 NEW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-runnable" class="md-nav__link">
    6.2.2 RUNNABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-blocked" class="md-nav__link">
    6.2.3 BLOCKED
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#624-waiting" class="md-nav__link">
    6.2.4 WAITING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#625-timed_waiting" class="md-nav__link">
    6.2.5 TIMED_WAITING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#626-terminated" class="md-nav__link">
    6.2.6 TERMINATED
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7. 程序状态转换
  </a>
  
    <nav class="md-nav" aria-label="7. 程序状态转换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-blockedrunnable" class="md-nav__link">
    7.1 BLOCKED与RUNNABLE状态的转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-timed_waitingrunnable" class="md-nav__link">
    7.2 TIMED_WAITING与RUNNABLE状态转换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8. 线程中断
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9. 线程安全
  </a>
  
    <nav class="md-nav" aria-label="9. 线程安全">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 线程安全问题引出
  </a>
  
    <nav class="md-nav" aria-label="9.1 线程安全问题引出">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#911" class="md-nav__link">
    9.1.1 静态变量是共享的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#912" class="md-nav__link">
    9.1.2 同一个对象的实例变量共享
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 线程安全问题原因分析
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93" class="md-nav__link">
    9.3 线程安全问题解决方式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    9.4 锁对象选择
  </a>
  
    <nav class="md-nav" aria-label="9.4 锁对象选择">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#941" class="md-nav__link">
    9.4.1 同步方法的锁对象问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#942" class="md-nav__link">
    9.4.2 同步代码块的锁对象
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95" class="md-nav__link">
    9.5 买票问题优化写法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#96" class="md-nav__link">
    9.6 锁的范围问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#97" class="md-nav__link">
    9.7 单例设计模式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10. 线程间的通信
  </a>
  
    <nav class="md-nav" aria-label="10. 线程间的通信">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101" class="md-nav__link">
    10.1 等待唤醒机制
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102" class="md-nav__link">
    10.2 案例：
  </a>
  
    <nav class="md-nav" aria-label="10.2 案例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1021" class="md-nav__link">
    10.2.1 生产者与消费者问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1022" class="md-nav__link">
    10.2.2 循环打印
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1023" class="md-nav__link">
    10.2.3 三个线程循环打印
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103" class="md-nav__link">
    10.3 释放锁操作与死锁
  </a>
  
    <nav class="md-nav" aria-label="10.3 释放锁操作与死锁">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1031" class="md-nav__link">
    10.3.1 释放锁的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1032" class="md-nav__link">
    10.3.2 不会释放锁的操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1033" class="md-nav__link">
    10.3.3 死锁
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-sleepwait" class="md-nav__link">
    10.4 面试题：sleep()和wait()方法的区别
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-threadlocal" class="md-nav__link">
    11. ThreadLocal类简介
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-inheritablethreadlocal" class="md-nav__link">
    12. InheritableThreadLocal
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="_1">线程的相关概念<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1.并发与并行<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<ul>
<li>并行（parallel）：指多个事件任务在同一时刻发生（同时发生）。指在同一时刻，有多条指令在
    多个处理器上同时执行。单核CPU同一时刻只能处理一条指令，所以单核CPU做不到并行处理。</li>
<li>并发（concurrency）：指两个或多个事件在同一个微小的时间段内发生。指在同一个时刻只能有
    一条指令执行，但多个进程的指令被快速轮换执行，使得在宏观上具有多个进程同时执行的效果。
    程序并发执行可以在有限条件下，充分利用CPU资源，这是我们研究的重点。</li>
</ul>
<p><img alt="image-20200918084557015" src="../imgs/image-20200918084557015.png" /></p>
<p>在操作系统中，安装了多个程序，并发指的是在一段时间内宏观上有多个程序同时运行，这在单 CPU系统中，每一时刻只能有一个程序执行，即微观上这些程序是分时的交替运行，只不过是给人的感觉是同时运行，那是因为分时交替运行的时间是非常短的。</p>
<p>而在多个 CPU 系统中，则这些可以并发执行的程序便可以分配到多个处理器上（CPU），实现多任务并行执行，即利用每个处理器来处理一个可以并发执行的程序，这样多个程序便可以同时执行。目前电脑市场上说的多核 CPU，便是多核处理器，核越多，并行处理的程序越多，能大大的提高电脑运行的效率。</p>
<blockquote>
<p>注意：单核处理器的计算机肯定是不能并行的处理多个任务的，只能是多个任务在单个CPU上并发运行。同理，线程也是一样的，从宏观角度上理解线程是并行运行的，但是从微观角度上分析却是串行运行的，即一个线程一个线程的去运行，当系统只有一个CPU时，线程会以某种顺序执行多个线程，我们把这种情况称之为线程调度。</p>
</blockquote>
<ul>
<li>单核CPU：只能并发</li>
<li>多核CPU：并行+并发</li>
</ul>
<p>并行与并发举例：</p>
<ul>
<li>并行：多项工作一起执行，之后再汇总，例如：泡方便面，电水壶烧水，一边撕调料倒入桶中</li>
<li>并发：同一时刻多个线程在访问同一个资源，多个线程对一个点，例如：春运抢票、电商秒杀...</li>
</ul>
<h2 id="2">2. 线程与进程<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<ul>
<li>程序：为了完成某个任务和功能，选择一种编程语言编写的一组指令的集合。</li>
<li>软件：1个或多个应用程序+相关的素材和资源文件等构成一个软件系统。</li>
<li>进程：进程是对一个程序运行过程（创建-运行-消亡）的描述，系统会为每个运行的程序建立一个进程，并为进程分配独立的系统资源（以一个进程为单元分配系统资源），比如内存空间等资源。</li>
<li>线程：线程是进程中的一个执行单元，负责完成执行当前程序的任务，一个进程中至少有一个线程。一个进程中是可以有多个线程的，这个应用程序也可以称之为多线程程序。多线程使得程序可以并发执行，充分利用CPU资源。</li>
</ul>
<p>面试题：进程是操作系统调度和分配资源的最小单位，<strong>线程是CPU调度的最小单位</strong>。不同的进程之间是不共享内存的。进程之间的数据交换和通信的成本是很高。<strong>不同的线程是共享同一个进程的内存的。</strong>当然不同的线程也有自己独立的内存空间。对于方法区，堆中中的同一个对象的内存，线程之间是可以共享的，但是栈的局部变量永远是独立的。</p>
<h3 id="21">2.1 举例说明<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p><strong>我们可以再电脑底部任务栏，右键-----&gt;打开任务管理器,可以查看当前任务的进程</strong>：</p>
<p><img alt="image-20200918084757017" src="../imgs/image-20200918084757017.png" /></p>
<p><strong>一个应用程序的多次运行，就是多个进程</strong></p>
<p><img alt="image-20200918084807424" src="../imgs/image-20200918084807424.png" /></p>
<p><strong>一个进程中包含多个线程</strong></p>
<p><img alt="image-20200918084817697" src="../imgs/image-20200918084817697.png" /></p>
<h3 id="22">2.2 多线程的优点与应用场景<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<p>主要优点：充分利用CUP空闲时间片，用尽可能短的时间完成用户的请求。也就是使程序的响应速度更快 。</p>
<p>应用场景：</p>
<ul>
<li>多任务处理。多个用户请求服务器，服务端程序可以开启多个线程分别处理每个用户的请
    求，互不影响。</li>
<li>单个大任务处理。下载一个大文件，可以开启多个线程一起下载，减少整体下载时间。</li>
</ul>
<h2 id="3">3. 线程调度<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>指CPU资源如何分配给不同的线程。常见的两种线程调度方式：</p>
<ul>
<li>分时调度：所有线程轮流使用 CPU 的使用权，平均分配每个线程占用 CPU 的时间。</li>
<li>抢占式调度：优先让优先级高的线程使用 CPU，如果线程的优先级相同，那么会随机选择一个(线程随机性)，Java采用的是抢占式调度方式。</li>
</ul>
<h3 id="31">3.1 抢占式调度详解<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>大部分操作系统都支持多进程并发运行，现在的操作系统几乎都支持同时运行多个程序。比如：现在我们上课一边使用编辑器，一边使用录屏软件，同时还开着画图板，dos窗口等软件。此时，这些程序是在同时运行，”感觉这些软件好像在同一时刻运行着“。</p>
<p>实际上，CPU(中央处理器)使用抢占式调度模式在多个线程间进行着高速的切换。对于CPU的一个核而言，某个时刻，只能执行一个线程，而 CPU的在多个线程间切换速度相对我们的感觉要快，看上去就是在同一时刻运行。 其实，多线程程序并不能提高程序的运行速度，但能够提高程序运行效率，让CPU的使用率更高。</p>
<p><img alt="image-20200918085127251" src="../imgs/image-20200918085127251.png" /></p>
<h2 id="4-java">4. Java线程的创建<a class="headerlink" href="#4-java" title="Permanent link">&para;</a></h2>
<p>在Java中，万物皆对象，当然线程也为对象之一</p>
<h3 id="41">4.1 创建与启动<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<p>java虚拟机是支持多线程的，当运行Java程序时，至少已经有一个线程了，那就是main线程。</p>
<p><img alt="image-20200918085402835" src="../imgs/image-20200918085402835.png" /></p>
<p><strong>创建线程的简单方式有两种</strong></p>
<ol>
<li>
<p>继承Thread类</p>
</li>
<li>
<p>实现Runnable接口</p>
</li>
</ol>
<p><strong>启动线程的方式有两种</strong></p>
<ol>
<li>继承了Thread类的子类调用 <code>.start()</code> 方法。</li>
<li>实现了Runnable接口的类传入 新建的Thread对象，让Thread对象调用  <code>.start()</code> 方法即可。</li>
</ol>
<p><img alt="image-20200918090019422" src="../imgs/image-20200918090019422.png" /></p>
<p>注意事项：</p>
<ul>
<li>手动调用run方法不是启动线程的方式，只是普通方法调用。</li>
<li>start方法启动线程后，run方法会由JVM调用执行。</li>
<li>不要重复启动同一个线程，否则抛出异常 IllegalThreadStateException</li>
<li>不要使用Junit单元测试多线程，不支持，主线程结束后会调用 System.exit() 直接退出JVM;</li>
</ul>
<h4 id="411-thread">4.1.1 继承Thread类<a class="headerlink" href="#411-thread" title="Permanent link">&para;</a></h4>
<p>Java中 java.lang.Thread 是表示线程的类，每个Thread类或其子类的实例代表一个线程对象。</p>
<p><strong>通过继承Thread类来创建并启动多线程的步骤:</strong></p>
<ol>
<li>定义Thread类的子类，并重写该类的run()方法，该run()方法的方法体就代表了线程需要完成的任
   务,因此把run()方法称为线程执行体。</li>
<li>创建Thread子类的实例，即创建了线程对象</li>
<li>调用线程对象的start()方法来启动该线程</li>
</ol>
<p><strong>自定义线程类</strong>：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyThread</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>
    <span class="c1">//定义指定线程名称的构造方法</span>
    <span class="kd">public</span> <span class="nf">MyThread</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//调用父类的String参数的构造方法，指定线程的名称</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="cm">/**</span>
<span class="cm">    * 重写run方法，完成该线程执行的逻辑</span>
<span class="cm">    */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;：正在执行！&quot;</span><span class="o">+</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 测试类</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo01</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">//创建自定义线程对象</span>
        <span class="n">MyThread</span> <span class="n">mt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyThread</span><span class="p">(</span><span class="s">&quot;新的线程！&quot;</span><span class="p">);</span>

        <span class="c1">//开启新线程</span>
        <span class="n">mt</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="c1">//在主方法中执行for循环</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;main线程！&quot;</span><span class="o">+</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="412-runnable">4.1.2 实现Runnable接口<a class="headerlink" href="#412-runnable" title="Permanent link">&para;</a></h4>
<p>Java有单继承的限制，若想要实现多个线程的多样性，可用核心类库中的Runnable接口：我们可以实现Runnable接口，重写run()方法，然后再通过Thread类的对象代理启动和执行我们的线程体run()方法</p>
<p><strong>通过实现Runnable接口创建线程并启动的步骤:</strong></p>
<ol>
<li>定义Runnable接口的实现类，并重写该接口的run()方法，该run()方法的方法体同样是该线程的线
   程执行体。</li>
<li>创建Runnable实现类的实例，并以此实例作为Thread的target来创建Thread对象，该Thread对
   象才是真正 的线程对象。</li>
<li>调用线程对象的start()方法来启动线程。</li>
</ol>
<p><strong>自定义线程任务类</strong>：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyRunnable</span> <span class="kd">implements</span> <span class="n">Runnable</span><span class="p">{</span> <span class="c1">// 继承Runnable接口</span>
    <span class="c1">// 重写Runnable接口</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 测试类</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">//创建自定义类对象 线程任务对象</span>
        <span class="n">MyRunnable</span> <span class="n">mr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyRunnable</span><span class="p">();</span>

        <span class="c1">//创建线程对象 第二个参数为线程名称</span>
        <span class="n">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">mr</span><span class="p">,</span> <span class="s">&quot;小强&quot;</span><span class="p">);</span> 
        <span class="n">t</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;旺财 &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="413">4.1.3 匿名内部类对象创建线程<a class="headerlink" href="#413" title="Permanent link">&para;</a></h4>
<p>匿名内部类对象的方式创建线程，并不是一种新的创建线程的方式，只是在线程任务只需执行一次的情况下，无需单独创建线程类，可以采用匿名对象的方式：</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 直接使用 Thread类</span>
<span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="s">&quot;新的线程！&quot;</span><span class="p">){</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;：正在执行！&quot;</span><span class="o">+</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// 实现Runnable，传入Thread</span>
<span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="p">(){</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;：&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}).</span><span class="na">start</span><span class="p">();</span>
</code></pre></div>
<blockquote>
<p>依旧使用 start() 启动线程</p>
</blockquote>
<h4 id="414-callable">4.1.4 实现Callable接口<a class="headerlink" href="#414-callable" title="Permanent link">&para;</a></h4>
<h3 id="42-threadrunnable">4.2 Thread类与Runnable接口的比较<a class="headerlink" href="#42-threadrunnable" title="Permanent link">&para;</a></h3>
<ol>
<li>由于Java“单继承，多实现”的特性，Runnable接⼝使⽤起来⽐Thread更灵活。</li>
<li>Runnable接⼝出现更符合⾯向对象，将线程单独进⾏对象的封装。</li>
<li>Runnable接⼝出现，降低了线程对象和线程任务的耦合性。</li>
<li>如果使⽤线程时不需要使⽤Thread类的诸多⽅法，显然使⽤Runnable接⼝更为轻量。</li>
</ol>
<blockquote>
<p>优先使⽤“实现 Runnable 接口” 这种⽅式来⾃定义线程类。</p>
</blockquote>
<h2 id="5-thread">5. Thread类<a class="headerlink" href="#5-thread" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 构造方法<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>方法描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>public Thread()</td>
<td>分配一个新的线程对象。</td>
</tr>
<tr>
<td>public Thread(String name)</td>
<td>分配一个指定名字的新的线程对象。</td>
</tr>
<tr>
<td>public Thread(Runnable target)</td>
<td>分配一个带有指定目标新的线程对象。</td>
</tr>
<tr>
<td>public Thread(Runnable target,String name)</td>
<td>分配一个带有指定目标新的线程对象并指定名字。</td>
</tr>
</tbody>
</table>
<h3 id="52">5.2 线程使用基础方法<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>方法描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>public void <strong>run</strong>()</td>
<td>此线程要执行的任务在此处定义代码。</td>
</tr>
<tr>
<td>public String <strong>getName</strong>()</td>
<td>获取当前线程名称。</td>
</tr>
<tr>
<td>public static Thread <strong>currentThread</strong>()</td>
<td>返回对当前正在执行的线程对象的引用。</td>
</tr>
<tr>
<td>public final boolean <strong>isAlive</strong>()</td>
<td>测试线程是否处于活动状态。如果线程已经启动且尚未终止，则为活动状态。</td>
</tr>
<tr>
<td>public final int <strong>getPriority</strong>()</td>
<td>返回线程优先级</td>
</tr>
<tr>
<td>public final void <strong>setPriority</strong>(int newPriority)</td>
<td>改变线程的优先级</td>
</tr>
</tbody>
</table>
<p><strong>关于优先级的说明</strong></p>
<p>每个线程都有一定的优先级，优先级高的线程将获得较多的执行机会。每个线程默认的优先级都与创建它的父线程具有相同的优先级。Thread类提供了setPriority(int newPriority)和getPriority()方法类设置和获取线程的优先级，其中setPriority方法需要一个整数，并且范围在[1,10]之间，通常推荐设置Thread类的三个优先级常量：</p>
<ul>
<li>MAX_PRIORITY（10）：最高优先级</li>
<li>MIN _PRIORITY （1）：最低优先级</li>
<li>NORM_PRIORITY （5）：普通优先级，默认情况下main线程具有普通优先级。</li>
</ul>
<p><strong>优先级示例代码</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(){</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;的优先级：&quot;</span> <span class="o">+</span> <span class="n">getPriority</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="n">t</span><span class="p">.</span><span class="na">setPriority</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">MAX_PRIORITY</span><span class="p">);</span>
    <span class="n">t</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;的优先级：&quot;</span> <span class="o">+</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getPriority</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="53">5.3 线程控制常见方法<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<p>在线程启动之后可以对线程进行一些干扰（控制）的方法</p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>方法描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>public void <strong>start</strong>()</td>
<td>导致此线程开始执行; Java虚拟机调用此线程的run方法。</td>
</tr>
<tr>
<td>public static void <strong>sleep</strong>(long millis)</td>
<td>线程睡眠，使当前正在执行的线程以指定的毫秒数暂停（暂时停止执行）。</td>
</tr>
<tr>
<td>public static void <strong>yield</strong>()</td>
<td>线程（挂起）礼让，<strong>yield只是让当前线程暂时失去执行权，让系统的线程调度器重新调度一次</strong>，希望优先级与当前线程相同或更高的其他线程能够获得执行机会，但是这个不能保证，完全有可能的情况是，当某个线程调用了yield方法暂停之后，线程调度器又将其调度出来重新执行。（该线程将CPU资源释放，加入争取队列重新争取）</td>
</tr>
<tr>
<td>void <strong>join</strong>()</td>
<td>加入线程，当前线程中加入一个新线程，等待加入的线程终止后再继续执行当前线程。（可以理解为强行加塞）</td>
</tr>
<tr>
<td>void <strong>join</strong>(long millis)</td>
<td>等待该线程终止的时间最长为 millis 毫秒。如果millis时间到，将不再等待。</td>
</tr>
<tr>
<td>void <strong>join</strong>(long millis, int nanos)</td>
<td>等待该线程终止的时间最长为 millis 毫秒 + nanos 纳秒。</td>
</tr>
<tr>
<td>public final void <strong><del>stop</del></strong>()</td>
<td>强迫线程停止执行。 该方法具有不安全性，已被弃用，最好不要使用。</td>
</tr>
<tr>
<td>public void <strong>interrupt</strong>()</td>
<td>中断线程，实际上是<strong>给线程打上一个中断的标记</strong>，并不会真正使线程停止执行。</td>
</tr>
<tr>
<td>public boolean <strong>isInterrupted</strong>()</td>
<td>检查线程是否中断，实际上<strong>检查线程是否有中断标记，如果有自己编写代码使此线程停止。</strong></td>
</tr>
<tr>
<td>public void <strong>setDaemon</strong>(boolean on)</td>
<td>将线程设置为守护线程或用户线程。必须在线程启动之前设置，否则会报 IllegalThreadStateException 异常。守护线程，主要为其他线程服务，<strong>当程序中没有非守护线程执行时，守护线程也将终止执行</strong>。JVM垃圾回收器也是守护线程。<br>在某个线程 <code>t1</code> 内，将一个线程 <code>t2</code> 设置为守护线程，则该线程 <code>t1</code> 结束后 <code>t2</code> 线程也会随之结束</td>
</tr>
<tr>
<td>public boolean <strong>isDaemon</strong>()</td>
<td>检查当前线程是否为守护线程。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意点：</p>
<p>调用 stop() 方法会立刻停止 run() 方法中剩余的全部工作，包括在 catch 或 finally 语句中的，并抛出ThreadDeath异常(通常情况下此异常不需要显示的捕获)，因此可能会导致一些清理性的工作的得不到完成，如文件，数据库等的关闭。</p>
<p>调用 stop() 方法会立即释放该线程所持有的所有的锁，导致数据得不到同步，出现数据不一致的问题。</p>
</blockquote>
<h3 id="54">5.4 代码示例<a class="headerlink" href="#54" title="Permanent link">&para;</a></h3>
<h4 id="541-join">5.4.1 强行加塞：join()方法<a class="headerlink" href="#541-join" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JoinTest</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">JoinClass</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JoinClass</span><span class="p">();</span>
        <span class="n">t1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="c1">// 当主线程执行到5时,让 t1 线程强行加塞</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;main线程: i = &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// 强行加塞</span>
                    <span class="n">t1</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">JoinClass</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Join进来的线程: i = &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cm">/*执行结果</span>
<span class="cm">main线程: i = 0</span>
<span class="cm">Join进来的线程: i = 0</span>
<span class="cm">main线程: i = 1</span>
<span class="cm">main线程: i = 2</span>
<span class="cm">Join进来的线程: i = 1</span>
<span class="cm">main线程: i = 3</span>
<span class="cm">main线程: i = 4</span>
<span class="cm">Join进来的线程: i = 2</span>
<span class="cm">main线程: i = 5</span>
<span class="cm">Join进来的线程: i = 3    // 在这里，t1线程执行join()方法</span>
<span class="cm">Join进来的线程: i = 4</span>
<span class="cm">Join进来的线程: i = 5</span>
<span class="cm">Join进来的线程: i = 6</span>
<span class="cm">Join进来的线程: i = 7</span>
<span class="cm">Join进来的线程: i = 8</span>
<span class="cm">Join进来的线程: i = 9</span>
<span class="cm">main线程: i = 6</span>
<span class="cm">main线程: i = 7</span>
<span class="cm">main线程: i = 8</span>
<span class="cm">main线程: i = 9</span>
<span class="cm">*/</span>
</code></pre></div>
<h4 id="542-interrupt">5.4.2 中断操作：interrupt()方法<a class="headerlink" href="#542-interrupt" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InterruptTest</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">MyClass</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyClass</span><span class="p">();</span>
        <span class="n">t1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
        <span class="n">t1</span><span class="p">.</span><span class="na">interrupt</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;已执行中断操作&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">MyClass</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">555555555</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">isInterrupted</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;i = &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;线程已中断&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cm">/*执行结果：</span>
<span class="cm">已执行中断操作</span>
<span class="cm">i = 37811162</span>
<span class="cm">Thread-0线程已中断</span>
<span class="cm">*/</span>
</code></pre></div>
<h4 id="543-setdaemontrue">5.4.3 设置守护线程：setDaemon(true)<a class="headerlink" href="#543-setdaemontrue" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DaemonTest</span> <span class="p">{</span>

   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
      <span class="n">DaemonClass</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DaemonClass</span><span class="p">();</span>
      <span class="n">t1</span><span class="p">.</span><span class="na">setDaemon</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="n">t1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

      <span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;主线程Over&quot;</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">DaemonClass</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;守护线程的i：&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
         <span class="k">try</span> <span class="p">{</span>
            <span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span>
         <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
<span class="cm">/*执行结果</span>
<span class="cm">守护线程的i：0</span>
<span class="cm">守护线程的i：1</span>
<span class="cm">守护线程的i：2</span>
<span class="cm">守护线程的i：3</span>
<span class="cm">主线程Over</span>
<span class="cm">*/</span>
</code></pre></div>
<h4 id="544">5.4.4 小案例：龟兔赛跑<a class="headerlink" href="#544" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * @author: LeoNardo</span>
<span class="cm"> * @date: 2020/9/18 - 10:52</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RabbitGuiRun</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Racer</span> <span class="n">wuGui</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Racer</span><span class="p">(</span><span class="s">&quot;乌龟&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">Racer</span> <span class="n">rabbit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Racer</span><span class="p">(</span><span class="s">&quot;兔子&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1300</span><span class="p">);</span>

        <span class="c1">// 启动两个线程</span>
        <span class="n">wuGui</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">rabbit</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

        <span class="c1">// 使两个线程执行完毕再执行主线程</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">wuGui</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
            <span class="n">rabbit</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">}</span>

        <span class="c1">// 比较乌龟与兔子的用时</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">wuGui</span><span class="p">.</span><span class="na">getTotalTime</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rabbit</span><span class="p">.</span><span class="na">getTotalTime</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;乌龟赢了!&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">wuGui</span><span class="p">.</span><span class="na">getTotalTime</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">rabbit</span><span class="p">.</span><span class="na">getTotalTime</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;兔子赢了!&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;双方打平手!!!&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">Racer</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">kind</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">distance</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">runTime</span><span class="p">;</span>    <span class="c1">// 每米所需时间</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">restTime</span><span class="p">;</span>   <span class="c1">// 休息时间</span>

    <span class="kd">private</span> <span class="kt">long</span> <span class="n">totalTime</span><span class="p">;</span>     <span class="c1">// 花费的时间</span>

    <span class="kd">public</span> <span class="nf">Racer</span><span class="p">(</span><span class="n">String</span> <span class="n">kind</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">distance</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">runTime</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">restTime</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">kind</span> <span class="o">=</span> <span class="n">kind</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">distance</span> <span class="o">=</span> <span class="n">distance</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">runTime</span> <span class="o">=</span> <span class="n">runTime</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">restTime</span> <span class="o">=</span> <span class="n">restTime</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>

        <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="kt">long</span> <span class="n">startTime</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">sum</span> <span class="o">&lt;</span> <span class="n">distance</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">runTime</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">}</span>
            <span class="n">sum</span><span class="o">++</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">sum</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">sum</span> <span class="o">&lt;</span> <span class="n">distance</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s">&quot;跑了&quot;</span> <span class="o">+</span> <span class="n">sum</span> <span class="o">+</span> <span class="s">&quot;米,需要休息&quot;</span> <span class="o">+</span> <span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">restTime</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;秒&quot;</span><span class="p">);</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">restTime</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kt">long</span> <span class="n">endTime</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>

        <span class="n">totalTime</span> <span class="o">=</span> <span class="n">endTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">;</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s">&quot;跑到了终点,用时&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">totalTime</span><span class="o">/</span><span class="mi">1000</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getTotalTime</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">totalTime</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="6">6. 线程的生命周期<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 传统线程模型的五种线程状态<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<p>传统线程模型中把线程的生命周期描述为五种状态：<strong>新建（New）、就绪（Runnable）、运行（Running）、阻塞（Blocked）、死亡（Dead）</strong>。CPU需要在多条线程之间切换，于是线程状态会多次在运行、阻塞、就绪之间切换。</p>
<p><img alt="image-20200918144514183" src="../imgs/image-20200918144514183.png" /></p>
<ol>
<li>
<p>新建
   当一个Thread类或其子类的对象被声明并创建时，新生的线程对象处于新建状。此时它和其他Java对象一样，仅仅由JVM为其分配了内存，并初始化了实例变量的值。此时的线程对象并没有任何线程的动态特征，程序也不会执行它的线程体run()。</p>
</li>
<li>
<p>就绪
   但是当线程对象调用了start()方法之后，线程就从新建状态转为就绪状态。这时线程并未执行，只是具备了运行的条件，还需要获取CPU资源后才能执行。</p>
</li>
<li>
<p>运行
   如果处于就绪状态的线程获得了CPU资源，开始执行run()方法的线程体代码，则该线程处于运行状态。如果计算机只有一个CPU，在任何时刻只有一个线程处于运行状态，如果计算机有多个处理器，将会有多个线程并行(Parallel)执行。</p>
</li>
</ol>
<p>当然，美好的时光总是短暂的，而且CPU讲究雨露均沾。对于抢占式策略的系统而言，系统会给每个可执行的线程一个小时间段来处理任务，当该时间用完，系统会剥夺该线程所占用的资源，让其回到就绪状态等待下一次被调度。此时其他线程将获得执行机会，而在选择下一个线程时，系统会适当考虑线程的优先级。</p>
<ol>
<li>
<p>阻塞
   当在运行过程中的线程遇到某些特殊情况时，线程会临时放弃CPU资源，不再执行，即进入阻塞状态。比如：线程调用了sleep()方法，会主动放弃所占用的CPU资源。</p>
</li>
<li>
<p>死亡
   线程完成任务结束或意外终止后，线程就处于死亡状态。</p>
</li>
</ol>
<h3 id="62-jdk">6.2 JDK定义的六种线程状态<a class="headerlink" href="#62-jdk" title="Permanent link">&para;</a></h3>
<p>在 java.lang.Thread 类内部定义了一个枚举类用来描述线程的六种状态：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">enum</span> <span class="n">State</span> <span class="p">{</span>
    <span class="n">NEW</span><span class="p">,</span>
    <span class="n">RUNNABLE</span><span class="p">,</span>
    <span class="n">BLOCKED</span><span class="p">,</span>
    <span class="n">WAITING</span><span class="p">,</span>
    <span class="n">TIMED_WAITING</span><span class="p">,</span>
    <span class="n">TERMINATED</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="image-20200918152525960" src="../imgs/image-20200918152525960.png" /></p>
<p>官方描述：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">enum</span> <span class="n">State</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Thread state for a thread which has not yet started.</span>
<span class="cm">     * 一个还未 start 的线程状态</span>
<span class="cm">     */</span>
    <span class="n">NEW</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Thread state for a runnable thread.  A thread in the runnable</span>
<span class="cm">     * state is executing in the Java virtual machine but it may</span>
<span class="cm">     * be waiting for other resources from the operating system</span>
<span class="cm">     * such as processor.</span>
<span class="cm">     * 一个可以 run 的线程，一个可以run的线程建在Java虚拟机中执行，但该线程有可能</span>
<span class="cm">     * 需要等待操作系统，处理器资源的释放。</span>
<span class="cm">     */</span>
    <span class="n">RUNNABLE</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Thread state for a thread blocked waiting for a monitor lock.</span>
<span class="cm">     * A thread in the blocked state is waiting for a monitor lock</span>
<span class="cm">     * to enter a synchronized block/method or</span>
<span class="cm">     * reenter a synchronized block/method after calling</span>
<span class="cm">     * {@link Object#wait() Object.wait}.</span>
<span class="cm">     * 线程处于阻塞的状态，等一个同步监视器锁(synchronized)。一个被阻塞的线程等待一个</span>
<span class="cm">     * 同步监视器的锁，以进入 synchronized 标注的代码块/方法。</span>
<span class="cm">     */</span>
    <span class="n">BLOCKED</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Thread state for a waiting thread.</span>
<span class="cm">     * A thread is in the waiting state due to calling one of the</span>
<span class="cm">     * following methods:</span>
<span class="cm">     * &lt;ul&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link Object#wait() Object.wait} with no timeout&lt;/li&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link #join() Thread.join} with no timeout&lt;/li&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link LockSupport#park() LockSupport.park}&lt;/li&gt;</span>
<span class="cm">     * &lt;/ul&gt;</span>
<span class="cm">     *</span>
<span class="cm">     * &lt;p&gt;A thread in the waiting state is waiting for another thread to</span>
<span class="cm">     * perform a particular action.</span>
<span class="cm">     * </span>
<span class="cm">     * For example, a thread that has called &lt;tt&gt;Object.wait()&lt;/tt&gt;</span>
<span class="cm">     * on an object is waiting for another thread to call</span>
<span class="cm">     * &lt;tt&gt;Object.notify()&lt;/tt&gt; or &lt;tt&gt;Object.notifyAll()&lt;/tt&gt; on</span>
<span class="cm">     * that object. A thread that has called &lt;tt&gt;Thread.join()&lt;/tt&gt;</span>
<span class="cm">     * is waiting for a specified thread to terminate.</span>
<span class="cm">     * </span>
<span class="cm">     * </span>
<span class="cm">     * 线程状态为等待，一个线程处于等待状态时由于调用了如下的方法之一：</span>
<span class="cm">     * 1.Object的wait方法； 2.Thread的join方法；3.LockSupport的park方法</span>
<span class="cm">     * </span>
<span class="cm">     * 线程处于等待状态，等待另一个线程执行测速操作，如另一个线程使用Object的notify 或 notifyAll</span>
<span class="cm">     * 一个线程调用join方法，等待该线程结束即可。</span>
<span class="cm">     */</span>
    <span class="n">WAITING</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Thread state for a waiting thread with a specified waiting time.</span>
<span class="cm">     * A thread is in the timed waiting state due to calling one of</span>
<span class="cm">     * the following methods with a specified positive waiting time:</span>
<span class="cm">     * 等待超时状态，线程有一个指定的等待超时的时间。以下方法会进入超时等待状态：</span>
<span class="cm">     * &lt;ul&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link #sleep Thread.sleep}&lt;/li&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link Object#wait(long) Object.wait} with timeout&lt;/li&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link #join(long) Thread.join} with timeout&lt;/li&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link LockSupport#parkNanos LockSupport.parkNanos}&lt;/li&gt;</span>
<span class="cm">     *   &lt;li&gt;{@link LockSupport#parkUntil LockSupport.parkUntil}&lt;/li&gt;</span>
<span class="cm">     * &lt;/ul&gt;</span>
<span class="cm">     */</span>
    <span class="n">TIMED_WAITING</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Thread state for a terminated thread.</span>
<span class="cm">     * The thread has completed execution.</span>
<span class="cm">     * 线程执行结束：线程已经完成了执行操作。</span>
<span class="cm">     */</span>
    <span class="n">TERMINATED</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Java线程状态解析（摘自《深入浅出Java多线程 》</strong>）</p>
<h4 id="621-new">6.2.1 NEW<a class="headerlink" href="#621-new" title="Permanent link">&para;</a></h4>
<p>处于NEW状态的线程此时尚未启动。这里的尚未启动指的是还没调用Thread实例的start()方法。</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">testStateNew</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{});</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">thread</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出 NEW </span>
<span class="p">}</span>
</code></pre></div>
<p>从上面可以看出，只是创建了线程而并没有调用start()方法，此时线程处于NEW状态。</p>
<p><strong>关于start()的两个引申问题</strong></p>
<ol>
<li>反复调用同一个线程的start()方法是否可行？</li>
<li>假如一个线程执行完毕（此时处于TERMINATED状态），再次调用这个线程的start()方法是否可行？</li>
</ol>
<p>要分析这两个问题，我们先来看看start()的源码：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">threadStatus</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalThreadStateException</span><span class="p">();</span>

    <span class="n">group</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="kt">boolean</span> <span class="n">started</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">start0</span><span class="p">();</span>
        <span class="n">started</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">started</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">group</span><span class="p">.</span><span class="na">threadStartFailed</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Throwable</span> <span class="n">ignore</span><span class="p">)</span> <span class="p">{</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>我们可以看到，在start()内部，这里有一个threadStatus的变量。如果它不等于0，调用start()是会直接抛出异常的。</p>
<p>我们接着往下看，有一个native的<code>start0()</code>方法。这个方法里并没有对<strong>threadStatus</strong>的处理。到了这里我们仿佛就拿这个threadStatus没辙了，我们通过debug的方式再看一下:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testStartMethod</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{});</span>
    <span class="n">thread</span><span class="p">.</span><span class="na">start</span><span class="p">();</span> <span class="c1">// 第一次调用</span>
    <span class="n">thread</span><span class="p">.</span><span class="na">start</span><span class="p">();</span> <span class="c1">// 第二次调用</span>
<span class="p">}</span>
</code></pre></div>
<p>我是在start()方法内部的最开始打的断点，叙述下在我这里打断点看到的结果：</p>
<ul>
<li>第一次调用时threadStatus的值是0。</li>
<li>第二次调用时threadStatus的值不为0。</li>
</ul>
<p>查看当前线程状态的源码：</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Thread.getState方法源码：</span>
<span class="kd">public</span> <span class="n">State</span> <span class="nf">getState</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// get current thread state</span>
    <span class="k">return</span> <span class="n">sun</span><span class="p">.</span><span class="na">misc</span><span class="p">.</span><span class="na">VM</span><span class="p">.</span><span class="na">toThreadState</span><span class="p">(</span><span class="n">threadStatus</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// sun.misc.VM 源码：</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">State</span> <span class="nf">toThreadState</span><span class="p">(</span><span class="kt">int</span> <span class="n">var0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">var0</span> <span class="o">&amp;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">State</span><span class="p">.</span><span class="na">RUNNABLE</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">var0</span> <span class="o">&amp;</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">State</span><span class="p">.</span><span class="na">BLOCKED</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">var0</span> <span class="o">&amp;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">State</span><span class="p">.</span><span class="na">WAITING</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">var0</span> <span class="o">&amp;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">State</span><span class="p">.</span><span class="na">TIMED_WAITING</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">var0</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">State</span><span class="p">.</span><span class="na">TERMINATED</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">var0</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">State</span><span class="p">.</span><span class="na">NEW</span> <span class="p">:</span> <span class="n">State</span><span class="p">.</span><span class="na">RUNNABLE</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>所以，我们结合上面的源码可以得到引申的两个问题的结果：</p>
<blockquote>
<p>两个问题的答案都是不可行，在调用一次start()之后，threadStatus的值会改变（threadStatus !=0），此时再次调用start()方法会抛出IllegalThreadStateException异常。</p>
<p>比如，threadStatus为2代表当前线程状态为TERMINATED。</p>
</blockquote>
<h4 id="622-runnable">6.2.2 RUNNABLE<a class="headerlink" href="#622-runnable" title="Permanent link">&para;</a></h4>
<p>表示当前线程正在运行中。处于RUNNABLE状态的线程在Java虚拟机中运行，也有可能在等待CPU分配资源。</p>
<p><strong>Java中线程的RUNNABLE状态</strong></p>
<p>看了操作系统线程的几个状态之后我们来看看Thread源码里对RUNNABLE状态的定义：</p>
<blockquote>
<p>Java线程的RUNNABLE状态其实是包括了传统操作系统线程的ready和running两个状态的。</p>
</blockquote>
<h4 id="623-blocked">6.2.3 BLOCKED<a class="headerlink" href="#623-blocked" title="Permanent link">&para;</a></h4>
<p>阻塞状态。处于BLOCKED状态的线程正等待锁的释放以进入同步区。（处于争夺锁的状态）</p>
<p>我们用BLOCKED状态举个生活中的例子：</p>
<blockquote>
<p>假如今天你下班后准备去食堂吃饭。你来到食堂仅有的一个窗口，发现前面已经有个人在窗口前了，此时你必须得等前面的人从窗口离开才行。
  假设你是线程t2，你前面的那个人是线程t1。此时t1占有了锁（食堂唯一的窗口），t2正在等待锁的释放，所以此时t2就处于BLOCKED状态。</p>
</blockquote>
<h4 id="624-waiting">6.2.4 WAITING<a class="headerlink" href="#624-waiting" title="Permanent link">&para;</a></h4>
<p>等待状态。处于等待状态的线程变成RUNNABLE状态需要其他线程唤醒。</p>
<p>调用如下3个方法会使线程进入等待状态：</p>
<ul>
<li>Object.wait()：使当前线程处于等待状态直到另一个线程唤醒它；</li>
<li>Thread.join()：等待线程执行完毕，底层调用的是Object实例的wait方法；</li>
<li>LockSupport.park()：除非获得调用许可，否则禁用当前线程进行线程调度。</li>
</ul>
<p>我们延续上面的例子继续解释一下WAITING状态：</p>
<blockquote>
<p>你等了好几分钟现在终于轮到你了，突然你们有一个“不懂事”的经理突然来了。你看到他你就有一种不祥的预感，果然，他是来找你的。</p>
<p>他把你拉到一旁叫你待会儿再吃饭，说他下午要去作报告，赶紧来找你了解一下项目的情况。你心里虽然有一万个不愿意但是你还是从食堂窗口走开了。</p>
<p>此时，假设你还是线程t2，你的经理是线程t1。虽然你此时都占有锁（窗口）了，“不速之客”来了你还是得释放掉锁。此时你t2的状态就是WAITING。然后经理t1获得锁，进入RUNNABLE状态。</p>
<p>要是经理t1不主动唤醒你t2（notify、notifyAll..），可以说你t2只能一直等待了。</p>
</blockquote>
<h4 id="625-timed_waiting">6.2.5 TIMED_WAITING<a class="headerlink" href="#625-timed_waiting" title="Permanent link">&para;</a></h4>
<p>超时等待状态。线程等待一个具体的时间，时间到后会被自动唤醒。</p>
<p>调用如下方法会使线程进入超时等待状态：</p>
<ul>
<li>Thread.sleep(long millis)：使当前线程睡眠指定时间；</li>
<li>Object.wait(long timeout)：线程休眠指定时间，等待期间可以通过notify()/notifyAll()唤醒；</li>
<li>Thread.join(long millis)：等待当前线程最多执行millis毫秒，如果millis为0，则会一直执行；</li>
<li>LockSupport.parkNanos(long nanos)： 除非获得调用许可，否则禁用当前线程进行线程调度指定时间；</li>
<li>LockSupport.parkUntil(long deadline)：同上，也是禁止线程进行调度指定时间；</li>
</ul>
<p>我们继续延续上面的例子来解释一下TIMED_WAITING状态：</p>
<blockquote>
<p>到了第二天中午，又到了饭点，你还是到了窗口前。</p>
<p>突然间想起你的同事叫你等他一起，他说让你等他十分钟他改个bug。</p>
<p>好吧，你说那你就等等吧，你就离开了窗口。很快十分钟过去了，你见他还没来，你想都等了这么久了还不来，那你还是先去吃饭好了。</p>
<p>这时你还是线程t1，你改bug的同事是线程t2。t2让t1等待了指定时间，此时t1等待期间就属于TIMED_WATING状态。</p>
<p>t1等待10分钟后，就自动唤醒，拥有了去争夺锁的资格。</p>
</blockquote>
<h4 id="626-terminated">6.2.6 TERMINATED<a class="headerlink" href="#626-terminated" title="Permanent link">&para;</a></h4>
<p>终止状态。此时线程已执行完毕。</p>
<h2 id="7">7. 程序状态转换<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-blockedrunnable">7.1 BLOCKED与RUNNABLE状态的转换<a class="headerlink" href="#71-blockedrunnable" title="Permanent link">&para;</a></h3>
<p>我们在上面说到：处于BLOCKED状态的线程是因为在等待锁的释放。假如这里有两个线程a和b，a线程提前获得了锁并且暂未释放锁，此时b就处于BLOCKED状态。我们先来看一个例子：</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">blockedTest</span><span class="p">()</span> <span class="p">{</span>

    <span class="n">Thread</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">testMethod</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="s">&quot;a&quot;</span><span class="p">);</span>
    <span class="n">Thread</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">testMethod</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="s">&quot;b&quot;</span><span class="p">);</span>

    <span class="n">a</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">b</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出？</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">b</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出？</span>
<span class="p">}</span>

<span class="c1">// 同步方法争夺锁</span>
<span class="kd">private</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">testMethod</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">2000L</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>初看之下，大家可能会觉得线程a会先调用同步方法，同步方法内又调用了Thread.sleep()方法，必然会输出TIMED_WAITING，而线程b因为等待线程a释放锁所以必然会输出BLOCKED。</p>
<p>其实不然，有两点需要值得大家注意，一是<strong>在测试方法blockedTest()内还有一个main线程</strong>，二是<strong>启动线程后执行run方法还是需要消耗一定时间的</strong>。</p>
<blockquote>
<p>测试方法的main线程只保证了a，b两个线程调用start()方法（转化为RUNNABLE状态），如果CPU执行效率高一点，还没等两个线程真正开始争夺锁，就已经打印此时两个线程的状态（RUNNABLE）了。</p>
<p>当然，如果CPU执行效率低一点，其中某个线程也是可能打印出BLOCKED状态的（此时两个线程已经开始争夺锁了）。</p>
</blockquote>
<p>这时你可能又会问了，要是我想要打印出BLOCKED状态我该怎么处理呢？BLOCKED状态的产生需要两个线程争夺锁才行。那我们处理下测试方法里的main线程就可以了，让它“休息一会儿”，调用一下<code>Thread.sleep()</code>方法。</p>
<p>这里需要注意的是main线程休息的时间，要保证在线程争夺锁的时间内，不要等到前一个线程锁都释放了你再去争夺锁，此时还是得不到BLOCKED状态的。</p>
<p>我们把上面的测试方法blockedTest()改动一下：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">blockedTest</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
    <span class="err">······</span>
    <span class="n">a</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000L</span><span class="p">);</span> <span class="c1">// 需要注意这里main线程休眠了1000毫秒，而testMethod()里休眠了2000毫秒</span>
    <span class="n">b</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出？</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">b</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出？</span>
<span class="p">}</span>
</code></pre></div>
<p>在这个例子中两个线程的状态转换如下</p>
<ul>
<li>a的状态转换过程：RUNNABLE（<code>a.start()</code>） -&gt; TIMED_WATING（<code>Thread.sleep()</code>）-&gt;RUNABLE（sleep()时间到）-&gt;<em>BLOCKED(未抢到锁)</em> -&gt; TERMINATED</li>
<li>b的状态转换过程：RUNNABLE（<code>b.start()</code>) -&gt; <em>BLOCKED(未抢到锁)</em> -&gt;TERMINATED</li>
</ul>
<blockquote>
<p>斜体表示可能出现的状态， 大家可以在自己的电脑上多试几次看看输出。同样，这里的输出也可能有多钟结果。</p>
</blockquote>
<p>7.2 WAITING状态与RUNNABLE状态的转换</p>
<p>根据转换图我们知道有3个方法可以使线程从RUNNABLE状态转为WAITING状态。我们主要介绍下<strong>Object.wait()</strong>和<strong>Thread.join()</strong>。</p>
<p><strong>Object.wait()</strong></p>
<blockquote>
<p>调用wait()方法前线程必须持有对象的锁。</p>
<p>线程调用wait()方法时，会释放当前的锁，直到有其他线程调用notify()/notifyAll()方法唤醒等待锁的线程。</p>
<p>需要注意的是，其他线程调用notify()方法只会唤醒单个等待锁的线程，如有有多个线程都在等待这个锁的话<strong>不一定</strong>会唤醒到之前调用wait()方法的线程。</p>
<p>同样，调用notifyAll()方法唤醒所有等待锁的线程之后，也<strong>不一定</strong>会马上把时间片分给刚才放弃锁的那个线程，具体要看系统的调度。</p>
</blockquote>
<p><strong>Thread.join()</strong></p>
<blockquote>
<p>调用join()方法不会释放锁，会一直等待当前线程执行完毕（转换为TERMINATED状态）。</p>
</blockquote>
<p>我们再把上面的例子线程启动那里改变一下：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">blockedTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="err">······</span>
    <span class="n">a</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">a</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
    <span class="n">b</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出 TERMINATED</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">b</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>
<p>要是没有调用join方法，main线程不管a线程是否执行完毕都会继续往下走。</p>
<p>a线程启动之后马上调用了join方法，这里main线程就会等到a线程执行完毕，所以这里a线程打印的状态固定是<strong>TERMINATED</strong>。</p>
<p>至于b线程的状态，有可能打印RUNNABLE（尚未进入同步方法），也有可能打印TIMED_WAITING（进入了同步方法）。</p>
<h3 id="72-timed_waitingrunnable">7.2 TIMED_WAITING与RUNNABLE状态转换<a class="headerlink" href="#72-timed_waitingrunnable" title="Permanent link">&para;</a></h3>
<p>TIMED_WAITING与WAITING状态类似，只是TIMED_WAITING状态等待的时间是指定的。</p>
<p><strong>Thread.sleep(long)</strong></p>
<blockquote>
<p>使当前线程睡眠指定时间。需要注意这里的“睡眠”只是暂时使线程停止执行，并<strong>不会释放锁</strong>。时间到后，线程会重新进入RUNNABLE状态。</p>
</blockquote>
<p><strong>Object.wait(long)</strong></p>
<blockquote>
<p>wait(long)方法使线程进入TIMED_WAITING状态。这里的wait(long)方法与无参方法wait()相同的地方是，都可以通过其他线程调用notify()或notifyAll()方法来唤醒。</p>
<p>不同的地方是，有参方法wait(long)就算其他线程不来唤醒它，经过指定时间long之后它会自动唤醒，拥有去争夺锁的资格。</p>
</blockquote>
<p><strong>Thread.join(long)</strong></p>
<blockquote>
<p>join(long)使当前线程执行指定时间，并且使线程进入TIMED_WAITING状态。</p>
<p>我们再来改一改刚才的示例:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">blockedTest</span><span class="p">()</span> <span class="p">{</span>
   <span class="err">······</span>
   <span class="n">a</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
   <span class="n">a</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="mi">1000L</span><span class="p">);</span>
   <span class="n">b</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span> <span class="c1">// 输出 TIEMD_WAITING</span>
   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">b</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>
<p>这里调用a.join(1000L)，因为是指定了具体a线程执行的时间的，并且执行时间是小于a线程sleep的时间，所以a线程状态输出TIMED_WAITING。</p>
</blockquote>
<p>b线程状态仍然不固定（RUNNABLE或BLOCKED）。</p>
<h2 id="8">8. 线程中断<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<blockquote>
<p>在某些情况下，我们在线程启动后发现并不需要它继续执行下去时，需要中断线程。目前在Java里还没有安全直接的方法来停止线程，但是Java提供了线程中断机制来处理需要中断线程的情况。</p>
<p>线程中断机制是一种协作机制。需要注意，通过中断操作并不能直接终止一个线程，而是通知需要被中断的线程自行处理。</p>
</blockquote>
<p>简单介绍下Thread类里提供的关于线程中断的几个方法：</p>
<ul>
<li>Thread.interrupt()：中断线程。这里的中断线程并不会立即停止线程，而是设置线程的中断状态为true（默认是flase）；</li>
<li>Thread.interrupted()：测试当前线程是否被中断。线程的中断状态受这个方法的影响，意思是调用一次使线程中断状态设置为true，连续调用两次会使得这个线程的中断状态重新转为false；</li>
<li>Thread.isInterrupted()：测试当前线程是否被中断。与上面方法不同的是调用这个方法并不会影响线程的中断状态。</li>
</ul>
<blockquote>
<p>在线程中断机制里，当其他线程通知需要被中断的线程后，线程中断的状态被设置为true，但是具体被要求中断的线程要怎么处理，完全由被中断线程自己而定，可以在合适的实际处理中断请求，也可以完全不处理继续执行下去。</p>
</blockquote>
<h2 id="9">9. 线程安全<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<p>当我们使用多个线程访问同一资源（可以是同一个变量、同一个文件、同一条记录等）的时候，但是如果多个线程中对资源有读和写的操作，就会出现前后数据不一致问题，这就是线程安全问题。</p>
<p>案例：三个窗口售卖共100张火车票。</p>
<h3 id="91">9.1 线程安全问题引出<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<h4 id="911">9.1.1 静态变量是共享的<a class="headerlink" href="#911" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.atguigu.safe</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SaleTicketDemo3</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">TicketThread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TicketThread</span><span class="p">();</span>
        <span class="n">TicketThread</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TicketThread</span><span class="p">();</span>
        <span class="n">TicketThread</span> <span class="n">t3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TicketThread</span><span class="p">();</span>
        <span class="n">t1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">t2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">t3</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">TicketThread</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(){</span>
        <span class="k">while</span><span class="p">(</span><span class="n">total</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="c1">//加入这个，使得问题暴露的更明显</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;卖出一张票，剩余:&quot;</span> <span class="o">+</span> <span class="o">--</span><span class="n">total</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>结果：发现卖出近100张票。</p>
<p>问题（1）：但是有重复票或负数票问题。</p>
<ul>
<li>原因：线程安全问题</li>
</ul>
<p>问题（2）：如果要考虑有两场电影，各卖100张票，这场卖完就没票了，新的线程对象也没有票卖了</p>
<ul>
<li>原因：TicketThread类的静态变量，是所有TicketThread类的对象共享。本来成员变量就是run方法共享的数据，再用static不合适。</li>
</ul>
<h4 id="912">9.1.2 同一个对象的实例变量共享<a class="headerlink" href="#912" title="Permanent link">&para;</a></h4>
<p>示例代码：多个Thread线程使用同一个Runnable对象</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.atguigu.safe</span><span class="p">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SaleTicketDemo3</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">TicketSaleRunnable</span> <span class="n">tr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TicketSaleRunnable</span><span class="p">();</span>
        <span class="n">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span><span class="s">&quot;窗口一&quot;</span><span class="p">);</span>
        <span class="n">Thread</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span><span class="s">&quot;窗口一&quot;</span><span class="p">);</span>
        <span class="n">Thread</span> <span class="n">t3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span><span class="s">&quot;窗口一&quot;</span><span class="p">);</span>
        <span class="n">t1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">t2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">t3</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">TicketSaleRunnable</span> <span class="kd">implements</span> <span class="n">Runnable</span><span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(){</span>
        <span class="k">while</span><span class="p">(</span><span class="n">total</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="c1">//加入这个，使得问题暴露的更明显</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;卖出一张票，剩余:&quot;</span> <span class="o">+</span> <span class="o">--</span><span class="n">total</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>结果：发现卖出近100张票。</p>
<p>问题：但是有重复票或负数票问题。</p>
<ul>
<li>原因：线程安全问题</li>
</ul>
<h3 id="92">9.2 线程安全问题原因分析<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<p>出现重复打印票和负数的问题分析（跟阻塞没关系）：</p>
<p><img alt="image-20200918154913922" src="../imgs/image-20200918154913922.png" /></p>
<p>总结：线程安全问题的出现因为具备了以下条件</p>
<ol>
<li>多线程执行</li>
<li>共享数据</li>
<li>多条语句操作共享数据</li>
</ol>
<h3 id="93">9.3 线程安全问题解决方式<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<p>Java中提供了线程同步机制来解决。</p>
<p><img alt="image-20200918160713335" src="../imgs/image-20200918160713335.png" /></p>
<blockquote>
<p>同步、异步的简单理解：</p>
<p>同步即一步一步完成操作，第一步未完成不能进行下一步，相当单线程执行任务； 异步即几步操作可以互不干扰的执行，你做你的事，我做我的事，相当于多线程执行任务。 多线程中的同步机制，可以理解为把有线程安全问题代码，变成同步执行的代码，或者看成一个不能拆分的整体，一个线程执行完这整块代码后，下一个线程才能再来执行。</p>
</blockquote>
<p>Java中常使用关键字synchronized 来实现同步机制：</p>
<p><strong>同步方法</strong>：synchronized 关键字直接修饰方法，表示同一时刻只有一个线程能进入这个方法，其他线
程在外面等着。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">method</span><span class="p">(){</span>
    <span class="c1">// 可能会产生线程安全问题的代码</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>同步代码块</strong>：synchronized 关键字可以用于某个区块前面，表示只对这个区块的资源实行互斥访问。</p>
<div class="highlight"><pre><span></span><code><span class="kd">synchronized</span><span class="p">(</span><span class="n">同步锁</span><span class="p">){</span>
    <span class="c1">// 需要同步操作的代码</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="94">9.4 锁对象选择<a class="headerlink" href="#94" title="Permanent link">&para;</a></h3>
<p>同步锁对象：</p>
<ul>
<li>锁对象可以是任意类型。</li>
<li>多个线程对象 要使用同一把锁，否则锁起不了同步的作用。</li>
</ul>
<h4 id="941">9.4.1 同步方法的锁对象问题<a class="headerlink" href="#941" title="Permanent link">&para;</a></h4>
<ol>
<li>静态方法：当前类的Class对象</li>
<li>非静态方法，同一个对象内：this</li>
<li>非静态方法，不同对象：自定义锁</li>
</ol>
<h4 id="942">9.4.2 同步代码块的锁对象<a class="headerlink" href="#942" title="Permanent link">&para;</a></h4>
<p>同步锁对象：</p>
<ul>
<li>锁对象可以是任意类型。</li>
<li>多个线程对象 要使用同一把锁。</li>
<li>习惯上先考虑this，但是要注意是否同一个this</li>
</ul>
<h3 id="95">9.5 买票问题优化写法<a class="headerlink" href="#95" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TicketSaleTest</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">TicketSale</span> <span class="n">ticketSale</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TicketSale</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">ticketSale</span><span class="p">,</span> <span class="s">&quot;12306&quot;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">ticketSale</span><span class="p">,</span> <span class="s">&quot;黄牛&quot;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">ticketSale</span><span class="p">,</span> <span class="s">&quot;售票窗口&quot;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">TicketSale</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 使用同步代码块</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;卖了第&quot;</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="s">&quot;张票。&quot;</span><span class="p">);</span>
                    <span class="n">count</span><span class="o">--</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// 使用同步方法：</span>
<span class="kd">class</span> <span class="nc">TicketSale</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="s">&quot;asd&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">reduceTicket</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">reduceTicket</span><span class="p">(){</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;卖了第&quot;</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="s">&quot;张票。&quot;</span><span class="p">);</span>
            <span class="n">count</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p><strong>编写多线程程序小技巧</strong></p>
<p>原则：</p>
<ul>
<li>线程操作资源类</li>
<li>高内聚低耦合</li>
</ul>
<p>步骤：</p>
<ul>
<li>编写资源类</li>
<li>考虑线程安全问题，在资源类中考虑使用同步代码块或同步方法（对资源的操作）</li>
</ul>
<p><strong>线程安全的单例模式</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingletonTest</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// 可以发现所有获取到的 实例对象 地址都是一致的</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span>
                <span class="n">Singleton</span> <span class="n">instance</span> <span class="o">=</span> <span class="n">Singleton</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;instance = &quot;</span> <span class="o">+</span> <span class="n">instance</span><span class="p">);</span>
            <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">Singleton</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">private</span> <span class="nf">Singleton</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getInstance</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="n">Singleton</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">instance</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="96">9.6 锁的范围问题<a class="headerlink" href="#96" title="Permanent link">&para;</a></h3>
<ul>
<li>锁的范围太小：不能解决安全问题</li>
<li>锁的范围太大：因为一旦某个线程抢到锁，其他线程就只能等待，所以范围太大，效率会降低，不能合理利用CPU资源。</li>
</ul>
<h3 id="97">9.7 单例设计模式<a class="headerlink" href="#97" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingletonTest</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span>
                <span class="n">Singleton</span> <span class="n">instance</span> <span class="o">=</span> <span class="n">Singleton</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;instance = &quot;</span> <span class="o">+</span> <span class="n">instance</span><span class="p">);</span>
            <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 单例设计，需要在获取单例的静态方法中加入两个判断instance是否为null的语句</span>
<span class="kd">class</span> <span class="nc">Singleton</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">private</span> <span class="nf">Singleton</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getInstance</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 用于筛选是否存在对象</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="n">Singleton</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 防止多个对象依次进入同步代码块</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">instance</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="10">10. 线程间的通信<a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<p>多个线程在处理同一个资源，但是处理的动作（线程的任务）却不相同。而多个线程并发执行时, 在默认情况下CPU是随机切换线程的，当我们需要多个线程来共同完成一件任务，并且我们希望他们有规律的执行, 那么多线程之间需要一些通信机制，可以协调它们的工作，以此来帮我们达到多线程共同操作一份数据。</p>
<p>比如：线程A用来生成包子的，线程B用来吃包子的，包子可以理解为同一资源，线程A与线程B处理的动作，一个是生产，一个是消费，此时B线程必须等到A线程完成后才能执行，那么线程A与线程B之间就需要线程通信，即—— <strong>等待唤醒机制</strong>。</p>
<h3 id="101">10.1 等待唤醒机制<a class="headerlink" href="#101" title="Permanent link">&para;</a></h3>
<p>等待唤醒机制是多个线程间的一种<strong>协作机制</strong>。谈到线程我们经常想到的是线程间的<strong>竞争（race）</strong>，比如去争夺锁，但这并不是故事的全部，线程间也会有协作机制。</p>
<p>就是在一个线程满足某个条件时，就进入<strong>等待状态（wait()/wait(time)）</strong>， 等待其他线程执行完他们的指定代码过后再将其<strong>唤醒（notify()）</strong>;或可以指定wait的时间，等时间到了自动唤醒；在有多个线程进行等待时，如果需要，可以使用 <strong>notifyAll()</strong>来唤醒所有的等待线程。wait/notify 就是线程间的一种协作机制。</p>
<ol>
<li>wait：线程不再活动，不再参与调度，进入 wait set 中，因此不会浪费 CPU 资源，也不会去竞争锁了（释放锁），这时的线程状态即是 WAITING或TIMED_WAITING。它还要等着别的线程执行一个特别的动作，也即是“通知（notify）”或者等待时间到，在这个对象上等待的线程从wait set 中释放出来，重新进入到调度队列（ready queue）中</li>
<li>notify：则选取所通知对象的 wait set 中的一个线程释放；</li>
<li>notifyAll：则释放所通知对象的 wait set 上的全部线程。</li>
</ol>
<blockquote>
<p>注意：</p>
<p>被通知线程被唤醒后也不一定能立即恢复执行，因为它当初中断的地方是在同步块内，而此刻它已经不持有锁，所以她需要再次尝试去获取锁（很可能面临其它线程的竞争），成功后才能在当初调用 wait 方法之后的地方恢复执行。</p>
<p>总结如下：</p>
<ul>
<li>如果能获取锁，线程就从 WAITING 状态变成 RUNNABLE（可运行） 状态；</li>
<li>否则，线程就从 WAITING 状态又变成 BLOCKED（等待锁） 状态</li>
</ul>
</blockquote>
<p><strong>调用wait和notify方法需要注意的细节</strong></p>
<ol>
<li>wait方法与notify方法必须要由同一个锁对象调用。因为：对应的锁对象可以通过notify唤醒使用同一个锁对象调用的wait方法后的线程。</li>
<li>wait方法与notify方法是属于Object类的方法的。因为：锁对象可以是任意对象，而任意对象的所属类都是继承了Object类的。</li>
<li><strong>wait方法与notify方法必须要在同步代码块或者是同步函数中使用</strong>。因为：必须要通过锁对象调用这2个方法。</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DemoWaitNotify</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="n">Object</span> <span class="n">obj1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">();</span>
        <span class="n">Object</span> <span class="n">obj2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">WaitThread</span><span class="p">(</span><span class="n">obj1</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
        <span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>  <span class="c1">// 等待一秒，确认等待线程执行到wait方法</span>
        <span class="k">new</span> <span class="n">NotifyThread</span><span class="p">(</span><span class="n">obj1</span><span class="p">).</span><span class="na">start</span><span class="p">();</span> <span class="c1">// 唤醒持有相同锁的线程</span>
<span class="c1">//      new NotifyThread(obj2).start(); // 如果锁不同，则无法唤醒，一致处于wait状态</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">WaitThread</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">WaitThread</span><span class="p">(</span><span class="n">Object</span> <span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;调用wait方法，进入WAIT状态&quot;</span><span class="p">);</span>
        <span class="kd">synchronized</span> <span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">obj</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">}</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;执行wait()的线程被唤醒&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">NotifyThread</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">NotifyThread</span><span class="p">(</span><span class="n">Object</span> <span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;调用notify方法，唤醒持有该锁的其他线程&quot;</span><span class="p">);</span>
        <span class="kd">synchronized</span> <span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">obj</span><span class="p">.</span><span class="na">notify</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="102">10.2 案例：<a class="headerlink" href="#102" title="Permanent link">&para;</a></h3>
<h4 id="1021">10.2.1 生产者与消费者问题<a class="headerlink" href="#1021" title="Permanent link">&para;</a></h4>
<p>等待唤醒机制可以解决经典的“生产者与消费者”的问题。</p>
<p>生产者与消费者问题（英语：Producer-consumer problem），也称有限缓冲问题（英语：Bounded-buffer problem），是一个多线程同步问题的经典案例。该问题描述了两个（多个）共享固定大小缓冲区的线程——即所谓的“生产者”和“消费者”。</p>
<ul>
<li>
<p>生产者：生成一定量的数据放到缓冲区中，然后重复此过程。</p>
</li>
<li>
<p>消费者：在缓冲区消耗这些数据。</p>
</li>
</ul>
<p>该问题的关键就是要<strong>保证生产者不会在缓冲区满时加入数据，消费者也不会在缓冲区中空时消耗数据。</strong></p>
<p><strong>生产者与消费者中的两个问题：</strong></p>
<ul>
<li>线程安全问题：因为生产者与消费者共享数据缓冲区，不过这个问题可以使用同步解决。</li>
<li>线程的协调工作问题：要解决该问题，就必须让生产者线程在缓冲区满时等待(wait)，暂停进入阻塞状态，等到下次消费者消耗了缓冲区中的数据的时候，通知(notify)正在等待的线程恢复到就绪状态，重新开始往缓冲区添加数据。同样，也可以让消费者线程在缓冲区空时进入等待(wait)，暂停进入阻塞状态，等到生产者往缓冲区添加数据之后，再通知(notify)正在等待的线程恢复到就绪状态。通过这样的通信机制来解决此类问题。</li>
</ul>
<p><strong>生产者消费者案例</strong></p>
<p><strong>一个厨师一个服务员问题</strong></p>
<p>案例：有家餐馆的取餐口比较小，只能放10份快餐，厨师做完快餐放在取餐口的工作台上，服务员从这个工作台取出快餐给顾客。现在有1个厨师和1个服务员。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo01</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">WorkBranch</span> <span class="n">workBranch</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WorkBranch</span><span class="p">();</span>

        <span class="c1">// 2、创建和启动厨师线程</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="s">&quot;厨师&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">workBranch</span><span class="p">.</span><span class="na">put</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}.</span><span class="na">start</span><span class="p">();</span>
        <span class="c1">// 3、创建和启动服务员线程</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="s">&quot;服务员&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">workBranch</span><span class="p">.</span><span class="na">get</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">WorkBranch</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_COUNT</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">currentCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">put</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&gt;=</span> <span class="n">MAX_COUNT</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;厨师做好了一份饭，现在窗口有&quot;</span> <span class="o">+</span> <span class="o">++</span><span class="n">currentCount</span> <span class="o">+</span> <span class="s">&quot;份饭&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">notify</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">get</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;服务员拿走了一份饭，现在窗口有&quot;</span> <span class="o">+</span> <span class="o">--</span><span class="n">currentCount</span> <span class="o">+</span> <span class="s">&quot;份饭&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">notify</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>多个厨师多个服务员问题</strong> </p>
<p>案例：有家餐馆的取餐口比较小，只能放10份快餐，厨师做完快餐放在取餐口的工作台上，服务员从这个工作台取出快餐给顾客。现在有多个厨师和多个服务员。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Workbench</span> <span class="n">workbench</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Workbench</span><span class="p">();</span>
        <span class="n">Cooker</span> <span class="n">cooker1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cooker</span><span class="p">(</span><span class="s">&quot;美食圈哥&quot;</span><span class="p">,</span> <span class="n">workbench</span><span class="p">);</span>
        <span class="n">Cooker</span> <span class="n">cooker2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cooker</span><span class="p">(</span><span class="s">&quot;老爸&quot;</span><span class="p">,</span> <span class="n">workbench</span><span class="p">);</span>
        <span class="n">Waiter</span> <span class="n">waiter1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Waiter</span><span class="p">(</span><span class="s">&quot;服务员&quot;</span><span class="p">,</span> <span class="n">workbench</span><span class="p">);</span>
        <span class="n">Waiter</span> <span class="n">waiter2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Waiter</span><span class="p">(</span><span class="s">&quot;Leo&quot;</span><span class="p">,</span> <span class="n">workbench</span><span class="p">);</span>
        <span class="n">cooker1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">cooker2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">waiter1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
        <span class="n">waiter2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// while版本</span>
<span class="kd">class</span> <span class="nc">Workbench</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">currentCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_VALUE</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">put</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 如果数量过多，则厨师循环等待</span>
        <span class="c1">// 解释：当数量为10时，则等待，放弃锁，其他线程进入，也处于等待状态。因此，若为if的话，当上菜线程唤醒了这个线程之后，则继续向下执行，就会造成制作过多的问题</span>
        <span class="c1">// 也可以改为下面的版本（if else）</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&gt;=</span> <span class="n">MAX_VALUE</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;初始制作了一份小笼包，窗口剩余&quot;</span> <span class="o">+</span> <span class="o">++</span><span class="n">currentCount</span> <span class="o">+</span> <span class="s">&quot;份&quot;</span><span class="p">);</span>
        <span class="c1">// 唤醒其他所有线程</span>
        <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">take</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 如果没有了，则服务员循环等待</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;拿走了一份小笼包，窗口剩余&quot;</span> <span class="o">+</span> <span class="o">--</span><span class="n">currentCount</span> <span class="o">+</span> <span class="s">&quot;份&quot;</span><span class="p">);</span>
        <span class="c1">// 唤醒其他所有线程</span>
        <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// if else 版本，选择一个即可</span>
<span class="kd">class</span> <span class="nc">Workbench</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">currentCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_VALUE</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">put</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 如果数量过多，则厨师循环等待</span>
        <span class="c1">// 分支选择，也可以实现线程安全。只是进入等待的线程被再次唤醒之后，直接略过else中的代码</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&gt;=</span> <span class="n">MAX_VALUE</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;初始制作了一份小笼包，窗口剩余&quot;</span> <span class="o">+</span> <span class="o">++</span><span class="n">currentCount</span> <span class="o">+</span> <span class="s">&quot;份&quot;</span><span class="p">);</span>
            <span class="c1">// 唤醒其他所有线程</span>
            <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">take</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// 如果没有了，则服务员循环等待</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;拿走了一份小笼包，窗口剩余&quot;</span> <span class="o">+</span> <span class="o">--</span><span class="n">currentCount</span> <span class="o">+</span> <span class="s">&quot;份&quot;</span><span class="p">);</span>
            <span class="c1">// 唤醒其他所有线程</span>
            <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">Cooker</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="n">Workbench</span> <span class="n">workbench</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Cooker</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">Workbench</span> <span class="n">workbench</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">workbench</span> <span class="o">=</span> <span class="n">workbench</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">workbench</span><span class="p">.</span><span class="na">put</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">Waiter</span> <span class="kd">extends</span> <span class="n">Thread</span> <span class="p">{</span>

    <span class="n">Workbench</span> <span class="n">workbench</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Waiter</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">Workbench</span> <span class="n">workbench</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">workbench</span> <span class="o">=</span> <span class="n">workbench</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">workbench</span><span class="p">.</span><span class="na">take</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="1022">10.2.2 循环打印<a class="headerlink" href="#1022" title="Permanent link">&para;</a></h4>
<p>要求两个线程，同时打印字母，每个线程都能连续打印3个字母。两个线程交替打印，一个线程打印字母的小写形式，一个线程打印字母的大写形式，但是字母是连续的。当字母循环到z之后，回到a。类似如下形式</p>
<p>Thread-0: y
Thread-0: z
Thread-0: a
Thread-1: B
Thread-1: C
Thread-1: D
Thread-0: e
Thread-0: f</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * @author: LeoNardo</span>
<span class="cm"> * @date: 2020/9/19 - 8:49</span>
<span class="cm"> * 1、要求两个线程，同时打印字母，每个线程都能连续打印3个字母。两个线程交替打印，一个线程打印</span>
<span class="cm"> * 字母的小写形式，一个线程打印字母的大写形式，但是字母是连续的。当字母循环到z之后，回到a。</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test01</span> <span class="p">{</span>

   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">PrintClass</span> <span class="n">printClass</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrintClass</span><span class="p">();</span>
      <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
         <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printClass</span><span class="p">.</span><span class="na">PrintThread_A</span><span class="p">();</span>
         <span class="p">}</span>
      <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
      <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
         <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printClass</span><span class="p">.</span><span class="na">PrintThread_B</span><span class="p">();</span>
         <span class="p">}</span>
      <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
   <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">PrintClass</span> <span class="p">{</span>

   <span class="kd">private</span> <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>

   <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_COUNT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

   <span class="kd">private</span> <span class="kt">int</span> <span class="n">currentCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

   <span class="c1">// 打印三个小写字母</span>
   <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">PrintThread_A</span><span class="p">()</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">try</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
         <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
         <span class="p">}</span>
      <span class="p">}</span>

      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="n">c</span><span class="p">);</span>
      <span class="n">currentCount</span><span class="o">++</span><span class="p">;</span>
      <span class="n">c</span><span class="o">++</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;z&#39;</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">c</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="na">notify</span><span class="p">();</span>
   <span class="p">}</span>

   <span class="c1">// 打印三个大写字母</span>
   <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">PrintThread_B</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">currentCount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">try</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
         <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
         <span class="p">}</span>
      <span class="p">}</span>

      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="mi">32</span><span class="p">));</span>
      <span class="n">c</span><span class="o">++</span><span class="p">;</span>
      <span class="n">currentCount</span><span class="o">--</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;z&#39;</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">c</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="na">notify</span><span class="p">();</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="1023">10.2.3 三个线程循环打印<a class="headerlink" href="#1023" title="Permanent link">&para;</a></h4>
<p>三个线程，一个打印ABC，一个打印abc，一个打印123；注意，要循环打印！！！</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Practice_2</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">PublicClass</span> <span class="n">publicClass</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PublicClass</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">publicClass</span><span class="p">.</span><span class="na">print123</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">publicClass</span><span class="p">.</span><span class="na">printABC</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">publicClass</span><span class="p">.</span><span class="na">printabc</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}).</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">class</span> <span class="nc">PublicClass</span> <span class="p">{</span>

    <span class="c1">// 指示器，0为ABC线程启动，1为abc线程启动，2为123线程启动</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">indicator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// 最大计数器</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_COUNT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

    <span class="c1">// 计数器，每个线程打 count下后，交换线程打印</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">char</span> <span class="n">up</span> <span class="o">=</span> <span class="sc">&#39;A&#39;</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">char</span> <span class="n">lowwer</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">printABC</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">indicator</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;---&gt;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="n">up</span><span class="p">));</span>
            <span class="n">count</span><span class="o">++</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">up</span> <span class="o">==</span> <span class="sc">&#39;Z&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">up</span> <span class="o">=</span> <span class="sc">&#39;A&#39;</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">up</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;=</span> <span class="n">MAX_COUNT</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">indicator</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">printabc</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">indicator</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;---&gt;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="n">lowwer</span><span class="p">));</span>
            <span class="n">count</span><span class="o">++</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">lowwer</span> <span class="o">==</span> <span class="sc">&#39;z&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">lowwer</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">lowwer</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;=</span> <span class="n">MAX_COUNT</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">indicator</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">print123</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">indicator</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;---&gt;&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">num</span><span class="p">));</span>
            <span class="n">count</span><span class="o">++</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">num</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&gt;=</span> <span class="n">MAX_COUNT</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">indicator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="103">10.3 释放锁操作与死锁<a class="headerlink" href="#103" title="Permanent link">&para;</a></h3>
<h4 id="1031"><strong>10.3.1 释放锁的操作</strong><a class="headerlink" href="#1031" title="Permanent link">&para;</a></h4>
<ul>
<li>当前线程的同步方法、同步代码块执行结束。</li>
<li>当前线程在同步代码块、同步方法中出现了未处理的Error或Exception，导致当前线程异常结束。</li>
<li>当前线程在同步代码块、同步方法中执行了锁对象的wait()方法，当前线程被挂起，并释放锁。</li>
</ul>
<h4 id="1032">10.3.2 不会释放锁的操作<a class="headerlink" href="#1032" title="Permanent link">&para;</a></h4>
<p>线程执行同步代码块或同步方法时，程序调用 <code>Thread.sleep()</code>、<code>Thread.yield()</code> 方法暂停当前线程的执行。</p>
<p>线程执行同步代码块时，其他线程调用了该线程的 <code>suspend()</code> 方法将该该线程挂起，该线程不会释放锁（同步监视器）。应尽量避免使用<code>suspend()</code>和<code>resume()</code>这样的过时来控制线程。</p>
<h4 id="1033">10.3.3 死锁<a class="headerlink" href="#1033" title="Permanent link">&para;</a></h4>
<p>不同的线程分别锁住对方需要的同步监视器对象不释放，都在等待对方先放弃时就形成了线程的死锁。一旦出现死锁，整个程序既不会发生异常，也不会给出任何提示，只是所有线程处于阻塞状态，无法继续。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDeadLock</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Object</span> <span class="n">g</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">();</span>
        <span class="n">Object</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">();</span>
        <span class="n">Owner</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Owner</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
        <span class="n">Customer</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">s</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
        <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="n">c</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Owner</span> <span class="kd">implements</span> <span class="n">Runnable</span><span class="p">{</span>
    <span class="kd">private</span> <span class="n">Object</span> <span class="n">goods</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Object</span> <span class="n">money</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Owner</span><span class="p">(</span><span class="n">Object</span> <span class="n">goods</span><span class="p">,</span> <span class="n">Object</span> <span class="n">money</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="na">goods</span> <span class="o">=</span> <span class="n">goods</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">money</span> <span class="o">=</span> <span class="n">money</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">synchronized</span> <span class="p">(</span><span class="n">goods</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;先给钱&quot;</span><span class="p">);</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="n">money</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;发货&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">Customer</span> <span class="kd">implements</span> <span class="n">Runnable</span><span class="p">{</span>
    <span class="kd">private</span> <span class="n">Object</span> <span class="n">goods</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Object</span> <span class="n">money</span><span class="p">;</span>
    <span class="kd">public</span> <span class="nf">Customer</span><span class="p">(</span><span class="n">Object</span> <span class="n">goods</span><span class="p">,</span> <span class="n">Object</span> <span class="n">money</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="na">goods</span> <span class="o">=</span> <span class="n">goods</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">money</span> <span class="o">=</span> <span class="n">money</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">synchronized</span> <span class="p">(</span><span class="n">money</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;先发货&quot;</span><span class="p">);</span>
            <span class="kd">synchronized</span> <span class="p">(</span><span class="n">goods</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;再给钱&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="104-sleepwait">10.4 面试题：sleep()和wait()方法的区别<a class="headerlink" href="#104-sleepwait" title="Permanent link">&para;</a></h3>
<ol>
<li>sleep()不释放锁，wait()释放锁</li>
<li>sleep()指定休眠的时间，wait()可以指定时间也可以无限等待直到notify或notifyAll</li>
<li>sleep()在Thread类中声明的静态方法，wait方法在Object类中声明</li>
</ol>
<p>因为我们调用wait（）方法是由锁对象调用，而锁对象的类型是任意类型的对象。那么希望任意类型的
对象都要有的方法，只能声明在Object类中。</p>
<h2 id="11-threadlocal">11. ThreadLocal类简介<a class="headerlink" href="#11-threadlocal" title="Permanent link">&para;</a></h2>
<p>ThreadLocal是一个本地线程副本变量工具类。内部是一个<strong>弱引用</strong>的Map来维护。这里不详细介绍它的原理，而是只是介绍它的使用，以后有独立章节来介绍ThreadLocal类的原理。</p>
<p>有些朋友称ThreadLocal为<strong>线程本地变量</strong>或<strong>线程本地存储</strong>。严格来说，ThreadLocal类并不属于多线程间的通信，而是<strong>让每个线程有自己”独立“的变量，线程之间互不影响</strong>。它为每个线程都创建一个<strong>副本</strong>，每个线程可以访问自己内部的副本变量。</p>
<p>ThreadLocal类最常用的就是set方法和get方法。示例代码：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadLocalDemo</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ThreadA</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="p">{</span>
        <span class="kd">private</span> <span class="n">ThreadLocal</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">threadLocal</span><span class="p">;</span>

        <span class="kd">public</span> <span class="nf">ThreadA</span><span class="p">(</span><span class="n">ThreadLocal</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">threadLocal</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">threadLocal</span> <span class="o">=</span> <span class="n">threadLocal</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">threadLocal</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;ThreadA输出：&quot;</span> <span class="o">+</span> <span class="n">threadLocal</span><span class="p">.</span><span class="na">get</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ThreadB</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="p">{</span>
            <span class="kd">private</span> <span class="n">ThreadLocal</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">threadLocal</span><span class="p">;</span>

            <span class="kd">public</span> <span class="nf">ThreadB</span><span class="p">(</span><span class="n">ThreadLocal</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">threadLocal</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="na">threadLocal</span> <span class="o">=</span> <span class="n">threadLocal</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
                <span class="n">threadLocal</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;B&quot;</span><span class="p">);</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;ThreadB输出：&quot;</span> <span class="o">+</span> <span class="n">threadLocal</span><span class="p">.</span><span class="na">get</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ThreadLocal</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">threadLocal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadLocal</span><span class="o">&lt;&gt;</span><span class="p">();</span>
            <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="k">new</span> <span class="n">ThreadA</span><span class="p">(</span><span class="n">threadLocal</span><span class="p">)).</span><span class="na">start</span><span class="p">();</span>
            <span class="k">new</span> <span class="n">Thread</span><span class="p">(</span><span class="k">new</span> <span class="n">ThreadB</span><span class="p">(</span><span class="n">threadLocal</span><span class="p">)).</span><span class="na">start</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 输出：</span>
<span class="n">ThreadA输出</span><span class="err">：</span><span class="n">A</span>
<span class="n">ThreadB输出</span><span class="err">：</span><span class="n">B</span>
</code></pre></div>
<h2 id="12-inheritablethreadlocal">12. InheritableThreadLocal<a class="headerlink" href="#12-inheritablethreadlocal" title="Permanent link">&para;</a></h2>
<p>InheritableThreadLocal类与ThreadLocal类稍有不同，Inheritable是继承的意思。它不仅仅是当前线程可以存取副本值，而且它的子线程也可以存取这个副本值。</p>

              
			  <hr><span id="busuanzi_container_page_pv"><font size="3" color="grey">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</font></span><br/>
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../10%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/10%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 网络编程" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              网络编程
            </div>
          </div>
        </a>
      
      
        
        <a href="../../12%20%E5%8F%8D%E5%B0%84/12%20%E5%8F%8D%E5%B0%84/" class="md-footer__link md-footer__link--next" aria-label="Next: 反射" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              反射
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 尚硅谷
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.1514a9a0.min.js"></script>
      
        <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      
    
  </body>
</html>