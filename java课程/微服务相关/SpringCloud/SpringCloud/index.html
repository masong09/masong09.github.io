
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.6">
    
    
      
        <title>SpringCloud - 我的文档</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#springcloud" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="我的文档" class="md-header__button md-logo" aria-label="我的文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            我的文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SpringCloud
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/01%20Java%E6%A6%82%E8%BF%B0/01%20-%20Java%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0/" class="md-tabs__link md-tabs__link--active">
        Java课程
      </a>
    </li>
  

  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC1%E7%AB%A0%20%E9%9D%A2%E8%AF%95%E8%AF%B4%E6%98%8E/" class="md-tabs__link">
        Java就业面试
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      学习文档
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="我的文档" class="md-nav__button md-logo" aria-label="我的文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    我的文档
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Java课程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java课程" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Java课程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1" type="checkbox" id="__nav_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1">
          Java基础
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java基础" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          Java基础
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_1" type="checkbox" id="__nav_1_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1_1">
          基础部分
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="基础部分" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_1">
          <span class="md-nav__icon md-icon"></span>
          基础部分
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/01%20Java%E6%A6%82%E8%BF%B0/01%20-%20Java%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0/" class="md-nav__link">
        Java概述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/02%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/02%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        基本语法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/03%20%E6%95%B0%E7%BB%84/03%20%E6%95%B0%E7%BB%84/" class="md-nav__link">
        数组
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/04%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/04%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" class="md-nav__link">
        面向对象
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86/05%20%E5%BC%82%E5%B8%B8/05%20%E5%BC%82%E5%B8%B8/" class="md-nav__link">
        异常
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1_2" type="checkbox" id="__nav_1_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_1_2">
          高级部分
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="高级部分" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_1_2">
          <span class="md-nav__icon md-icon"></span>
          高级部分
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/06%20%E5%B8%B8%E7%94%A8%E7%B1%BBAPI/06%20%E5%B8%B8%E7%94%A8%E7%B1%BBAPI/" class="md-nav__link">
        常用类API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/07%20%E9%9B%86%E5%90%88/07%20%E9%9B%86%E5%90%88/" class="md-nav__link">
        集合
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/08%20%E6%B3%9B%E5%9E%8B/08%20%E6%B3%9B%E5%9E%8B/" class="md-nav__link">
        泛型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/09%20File%E7%B1%BB%E4%B8%8EIO%E6%B5%81/09%20File%E7%B1%BB%E4%B8%8EIO%E6%B5%81/" class="md-nav__link">
        File类与IO流
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/10%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/10%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        网络编程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/11%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/11%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/" class="md-nav__link">
        多线程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/12%20%E5%8F%8D%E5%B0%84/12%20%E5%8F%8D%E5%B0%84/" class="md-nav__link">
        反射
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../java%E5%9F%BA%E7%A1%80/%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86/13%20Java8%E6%96%B0%E7%89%B9%E6%80%A7/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" class="md-nav__link">
        Java8新特性
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_2">
          MySQL数据库
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MySQL数据库" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          MySQL数据库
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/14%20MySQL/MySQL5.7%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3/" class="md-nav__link">
        MySQL5.7安装文档
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/14%20MySQL/MySQL%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        MySQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/14%20MySQL/JDBC%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        JDBC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_3">
          JavaWeb阶段
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="JavaWeb阶段" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          JavaWeb阶段
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day01/day01_HTML%26CSS/" class="md-nav__link">
        HTML&CSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day02/day02_JS%26%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="md-nav__link">
        JS&正则表达式
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day03/day03_VUE%26%E4%B9%A6%E5%9F%8E%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        VUE&书城第一阶段
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day04/day04_XML%26Tomcat%26Http%E5%8D%8F%E8%AE%AE/" class="md-nav__link">
        XML&Tomcat&Http协议
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day05/day05_Servlet/" class="md-nav__link">
        Servlet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day06/day06_Request%26Response/" class="md-nav__link">
        Request&Response
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day07/day07_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第二阶
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day08/day08_Thymeleaf/" class="md-nav__link">
        Thymeleaf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day09/day09_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第三阶段
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day10/day10_%E4%BC%9A%E8%AF%9D%26%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5%281%29/" class="md-nav__link">
        会话&书城项目第四阶段1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day11/day11_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第四阶段2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day12/day12_Filter%26Listener%26%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%BA%94%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        Filter&Listener&书城项目第五阶段1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day13/day13_%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E4%BA%94%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        书城项目第五阶段2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaWeb%E9%98%B6%E6%AE%B5/day14/day14_Ajax%26Axios%26%E4%B9%A6%E5%9F%8E%E9%A1%B9%E7%9B%AE%E7%AC%AC%E5%85%AD%E9%98%B6%E6%AE%B5/" class="md-nav__link">
        Ajax&Axios&书城项目第六阶段
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4">
          经典框架
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="经典框架" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          经典框架
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/Spring%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        Spring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/SpringMVC%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        SpringMVC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/MyBatis%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        MyBatis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/SSM%20%E6%95%B4%E5%90%88%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        SSM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/Maven%20%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        Maven
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/%E6%A1%86%E6%9E%B6%E9%AB%98%E7%BA%A7%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97%E4%B9%8BLinuxCentOS7/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BB%8F%E5%85%B8%E6%A1%86%E6%9E%B6/Redis/" class="md-nav__link">
        Redis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          微服务相关
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="微服务相关" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          微服务相关
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Docker/Docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ElasticSearch/ElasticSearch/" class="md-nav__link">
        ElasticSearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RabbitMQ/RabbitMQ/" class="md-nav__link">
        RabbitMQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SpringBoot/SpringBoot/" class="md-nav__link">
        SpringBoot
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SpringCloud
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        SpringCloud
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    课程计划
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 微服务理论
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 分布式概念
  </a>
  
    <nav class="md-nav" aria-label="2. 分布式概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 什么是分布式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 分布式与集群的关系
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 软件架构演变
  </a>
  
    <nav class="md-nav" aria-label="2.3 软件架构演变">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    2.3.1 单一应用架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    2.3.2 垂直应用架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233" class="md-nav__link">
    2.3.3 分布式服务架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234" class="md-nav__link">
    2.3.4 流动计算架构
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-rpc" class="md-nav__link">
    2.4 RPC是什么
  </a>
  
    <nav class="md-nav" aria-label="2.4 RPC是什么">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" class="md-nav__link">
    2.4.1 解决分布式系统的各个服务之间互相交互问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242-rpc" class="md-nav__link">
    2.4.2 RPC思想原理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" class="md-nav__link">
    2.4.3 服务之间的交互可以用两种方式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    2.5 分布式思想与基本概念
  </a>
  
    <nav class="md-nav" aria-label="2.5 分布式思想与基本概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251" class="md-nav__link">
    2.5.1 高并发
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#252" class="md-nav__link">
    2.5.2 高可用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#253" class="md-nav__link">
    2.5.3 注册中心
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#254" class="md-nav__link">
    2.5.4 负载均衡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#255" class="md-nav__link">
    2.5.5 服务雪崩
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#256" class="md-nav__link">
    2.5.6 熔断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#257" class="md-nav__link">
    2.5.7 限流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#258-api" class="md-nav__link">
    2.5.8 API网关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#259" class="md-nav__link">
    2.5.9 服务跟踪
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2510" class="md-nav__link">
    2.5.10 弹性云
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-springcloud" class="md-nav__link">
    3. SpringCloud背景
  </a>
  
    <nav class="md-nav" aria-label="3. SpringCloud背景">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 背景介绍
  </a>
  
    <nav class="md-nav" aria-label="3.1 背景介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311" class="md-nav__link">
    3.1.1 微服务架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#312-springboot" class="md-nav__link">
    3.1.2 微服务框架之SpringBoot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#313-springcloud" class="md-nav__link">
    3.1.3. 分布式系统微服务架构之SpringCloud
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#314" class="md-nav__link">
    3.1.4 组件概述
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-springbootspringcloud" class="md-nav__link">
    3.2 关于SpringBoot和SpringCloud版本
  </a>
  
    <nav class="md-nav" aria-label="3.2 关于SpringBoot和SpringCloud版本">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-springcloud" class="md-nav__link">
    3.2.1 SpringCloud版本选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-springboot" class="md-nav__link">
    3.2.2.    Springboot版本选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-boot" class="md-nav__link">
    3.2.3 官网看Boot版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#324-springcloud" class="md-nav__link">
    3.2.4 SpringCloud版本选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#325-springcloudspringboot" class="md-nav__link">
    3.2.5 SpringCloud和Springboot之间的依赖关系
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#326-springcloud" class="md-nav__link">
    3.2.6.    SpringCloud（授课选择版本）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-ideaproject" class="md-nav__link">
    3.3 微服务架构编码构建-IDEA新建project工作空间
  </a>
  
    <nav class="md-nav" aria-label="3.3 微服务架构编码构建-IDEA新建project工作空间">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-cloudproject" class="md-nav__link">
    3.3.1 微服务cloud整体聚合父工程Project
  </a>
  
    <nav class="md-nav" aria-label="3.3.1 微服务cloud整体聚合父工程Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-new-project" class="md-nav__link">
    1.   New Project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2.   聚合总工程名字
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-maven" class="md-nav__link">
    3.   Maven选版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4.   工程名字
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5.   字符编码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6.   注解生效激活
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-java" class="md-nav__link">
    7.   java编译版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-file-type" class="md-nav__link">
    8.   File Type过滤【可选】
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#332-pom" class="md-nav__link">
    3.3.2 父工程POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#333-maven" class="md-nav__link">
    3.3.3 Maven工程落地细节复习
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#334-mvninstall" class="md-nav__link">
    3.3.4 父工程创建完成执行mvn:install
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-rest-" class="md-nav__link">
    3.4 微服务架构编码构建-Rest微服务-【服务提供者】
  </a>
  
    <nav class="md-nav" aria-label="3.4 微服务架构编码构建-Rest微服务-【服务提供者】">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#341-cloud-provider-payment8001" class="md-nav__link">
    3.4.1 建cloud-provider-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#342-pom" class="md-nav__link">
    3.4.2 改POM文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#343-yml" class="md-nav__link">
    3.4.3 写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#344" class="md-nav__link">
    3.4.4 主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#345" class="md-nav__link">
    3.4.5 业务类
  </a>
  
    <nav class="md-nav" aria-label="3.4.5 业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-sql" class="md-nav__link">
    1.   建表SQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-entitles" class="md-nav__link">
    2.   Entitles
  </a>
  
    <nav class="md-nav" aria-label="2.   Entitles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-payment" class="md-nav__link">
    1)  主实体Payment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-jsoncommonresult" class="md-nav__link">
    2)  Json封装体CommonResult
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-lombok" class="md-nav__link">
    3)  安装lombok插件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-dao" class="md-nav__link">
    3.   Dao
  </a>
  
    <nav class="md-nav" aria-label="3.   Dao">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-paymentdao" class="md-nav__link">
    1)  接口PaymentDao
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-mybatis" class="md-nav__link">
    2)  mybatis的映射文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-service" class="md-nav__link">
    4.   Service
  </a>
  
    <nav class="md-nav" aria-label="4.   Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-paymentservice" class="md-nav__link">
    1)  接口PaymentService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-paymentserviceimpl" class="md-nav__link">
    2)  实现类PaymentServiceImpl
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-controller" class="md-nav__link">
    5.   Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#346" class="md-nav__link">
    3.4.6.    测试
  </a>
  
    <nav class="md-nav" aria-label="3.4.6.    测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-postmanget" class="md-nav__link">
    1.   postman测试get请求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-postmanpost" class="md-nav__link">
    2.   postman测试post请求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.   快速运行设置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#347-" class="md-nav__link">
    3.4.7 开发步骤-小总结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#348-devtools" class="md-nav__link">
    3.4.8 热部署Devtools
  </a>
  
    <nav class="md-nav" aria-label="3.4.8 热部署Devtools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-adding-devtools-to-your-project" class="md-nav__link">
    1.   Adding devtools to your project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-adding-plugin-to-your-pomxml" class="md-nav__link">
    2.   Adding plugin to your pom.xml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-enabling-automatic-build" class="md-nav__link">
    3.   Enabling automatic build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-update-the-value-of" class="md-nav__link">
    4.   Update the value of
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-idea" class="md-nav__link">
    5.   重启IDEA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-rest-" class="md-nav__link">
    3.5 微服务架构编码构建-Rest微服务-【服务消费者】
  </a>
  
    <nav class="md-nav" aria-label="3.5 微服务架构编码构建-Rest微服务-【服务消费者】">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351-cloud-consumer-order80" class="md-nav__link">
    3.5.1 建cloud-consumer-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352-pom" class="md-nav__link">
    3.5.2 改POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353-yml" class="md-nav__link">
    3.5.3 写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#354" class="md-nav__link">
    3.5.4 主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#355" class="md-nav__link">
    3.5.5 业务类
  </a>
  
    <nav class="md-nav" aria-label="3.5.5 业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-entities" class="md-nav__link">
    1.   创建entities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-resttemplate" class="md-nav__link">
    2.   RestTemplate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-config" class="md-nav__link">
    3.   config配置类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-controller" class="md-nav__link">
    4.   创建controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#356" class="md-nav__link">
    3.5.6 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36" class="md-nav__link">
    3.6 工程重构
  </a>
  
    <nav class="md-nav" aria-label="3.6 工程重构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#361" class="md-nav__link">
    3.6.1 观察问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#362-cloud-api-commons" class="md-nav__link">
    3.6.2 新建：cloud-api-commons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#363-pom" class="md-nav__link">
    3.6.3 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#364-entities" class="md-nav__link">
    3.6.4 entities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#365-mavenclean-install" class="md-nav__link">
    3.6.5 maven命令clean install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#366-808001" class="md-nav__link">
    3.6.6 订单80和支付8001分别改造
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37" class="md-nav__link">
    3.7 目前工程样图
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-eureka" class="md-nav__link">
    4. Eureka服务注册与发现
  </a>
  
    <nav class="md-nav" aria-label="4. Eureka服务注册与发现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-eureka" class="md-nav__link">
    4.1 Eureka基础知识
  </a>
  
    <nav class="md-nav" aria-label="4.1 Eureka基础知识">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411" class="md-nav__link">
    4.1.1 什么是服务治理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412" class="md-nav__link">
    4.1.2 什么是服务注册
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-eureka" class="md-nav__link">
    4.1.3 Eureka两组件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-eureka" class="md-nav__link">
    4.2 单机Eureka构建步骤
  </a>
  
    <nav class="md-nav" aria-label="4.2 单机Eureka构建步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-ideaeurekaserver" class="md-nav__link">
    4.2.1 IDEA生成eurekaServer端服务注册中心
  </a>
  
    <nav class="md-nav" aria-label="4.2.1 IDEA生成eurekaServer端服务注册中心">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-eureka-server7001" class="md-nav__link">
    1.   建Module：cloud-eureka-server7001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom" class="md-nav__link">
    2.   改POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml" class="md-nav__link">
    3.   写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422" class="md-nav__link">
    4.2.2 服务提供者
  </a>
  
    <nav class="md-nav" aria-label="4.2.2 服务提供者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-provider-payment8001" class="md-nav__link">
    1.   建Module：cloud-provider-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_1" class="md-nav__link">
    2.   改POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_1" class="md-nav__link">
    3.   写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_2" class="md-nav__link">
    5.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423" class="md-nav__link">
    4.2.3 服务消费者
  </a>
  
    <nav class="md-nav" aria-label="4.2.3 服务消费者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-consumer-order80" class="md-nav__link">
    1.   建Module：cloud-consumer-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_2" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_2" class="md-nav__link">
    3.   写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_3" class="md-nav__link">
    5.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-ribbon" class="md-nav__link">
    5. Ribbon负载均衡服务调用
  </a>
  
    <nav class="md-nav" aria-label="5. Ribbon负载均衡服务调用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    5.1 概述
  </a>
  
    <nav class="md-nav" aria-label="5.1 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511" class="md-nav__link">
    5.1.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512" class="md-nav__link">
    5.1.2 官网资料
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513" class="md-nav__link">
    5.1.3 能干嘛
  </a>
  
    <nav class="md-nav" aria-label="5.1.3 能干嘛">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-lb" class="md-nav__link">
    1.   LB（负载均衡）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    2.   一句话
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-ribbon" class="md-nav__link">
    5.2 Ribbon负载均衡演示
  </a>
  
    <nav class="md-nav" aria-label="5.2 Ribbon负载均衡演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521" class="md-nav__link">
    5.2.1 架构说明
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-pom" class="md-nav__link">
    5.2.2 POM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-ribbonirule" class="md-nav__link">
    5.3 Ribbon核心组件Irule
  </a>
  
    <nav class="md-nav" aria-label="5.3 Ribbon核心组件Irule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-irule" class="md-nav__link">
    5.3.1 IRule：根据特定算法从服务列表中选取一个要访问的服务
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532" class="md-nav__link">
    5.3.2 如何替换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-package" class="md-nav__link">
    5.3.3 新建package（注意：包的位置）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-myselfrule" class="md-nav__link">
    5.3.4 上面包下新建MySelfRule规则类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#535-ribbonclient" class="md-nav__link">
    5.3.5 主启动类添加@RibbonClient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#536" class="md-nav__link">
    5.3.6 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-ribbon" class="md-nav__link">
    5.4 Ribbon负载均衡算法
  </a>
  
    <nav class="md-nav" aria-label="5.4 Ribbon负载均衡算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541" class="md-nav__link">
    5.4.1 原理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-openfeign" class="md-nav__link">
    6. OpenFeign服务接口调用
  </a>
  
    <nav class="md-nav" aria-label="6. OpenFeign服务接口调用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1. 概述
  </a>
  
    <nav class="md-nav" aria-label="6.1. 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-openfeign" class="md-nav__link">
    6.1.1 OpenFeign是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#612" class="md-nav__link">
    6.1.2 能干嘛
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-openfeign" class="md-nav__link">
    6.2 OpenFeign使用步骤
  </a>
  
    <nav class="md-nav" aria-label="6.2 OpenFeign使用步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621" class="md-nav__link">
    6.2.1 接口+注解
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-modulecloud-consumer-feign-order80" class="md-nav__link">
    6.2.2 新建Module：cloud-consumer-feign-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-pom" class="md-nav__link">
    6.2.3 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#624-yml" class="md-nav__link">
    6.2.4 YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#625" class="md-nav__link">
    6.2.5 主启动类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#626" class="md-nav__link">
    6.2.6 业务类
  </a>
  
    <nav class="md-nav" aria-label="6.2.6 业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-feignclientprovider" class="md-nav__link">
    1.   业务逻辑接口+@FeignClient配置调用provider服务
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-paymentfeignservicefeignclient" class="md-nav__link">
    2.   新建PaymentFeignService接口并新增注解@FeignClient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-controller" class="md-nav__link">
    3.   控制层Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#627" class="md-nav__link">
    6.2.7 测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#628" class="md-nav__link">
    6.2.8 小总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-openfeign" class="md-nav__link">
    6.3 OpenFeign超时控制
  </a>
  
    <nav class="md-nav" aria-label="6.3 OpenFeign超时控制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#631" class="md-nav__link">
    6.3.1 超时设置，故意设置超时演示出错情况
  </a>
  
    <nav class="md-nav" aria-label="6.3.1 超时设置，故意设置超时演示出错情况">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-8001" class="md-nav__link">
    1.   服务提供方8001故意写暂停程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-80paymentfeignservice" class="md-nav__link">
    2.   服务消费方80添加超时方法PaymentFeignService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-80orderfeigncontroller" class="md-nav__link">
    3.   服务消费方80添加超时方法OrderFeignController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_4" class="md-nav__link">
    4.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#632" class="md-nav__link">
    6.3.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#633-ymlopenfeign" class="md-nav__link">
    6.3.3 YML中需要开启OpenFeign客户端超时控制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-openfeign" class="md-nav__link">
    6.4 OpenFeign日志打印功能
  </a>
  
    <nav class="md-nav" aria-label="6.4 OpenFeign日志打印功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#641" class="md-nav__link">
    6.4.1 日志打印功能
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#642" class="md-nav__link">
    6.4.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#643" class="md-nav__link">
    6.4.3 日志级别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#644-bean" class="md-nav__link">
    6.4.4 配置日志bean
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#645-ymlfeign" class="md-nav__link">
    6.4.5 YML文件里需要开启日志的Feign客户端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#646" class="md-nav__link">
    6.4.6 后台日志查看
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-hystrix" class="md-nav__link">
    7. Hystrix断路器
  </a>
  
    <nav class="md-nav" aria-label="7. Hystrix断路器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    7.1 概述
  </a>
  
    <nav class="md-nav" aria-label="7.1 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#711" class="md-nav__link">
    7.1.1 分布式系统面临的问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#712" class="md-nav__link">
    7.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#713" class="md-nav__link">
    7.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#714" class="md-nav__link">
    7.1.4 官网资料
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#715-hystrix" class="md-nav__link">
    7.1.5 Hystrix官宣，停更进维
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-hystrix" class="md-nav__link">
    7.2 Hystrix重要概念
  </a>
  
    <nav class="md-nav" aria-label="7.2 Hystrix重要概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#721-fallback" class="md-nav__link">
    7.2.1 服务降级Fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#722-breaker" class="md-nav__link">
    7.2.2 服务熔断Breaker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#723-flowlimit" class="md-nav__link">
    7.2.3 服务限流Flowlimit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-hystrix" class="md-nav__link">
    7.3 hystrix案例
  </a>
  
    <nav class="md-nav" aria-label="7.3 hystrix案例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#731" class="md-nav__link">
    7.3.1 构建
  </a>
  
    <nav class="md-nav" aria-label="7.3.1 构建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-provider-hystrix-payment8001" class="md-nav__link">
    1.   新建Module：cloud-provider-hystrix-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_3" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_3" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_5" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_4" class="md-nav__link">
    5.   业务类
  </a>
  
    <nav class="md-nav" aria-label="5.   业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serviceserviceimpl" class="md-nav__link">
    Service/ServiceImpl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller" class="md-nav__link">
    Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_1" class="md-nav__link">
    6.   正常测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#732" class="md-nav__link">
    7.3.2 高并发测试
  </a>
  
    <nav class="md-nav" aria-label="7.3.2 高并发测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-but" class="md-nav__link">
    1. 上述在非高并发情形下，还能勉强满足  but.....
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-jmeter" class="md-nav__link">
    2. Jmeter压测测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-jmeter" class="md-nav__link">
    3.   Jmeter压测结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-80cloud-consumer-feign-hystrix-order80" class="md-nav__link">
    4.   看热闹不嫌弃事大，80新建加入：cloud-consumer-feign-hystrix-order80
  </a>
  
    <nav class="md-nav" aria-label="4.   看热闹不嫌弃事大，80新建加入：cloud-consumer-feign-hystrix-order80">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-consumer-feign-hystrix-order80" class="md-nav__link">
    1)  新建：cloud-consumer-feign-hystrix-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_4" class="md-nav__link">
    2)  POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_4" class="md-nav__link">
    3)  YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_6" class="md-nav__link">
    4)  主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_5" class="md-nav__link">
    5)  业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_2" class="md-nav__link">
    6)  正常测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7)  高并发测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#733" class="md-nav__link">
    7.3.3 故障现象和导致原因
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#734" class="md-nav__link">
    7.3.4 上诉结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#735" class="md-nav__link">
    7.3.5 如何解决？解决的要求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#736" class="md-nav__link">
    7.3.6 服务降级
  </a>
  
    <nav class="md-nav" aria-label="7.3.6 服务降级">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1. 降低配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-8001" class="md-nav__link">
    2.   8001先从自身找问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-8001fallback" class="md-nav__link">
    3.   8001fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-80fallback" class="md-nav__link">
    4.   80fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_6" class="md-nav__link">
    5.   目前问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_3" class="md-nav__link">
    6.   解决问题
  </a>
  
    <nav class="md-nav" aria-label="6.   解决问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1)  每个方法配置一个？？？膨胀
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2)  和业务逻辑混一起？？？混乱
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3)  测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#737" class="md-nav__link">
    7.3.7 服务熔断
  </a>
  
    <nav class="md-nav" aria-label="7.3.7 服务熔断">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    1.   断路器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2.   熔断是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    3.   大神论文：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_7" class="md-nav__link">
    4.   实操
  </a>
  
    <nav class="md-nav" aria-label="4.   实操">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-provider-hystrix-payment8001" class="md-nav__link">
    1)  修改cloud-provider-hystrix-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-paymentserviceimpl_1" class="md-nav__link">
    2)  PaymentServiceImpl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-paymentcontroller" class="md-nav__link">
    3)  PaymentController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_8" class="md-nav__link">
    4)  测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_7" class="md-nav__link">
    5.   原理（小总结）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1)  大神结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    2)  熔断类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    3)  官网断路器流程图
  </a>
  
    <nav class="md-nav" aria-label="3)  官网断路器流程图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    ①  官网步骤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    ②  断路器在什么情况下开始起作用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    ③断路器开启或者关闭的条件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_9" class="md-nav__link">
    ④  断路器打开之后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-all" class="md-nav__link">
    ⑤  All配置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#738" class="md-nav__link">
    7.3.8 服务限流
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-hystrixdashboard" class="md-nav__link">
    7.4 服务监控hystrixDashboard
  </a>
  
    <nav class="md-nav" aria-label="7.4 服务监控hystrixDashboard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#741" class="md-nav__link">
    7.4.1 概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#742-9001" class="md-nav__link">
    7.4.2 仪表盘9001
  </a>
  
    <nav class="md-nav" aria-label="7.4.2 仪表盘9001">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-consumer-hystrix-dashboard9001" class="md-nav__link">
    1. 新建Module：cloud-consumer-hystrix-dashboard9001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_5" class="md-nav__link">
    2. POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_5" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-hystrixdashboardmain9001enablehystrixdashboard" class="md-nav__link">
    4.   HystrixDashboardMain9001+新注解@EnableHystrixDashboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-provider800180028003" class="md-nav__link">
    5.   所有Provider微服务提供类（8001/8002/8003）都需要监控依赖配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-cloud-consumer-hystrix-dashboard90018001" class="md-nav__link">
    6.   启动cloud-consumer-hystrix-dashboard9001该微服务后续将监控微服务8001
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#743" class="md-nav__link">
    7.4.3 断路器演示
  </a>
  
    <nav class="md-nav" aria-label="7.4.3 断路器演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-provider-hystrix-payment8001_1" class="md-nav__link">
    1.   修改cloud-provider-hystrix-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    2.   监控测试
  </a>
  
    <nav class="md-nav" aria-label="2.   监控测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-1eureka" class="md-nav__link">
    1)  启动1个eureka
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    2)  观察监控窗口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-gateway" class="md-nav__link">
    8. Gateway新一代网关
  </a>
  
    <nav class="md-nav" aria-label="8. Gateway新一代网关">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" class="md-nav__link">
    8.1 概述简介
  </a>
  
    <nav class="md-nav" aria-label="8.1 概述简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#811" class="md-nav__link">
    8.1.1 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#812" class="md-nav__link">
    8.1.2 是什么
  </a>
  
    <nav class="md-nav" aria-label="8.1.2 是什么">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8121-getewayzuul1x" class="md-nav__link">
    8.1.2.1 一句话：Geteway是原Zuul1.x版的替代
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8122" class="md-nav__link">
    8.1.2.2 概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8123" class="md-nav__link">
    8.1.2.3 一句话
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#813" class="md-nav__link">
    8.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#814" class="md-nav__link">
    8.1.4 微服务架构中网关在哪里
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    8.2 三大核心概念
  </a>
  
    <nav class="md-nav" aria-label="8.2 三大核心概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#821-route" class="md-nav__link">
    8.2.1 Route(路由)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#822-predicate" class="md-nav__link">
    8.2.2 Predicate（断言）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#823-filter" class="md-nav__link">
    8.2.3 Filter(过滤)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224" class="md-nav__link">
    2.2.4.    总体
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-gateway" class="md-nav__link">
    2.3. Gateway工作流程
  </a>
  
    <nav class="md-nav" aria-label="2.3. Gateway工作流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231_1" class="md-nav__link">
    2.3.1.    官网总结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#832" class="md-nav__link">
    8.3.2 核心逻辑：路由转发+执行过滤器链
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84" class="md-nav__link">
    8.4 入门配置
  </a>
  
    <nav class="md-nav" aria-label="8.4 入门配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#841-modulecloud-gateway-gateway9527" class="md-nav__link">
    8.4.1 新建Module：cloud-gateway-gateway9527
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#842-pom" class="md-nav__link">
    8.4.2 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#843-yml" class="md-nav__link">
    8.4.3 YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#844" class="md-nav__link">
    8.4.4 业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#845" class="md-nav__link">
    8.4.5 主启动类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#846-9527" class="md-nav__link">
    8.4.6 9527网关如何做路由映射呢？？？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#847-yml" class="md-nav__link">
    8.4.7 YML新增网关配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#848" class="md-nav__link">
    8.4.8 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85" class="md-nav__link">
    8.5 通过微服务名实现动态路由
  </a>
  
    <nav class="md-nav" aria-label="8.5 通过微服务名实现动态路由">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#851" class="md-nav__link">
    8.5.1 启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#852-pom" class="md-nav__link">
    8.5.2 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#853-yml" class="md-nav__link">
    8.5.3 YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#854" class="md-nav__link">
    8.5.4 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86-predicate" class="md-nav__link">
    8.6 Predicate的使用
  </a>
  
    <nav class="md-nav" aria-label="8.6 Predicate的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#861" class="md-nav__link">
    8.6.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#862-route-predicate-factories" class="md-nav__link">
    8.6.2 Route Predicate Factories这个是什么东东？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#863-route-predicate" class="md-nav__link">
    8.6.3 常用的Route Predicate
  </a>
  
    <nav class="md-nav" aria-label="8.6.3 常用的Route Predicate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1after-route-predicate" class="md-nav__link">
    1.After Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2before-route-predicate" class="md-nav__link">
    2.Before Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3between-route-predicate" class="md-nav__link">
    3.Between Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4cookie-route-predicate" class="md-nav__link">
    4.Cookie Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5header-route-predicate" class="md-nav__link">
    5.Header Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6host-route-predicate" class="md-nav__link">
    6.Host Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7method-route-predicate" class="md-nav__link">
    7.Method Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8path-route-predicate" class="md-nav__link">
    8.Path Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-query-route-predicate" class="md-nav__link">
    9. Query Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10.小总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#87-filter" class="md-nav__link">
    8.7 Filter的使用
  </a>
  
    <nav class="md-nav" aria-label="8.7 Filter的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#871" class="md-nav__link">
    8.7.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#872-spring-cloud-gatewayfilter" class="md-nav__link">
    8.7.2 Spring Cloud Gateway的Filter
  </a>
  
    <nav class="md-nav" aria-label="8.7.2 Spring Cloud Gateway的Filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-only-two" class="md-nav__link">
    1.   生命周期，Only Two
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-only-two" class="md-nav__link">
    2.   种类，Only Two
  </a>
  
    <nav class="md-nav" aria-label="2.   种类，Only Two">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-gatewayfilter31" class="md-nav__link">
    1)  GatewayFilter（31种之多）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-globalfilter" class="md-nav__link">
    2)  GlobalFilter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#873-gatewayfilter" class="md-nav__link">
    8.7.3 常用的GatewayFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#874" class="md-nav__link">
    8.7.4 自定义过滤器
  </a>
  
    <nav class="md-nav" aria-label="8.7.4 自定义过滤器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-globalfilter" class="md-nav__link">
    1.   自定义全局GlobalFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    2.   能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    3.   案例代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_10" class="md-nav__link">
    4.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-springcloud-sleuth" class="md-nav__link">
    9. SpringCloud Sleuth分布式链路请求跟踪
  </a>
  
    <nav class="md-nav" aria-label="9. SpringCloud Sleuth分布式链路请求跟踪">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 概述
  </a>
  
    <nav class="md-nav" aria-label="9.1 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#911" class="md-nav__link">
    9.1.1 为什么会出现这个技术？需要解决哪些问题？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#912" class="md-nav__link">
    9.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#913" class="md-nav__link">
    9.1.3 解决
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 搭建链路监控步骤
  </a>
  
    <nav class="md-nav" aria-label="9.2 搭建链路监控步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#921-zipkin" class="md-nav__link">
    9.2.1 zipkin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#922" class="md-nav__link">
    9.2.2 服务提供者
  </a>
  
    <nav class="md-nav" aria-label="9.2.2 服务提供者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-provider-payment8001" class="md-nav__link">
    1.   修改：cloud-provider-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_6" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_6" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-paymentcontroller" class="md-nav__link">
    4.   业务类PaymentController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#923" class="md-nav__link">
    9.2.3 服务消费者（调用方）
  </a>
  
    <nav class="md-nav" aria-label="9.2.3 服务消费者（调用方）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-consumer-order80" class="md-nav__link">
    1.   修改：cloud-consumer-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_7" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_7" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-paymentcontroller_1" class="md-nav__link">
    4.   业务类PaymentController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#924-eureka7001800180" class="md-nav__link">
    9.2.4 依次启动eureka7001/8001/80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#925-httplocalhost9411" class="md-nav__link">
    9.2.5 打开浏览器访问： http://localhost:9411
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-springcloud-alibaba" class="md-nav__link">
    10. SpringCloud Alibaba入门简介
  </a>
  
    <nav class="md-nav" aria-label="10. SpringCloud Alibaba入门简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-whyspringcloud-alibaba" class="md-nav__link">
    10.1 why会出现SpringCloud alibaba
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-springcloud-alibaba" class="md-nav__link">
    10.2 SpringCloud alibaba带来了什么？
  </a>
  
    <nav class="md-nav" aria-label="10.2 SpringCloud alibaba带来了什么？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1021" class="md-nav__link">
    10.2.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1022" class="md-nav__link">
    10.2.2 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1023" class="md-nav__link">
    10.2.3 去哪下
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1024" class="md-nav__link">
    10.2.4 怎么玩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-springcloud-alibaba" class="md-nav__link">
    10.3 SpringCloud alibaba学习资料获取
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-springcloud-alibaba-nacos" class="md-nav__link">
    11. SpringCloud Alibaba Nacos服务注册和配置中心
  </a>
  
    <nav class="md-nav" aria-label="11. SpringCloud Alibaba Nacos服务注册和配置中心">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-nacos" class="md-nav__link">
    11.1 Nacos简介
  </a>
  
    <nav class="md-nav" aria-label="11.1 Nacos简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1111-nacos" class="md-nav__link">
    11.1.1 为什么叫Nacos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1112" class="md-nav__link">
    11.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1113" class="md-nav__link">
    11.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#314_1" class="md-nav__link">
    3.1.4.    去哪下
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1115" class="md-nav__link">
    11.1.5 各种注册中心比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112-nacos" class="md-nav__link">
    11.2 安装并运行Nacos
  </a>
  
    <nav class="md-nav" aria-label="11.2 安装并运行Nacos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1121-java8mavenok" class="md-nav__link">
    11.2.1 本地Java8+Maven环境已经OK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1122-nacos" class="md-nav__link">
    11.2.2 先从官网下载Nacos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1123-binstartupcmd" class="md-nav__link">
    11.2.3 解压安装包，直接运行bin/startup.cmd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1124" class="md-nav__link">
    11.2.4 命令运行成功后直接访问
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1125" class="md-nav__link">
    11.2.5 登录结果页面
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#113-nacos" class="md-nav__link">
    11.3 Nacos作为服务注册中心演示
  </a>
  
    <nav class="md-nav" aria-label="11.3 Nacos作为服务注册中心演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1131" class="md-nav__link">
    11.3.1 官网文档
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1132-nacos" class="md-nav__link">
    11.3.2 基于Nacos的服务提供者
  </a>
  
    <nav class="md-nav" aria-label="11.3.2 基于Nacos的服务提供者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-provider-payment9001" class="md-nav__link">
    1.   新建Module：cloudalibaba-provider-payment9001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_8" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_8" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_11" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_8" class="md-nav__link">
    5.   业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_4" class="md-nav__link">
    6.   测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-nacos90019002" class="md-nav__link">
    7.   为了下一章节演示nacos的负载均衡，参照9001新建9002
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1133-nacos" class="md-nav__link">
    11.3.3 基于Nacos的服务消费者
  </a>
  
    <nav class="md-nav" aria-label="11.3.3 基于Nacos的服务消费者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-consumer-nacos-order83" class="md-nav__link">
    1.   新建Module：cloudalibaba-consumer-nacos-order83
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_9" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_9" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_12" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_9" class="md-nav__link">
    5.   业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-ordernacoscontroller" class="md-nav__link">
    6.   OrderNacosController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_1" class="md-nav__link">
    7.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1134" class="md-nav__link">
    11.3.4 服务注册中心对比
  </a>
  
    <nav class="md-nav" aria-label="11.3.4 服务注册中心对比">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nacoscap" class="md-nav__link">
    1.   Nacos和CAP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nacosapcp" class="md-nav__link">
    2.   Nacos支持AP和CP模式的切换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#114-nacos" class="md-nav__link">
    11.4 Nacos作为服务配置中心演示
  </a>
  
    <nav class="md-nav" aria-label="11.4 Nacos作为服务配置中心演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1141-nacos-" class="md-nav__link">
    11.4.1 Nacos作为配置中心-基础配置
  </a>
  
    <nav class="md-nav" aria-label="11.4.1 Nacos作为配置中心-基础配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-config-nacos-client3377" class="md-nav__link">
    1.   创建Module：cloudalibaba-config-nacos-client3377
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_10" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_10" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_13" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-configclientcontroller" class="md-nav__link">
    5.   业务类:ConfigClientController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-nacos" class="md-nav__link">
    6.   在Nacos中添加配置信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_2" class="md-nav__link">
    7.   测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8.   自带动态刷新
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1142-nacos-" class="md-nav__link">
    11.4.2 Nacos作为配置中心-分类配置
  </a>
  
    <nav class="md-nav" aria-label="11.4.2 Nacos作为配置中心-分类配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    1.   问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nacos" class="md-nav__link">
    2.   Nacos的图形化管理界面
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-namespacegroupdata-id" class="md-nav__link">
    3.   Namespace+Group+Data ID三者关系？为什么这么设计？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-case" class="md-nav__link">
    4.   Case
  </a>
  
    <nav class="md-nav" aria-label="4.   Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dataid" class="md-nav__link">
    1)  DataID方案
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-group" class="md-nav__link">
    2)  Group方案
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-namespace" class="md-nav__link">
    3)  Namespace方案
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#115-nacos" class="md-nav__link">
    11.5 Nacos集群和持久化配置（重要）
  </a>
  
    <nav class="md-nav" aria-label="11.5 Nacos集群和持久化配置（重要）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1151" class="md-nav__link">
    11.5.1 官网说明
  </a>
  
    <nav class="md-nav" aria-label="11.5.1 官网说明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    1.   官网架构图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_10" class="md-nav__link">
    2.   上图官网翻译，真实情况
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    3.   说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1152-nacos" class="md-nav__link">
    11.5.2 Nacos持久化配置解释
  </a>
  
    <nav class="md-nav" aria-label="11.5.2 Nacos持久化配置解释">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nacosderby" class="md-nav__link">
    1.   Nacos默认自带的是嵌入式数据库derby
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-derbymysql" class="md-nav__link">
    2.   derby到mysql切换配置步骤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nacosderby" class="md-nav__link">
    3.   启动nacos，可以看到是个全新的空记录界面，以前是记录进derby
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-mysql" class="md-nav__link">
    4.   测试：新建配置，发现配置信息写入了MySQL数据库
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1153-linuxnacosmysql" class="md-nav__link">
    11.5.3 Linux版Nacos+MySQL生产环境配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-1nginx3nacos1mysql" class="md-nav__link">
    1.   预计需要，1个nginx+3个nacos注册中心+1个mysql
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nacoslinux" class="md-nav__link">
    2.   Nacos下载linux版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_7" class="md-nav__link">
    3.   集群配置步骤（重点）
  </a>
  
    <nav class="md-nav" aria-label="3.   集群配置步骤（重点）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1linuxmysql" class="md-nav__link">
    1.Linux服务器上mysql数据库配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2applicationproperties" class="md-nav__link">
    2.application.properties配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3linuxnacosclusterconf" class="md-nav__link">
    3.Linux服务器上nacos的集群配置cluster.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4nacosstartupsh" class="md-nav__link">
    4.编辑Nacos的启动脚本startup.sh，使它能够接受不同的启动端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5nginx" class="md-nav__link">
    5.Nginx的配置，由它作为负载均衡器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#61nginx3nacos1mysql" class="md-nav__link">
    6.截止到此处，1个Nginx+3个nacos注册中心+1个mysql
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_14" class="md-nav__link">
    4.   测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_10" class="md-nav__link">
    5.   高可用小总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-springcloud-alibaba-sentinel" class="md-nav__link">
    12. SpringCloud Alibaba Sentinel实现熔断与限流
  </a>
  
    <nav class="md-nav" aria-label="12. SpringCloud Alibaba Sentinel实现熔断与限流">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-sentinel" class="md-nav__link">
    12.1 Sentinel介绍
  </a>
  
    <nav class="md-nav" aria-label="12.1 Sentinel介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1211" class="md-nav__link">
    12.1.1 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1212" class="md-nav__link">
    12.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1213" class="md-nav__link">
    12.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1214" class="md-nav__link">
    12.1.4 去哪下
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1215" class="md-nav__link">
    12.1.5 怎么玩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-sentinel" class="md-nav__link">
    12.2 安装Sentinel控制台
  </a>
  
    <nav class="md-nav" aria-label="12.2 安装Sentinel控制台">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1221-sentinel2" class="md-nav__link">
    12.2.1 sentinel组件由2部分组成
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1222" class="md-nav__link">
    12.2.2 安装步骤
  </a>
  
    <nav class="md-nav" aria-label="12.2.2 安装步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    1.   下载
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_11" class="md-nav__link">
    2.   运行命令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sentinel" class="md-nav__link">
    3.   访问sentinel管理界面
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    12.3 初始化演示工程
  </a>
  
    <nav class="md-nav" aria-label="12.3 初始化演示工程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1231-nacos8848" class="md-nav__link">
    12.3.1 启动Nacos8848成功
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1232" class="md-nav__link">
    12.3.2 案例
  </a>
  
    <nav class="md-nav" aria-label="12.3.2 案例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-sentinel-service8401" class="md-nav__link">
    1.   创建Module：cloudalibaba-sentinel-service8401
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_11" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_11" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_15" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-flowlimitcontroller" class="md-nav__link">
    5.   业务类FlowLimitController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1233-sentinel8080" class="md-nav__link">
    12.3.3 启动Sentinel8080
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1234-8401" class="md-nav__link">
    12.3.4 启动微服务8401
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1235-8401sentienl" class="md-nav__link">
    12.3.5 启动8401微服务后查看sentienl控制台
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124" class="md-nav__link">
    12.4 流控规则
  </a>
  
    <nav class="md-nav" aria-label="12.4 流控规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1241" class="md-nav__link">
    12.4.1 基本介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1242" class="md-nav__link">
    12.4.2 流控模式
  </a>
  
    <nav class="md-nav" aria-label="12.4.2 流控模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    1.   直接（默认）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_12" class="md-nav__link">
    2.   关联
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-a" class="md-nav__link">
    3.   配置A
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-postmantestb" class="md-nav__link">
    4.   postman模拟并发密集访问testB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_11" class="md-nav__link">
    5.   链路
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1243" class="md-nav__link">
    12.4.3 流控效果
  </a>
  
    <nav class="md-nav" aria-label="12.4.3 流控效果">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-" class="md-nav__link">
    1.   直接-&gt;快速失败（默认的流控处理）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_13" class="md-nav__link">
    2.   预热
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_8" class="md-nav__link">
    3.   排队等待
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125" class="md-nav__link">
    12.5 降级规则
  </a>
  
    <nav class="md-nav" aria-label="12.5 降级规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1251" class="md-nav__link">
    12.5.1 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1252" class="md-nav__link">
    12.5.2 基本介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1253" class="md-nav__link">
    12.5.3 降级策略实战
  </a>
  
    <nav class="md-nav" aria-label="12.5.3 降级策略实战">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-rt" class="md-nav__link">
    1.   RT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_14" class="md-nav__link">
    2.   异常比例
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_9" class="md-nav__link">
    3.   异常数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#126-key" class="md-nav__link">
    12.6 热点key限流
  </a>
  
    <nav class="md-nav" aria-label="12.6 热点key限流">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1261" class="md-nav__link">
    12.6.1 基本介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1262" class="md-nav__link">
    12.6.2 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1263" class="md-nav__link">
    12.6.3 承上启下复习
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1264" class="md-nav__link">
    12.6.4 代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1265" class="md-nav__link">
    12.6.5 配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1266" class="md-nav__link">
    12.6.6 参数例外项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1267" class="md-nav__link">
    12.6.7 其他
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#127" class="md-nav__link">
    12.7 系统规则
  </a>
  
    <nav class="md-nav" aria-label="12.7 系统规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1271" class="md-nav__link">
    12.7.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1272" class="md-nav__link">
    12.7.2 各项配置参数说明
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1273-qps" class="md-nav__link">
    12.7.3 配置全局QPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#128-sentinelresource" class="md-nav__link">
    12.8 @SentinelResource
  </a>
  
    <nav class="md-nav" aria-label="12.8 @SentinelResource">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1281" class="md-nav__link">
    12.8.1 按资源名称限流+后续处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1282-url" class="md-nav__link">
    12.8.2 按照Url地址限流+后续处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1283" class="md-nav__link">
    12.8.3 上面兜底方法面临的问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1284" class="md-nav__link">
    12.8.4 客户自定义限流处理逻辑
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1285" class="md-nav__link">
    12.8.5 更多注解属性说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#129" class="md-nav__link">
    12.9 服务熔断功能
  </a>
  
    <nav class="md-nav" aria-label="12.9 服务熔断功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1291-sentinelribbonopenfeignfallback" class="md-nav__link">
    12.9.1 sentinel整合ribbon+openFeign+fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1292-ribbon" class="md-nav__link">
    12.9.2 Ribbon系列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-nacossentinel" class="md-nav__link">
    1.   启动nacos和sentinel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-90039004" class="md-nav__link">
    2.   提供者9003/9004
  </a>
  
    <nav class="md-nav" aria-label="2.   提供者9003/9004">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-provider-payment90039004" class="md-nav__link">
    1)  新建Module：cloudalibaba-provider-payment9003/9004
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_12" class="md-nav__link">
    2)  POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_12" class="md-nav__link">
    3)  YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_16" class="md-nav__link">
    4)  主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_12" class="md-nav__link">
    5)  业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_5" class="md-nav__link">
    6)  测试地址
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-84" class="md-nav__link">
    3.   消费者84
  </a>
  
    <nav class="md-nav" aria-label="3.   消费者84">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-consumer-nacos-order84" class="md-nav__link">
    1)  新建Module：cloudalibaba-consumer-nacos-order84
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_13" class="md-nav__link">
    2)  POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_13" class="md-nav__link">
    3)  YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_17" class="md-nav__link">
    4)  主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_13" class="md-nav__link">
    5)  业务类
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_18" class="md-nav__link">
    4.   目的
  </a>
  
    <nav class="md-nav" aria-label="4.   目的">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    实验1.没有任何配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2fallback" class="md-nav__link">
    实验2.只配置fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3blockhandler" class="md-nav__link">
    实验3.只配置blockHandler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4fallbackblockhandler" class="md-nav__link">
    实验4.fallback和blockHandler都配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_14" class="md-nav__link">
    实验5.忽略属性…
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1293-feign" class="md-nav__link">
    12.9.3 Feign系列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-84" class="md-nav__link">
    1.   修改84模块
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_14" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_14" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_19" class="md-nav__link">
    4.   业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_15" class="md-nav__link">
    5.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-httplocalhost84consumerpaymentsql1" class="md-nav__link">
    6.   http://localhost:84/consumer/paymentSQL/1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-849003900384" class="md-nav__link">
    7.   测试84调用9003，此时故意关闭9003微服务提供者，看84消费侧自动降级，不会被耗死
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#194" class="md-nav__link">
    1.9.4.    熔断框架比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210" class="md-nav__link">
    12.10 规则持久化
  </a>
  
    <nav class="md-nav" aria-label="12.10 规则持久化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#12101" class="md-nav__link">
    12.10.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12102" class="md-nav__link">
    12.10.2 怎么玩
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12103" class="md-nav__link">
    12.10.3 步骤
  </a>
  
    <nav class="md-nav" aria-label="12.10.3 步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloudalibaba-sentinel-service8401" class="md-nav__link">
    1.   修改：cloudalibaba-sentinel-service8401
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_15" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_15" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-nacos" class="md-nav__link">
    4.   添加Nacos业务规则配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-8401sentinel" class="md-nav__link">
    5.   启动8401后刷新sentinel发现业务规则有了
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_6" class="md-nav__link">
    6.   快速访问测试接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-8401sentinel" class="md-nav__link">
    7.   停止8401再看sentinel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-8401sentinel" class="md-nav__link">
    8.   重新启动8401再看sentinel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6">
          高级技术
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="高级技术" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          高级技术
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/git/Git%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/juc/JUC/" class="md-nav__link">
        JUC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/jvm/jvm/" class="md-nav__link">
        jvm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/mysql%E9%AB%98%E7%BA%A7/MySQL%E9%AB%98%E7%BA%A7/" class="md-nav__link">
        mysql高级
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/mysql%E9%AB%98%E7%BA%A7/MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/" class="md-nav__link">
        MySQL主从复制
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/MyCat/Mycat/" class="md-nav__link">
        MyCat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/nginx/Nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" type="checkbox" id="__nav_1_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7">
          项目文档
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="项目文档" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          项目文档
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_1" type="checkbox" id="__nav_1_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_1">
          美年旅游
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="美年旅游" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_1">
          <span class="md-nav__icon md-icon"></span>
          美年旅游
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day01/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC1%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游01
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day02/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC2%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day03/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC3%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day04/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC4%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day05/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC5%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游05
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day06/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC6%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游06
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day07/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC7%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游07
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day08/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC8%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游08
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day09/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC9%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游09
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day10/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC10%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%BE%8E%E5%B9%B4/day11/%E7%BE%8E%E5%B9%B4%E5%9B%BD%E5%AE%BE%E9%A1%B9%E7%9B%AE%E8%AE%B2%E4%B9%89%EF%BC%88%E7%AC%AC11%E7%AB%A0%EF%BC%89/" class="md-nav__link">
        美年旅游11
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_2" type="checkbox" id="__nav_1_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_2">
          尚邻网
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="尚邻网" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_2">
          <span class="md-nav__icon md-icon"></span>
          尚邻网
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/1.%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        搭建环境
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/2.%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86/" class="md-nav__link">
        用户角色管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/3.Apache%20Dubbo/" class="md-nav__link">
        Apache Dubbo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/4.%E6%9C%8D%E5%8A%A1%E6%8B%86%E5%88%86/" class="md-nav__link">
        服务拆分
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/5.%E4%BA%8C%E6%89%8B%E6%88%BF%E7%AE%A1%E7%90%86/" class="md-nav__link">
        二手房管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/6.%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/" class="md-nav__link">
        图片上传
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/7.%E5%89%8D%E7%AB%AF%E6%88%BF%E6%BA%90%E5%B1%95%E7%A4%BA/" class="md-nav__link">
        前端房源展示
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/8.%E5%89%8D%E7%AB%AF%E7%99%BB%E5%BD%95%E4%B8%8E%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%85%B3%E6%B3%A8/" class="md-nav__link">
        前端登录与注册与关注
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/9.%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" class="md-nav__link">
        权限管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/10.spring%20security/" class="md-nav__link">
        spring security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E9%82%BB%E7%BD%91/11.session%E5%85%B1%E4%BA%AB/" class="md-nav__link">
        session共享
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_3" type="checkbox" id="__nav_1_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_3">
          谷粒商城
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="谷粒商城" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_3">
          <span class="md-nav__icon md-icon"></span>
          谷粒商城
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/1.%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%88nginx%E3%80%81cors%E3%80%81oss%EF%BC%89/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        谷粒商城01
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/2.%E5%88%86%E7%B1%BB%E3%80%81%E8%A7%84%E6%A0%BC%E3%80%81%E5%95%86%E5%93%81%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/%E8%A7%84%E6%A0%BC%E5%8F%82%E6%95%B0%E5%8F%8A%E5%95%86%E5%93%81%E6%96%B0%E5%A2%9E/" class="md-nav__link">
        谷粒商城02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/3.%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%8F%8Aseata/%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%8F%8Aseata/" class="md-nav__link">
        谷粒商城03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/4.elasticsearch%28DSL%E5%8F%8ASpringData-Elasticsearch%29/elasticsearch/" class="md-nav__link">
        谷粒商城04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/5.%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2/%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2/" class="md-nav__link">
        谷粒商城05
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/6.%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%EF%BC%88Thymeleaf%EF%BC%89%E5%8F%8A%E6%90%9C%E7%B4%A2%E9%A1%B5%E6%B8%B2%E6%9F%93/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-Thymeleaf/" class="md-nav__link">
        谷粒商城06
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/7.%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%EF%BC%88RabbitMQ%EF%BC%89/%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/" class="md-nav__link">
        谷粒商城07
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/8.%E5%95%86%E5%93%81%E5%88%86%E7%B1%BB%28%E7%BC%93%E5%AD%98%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E3%80%81Redisson%E3%80%81%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8%29/%E9%A6%96%E9%A1%B5%E5%95%86%E5%93%81%E5%88%86%E7%B1%BB/" class="md-nav__link">
        谷粒商城08
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/9.%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5%E5%8F%8A%E5%BC%82%E6%AD%A5%E7%BC%96%E6%8E%92%EF%BC%88CompletableFuture%EF%BC%89/%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5/" class="md-nav__link">
        谷粒商城09
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/10.%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%88jwt%EF%BC%89/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%88jwt%EF%BC%89/" class="md-nav__link">
        谷粒商城10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/11.%E8%B4%AD%E7%89%A9%E8%BD%A6%EF%BC%88SpringTask%EF%BC%89/%E8%B4%AD%E7%89%A9%E8%BD%A6/" class="md-nav__link">
        谷粒商城11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/12.%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%88xxl-job%EF%BC%89/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%88xxl-job%EF%BC%89/" class="md-nav__link">
        谷粒商城12
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/13.%E8%AE%A2%E5%8D%95%E3%80%81%E5%BA%93%E5%AD%98/%E8%AE%A2%E5%8D%95%E3%80%81%E5%BA%93%E5%AD%98/" class="md-nav__link">
        谷粒商城13
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E7%94%B5%E5%95%86/14.%E6%94%AF%E4%BB%98%E3%80%81%E7%A7%92%E6%9D%80/%E6%94%AF%E4%BB%98%E3%80%81%E7%A7%92%E6%9D%80/" class="md-nav__link">
        谷粒商城14
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_4" type="checkbox" id="__nav_1_7_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_4">
          尚融宝
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="尚融宝" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_4">
          <span class="md-nav__icon md-icon"></span>
          尚融宝
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part01-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D/Part01-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        项目介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part02-MyBatis-Plus/Part02-MyBatis-Plus/" class="md-nav__link">
        MyBatis-Plus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part03-%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E5%B7%A5%E7%A8%8B%E6%90%AD%E5%BB%BA/Part03-%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E5%B7%A5%E7%A8%8B%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        后端接口工程搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part04-%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/Part04-%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/" class="md-nav__link">
        前端知识
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part05-%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/Part05-%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        管理平台前端搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part06-Alibaba%20EasyExcel/Part06-Alibaba%20EasyExcel/" class="md-nav__link">
        Alibaba EasyExcel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part07-%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/Part07-%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/" class="md-nav__link">
        数据字典
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part08-Redis%E7%BC%93%E5%AD%98/Part08-Redis%E7%BC%93%E5%AD%98/" class="md-nav__link">
        Redis缓存
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part09-NuxtJS%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B8%B2%E6%9F%93/Part09-NuxtJS%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B8%B2%E6%9F%93/" class="md-nav__link">
        NuxtJS服务器端渲染
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part10-%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1/Part10-%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1/" class="md-nav__link">
        阿里云短信
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java课程/项目文档/尚融宝/Part11-分布式文件系统-阿里云OSS/分布式文件系统-阿里云OSS" class="md-nav__link">
        阿里云OSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part12-%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/Part12-%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/" class="md-nav__link">
        用户注册
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part13-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C/Part13-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C/" class="md-nav__link">
        访问令牌
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part14-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81/Part14-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81/" class="md-nav__link">
        用户认证
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part15-%E4%BC%9A%E5%91%98%E7%AE%A1%E7%90%86/Part15-%E4%BC%9A%E5%91%98%E7%AE%A1%E7%90%86/" class="md-nav__link">
        会员管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part16-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-OAuth2/Part16-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8-OAuth2/" class="md-nav__link">
        OAuth2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part17-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/Part17-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" class="md-nav__link">
        内网穿透
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part18-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/Part18-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/" class="md-nav__link">
        微信登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part19-%20SpringCloud/Part19-%20SpringCloud/" class="md-nav__link">
        SpringCloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part20-%E8%B4%A6%E6%88%B7%E7%BB%91%E5%AE%9A/Part20-%E8%B4%A6%E6%88%B7%E7%BB%91%E5%AE%9A/" class="md-nav__link">
        账户绑定
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part21-%E7%94%B3%E8%AF%B7%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6/Part21-%E7%94%B3%E8%AF%B7%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6/" class="md-nav__link">
        申请借款额度
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part22-%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6%E5%AE%A1%E6%A0%B8/Part22-%E5%80%9F%E6%AC%BE%E9%A2%9D%E5%BA%A6%E5%AE%A1%E6%A0%B8/" class="md-nav__link">
        借款额度审核
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part23-%E5%80%9F%E6%AC%BE%E7%94%B3%E8%AF%B7/Part23-%E5%80%9F%E6%AC%BE%E7%94%B3%E8%AF%B7/" class="md-nav__link">
        借款申请
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part24-%E5%80%9F%E6%AC%BE%E5%AE%A1%E6%A0%B8/Part24-%E5%80%9F%E6%AC%BE%E5%AE%A1%E6%A0%B8/" class="md-nav__link">
        借款审核
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part25-%E6%A0%87%E7%9A%84%E7%AE%A1%E7%90%86/Part25-%E6%A0%87%E7%9A%84%E7%AE%A1%E7%90%86/" class="md-nav__link">
        标的管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part26-%E6%88%91%E8%A6%81%E6%8A%95%E8%B5%84/Part26-%E6%88%91%E8%A6%81%E6%8A%95%E8%B5%84/" class="md-nav__link">
        我要投资
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part27-%E5%85%85%E5%80%BC/Part27-%E5%85%85%E5%80%BC/" class="md-nav__link">
        充值
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part28-%E6%8A%95%E6%A0%87/Part28-%E6%8A%95%E6%A0%87/" class="md-nav__link">
        投标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part29-%E6%94%BE%E6%AC%BE/Part29-%E6%94%BE%E6%AC%BE/" class="md-nav__link">
        放款
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part30-%E6%8A%95%E8%B5%84%E5%88%97%E8%A1%A8%E5%B1%95%E7%A4%BA/Part30-%E6%8A%95%E8%B5%84%E5%88%97%E8%A1%A8%E5%B1%95%E7%A4%BA/" class="md-nav__link">
        投资列表展示
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part31-%E6%8F%90%E7%8E%B0%E5%92%8C%E8%BF%98%E6%AC%BE/Part31-%E6%8F%90%E7%8E%B0%E5%92%8C%E8%BF%98%E6%AC%BE/" class="md-nav__link">
        提现和还款
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part32-%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83/Part32-%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83/" class="md-nav__link">
        个人中心
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part33-%E7%BD%91%E5%85%B3/Part33-%E7%BD%91%E5%85%B3/" class="md-nav__link">
        网关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part34-%E8%A1%A5%E5%85%85/Part34-%E8%A1%A5%E5%85%85/" class="md-nav__link">
        补充
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E8%9E%8D%E5%AE%9D/Part35-%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/Part35-%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/" class="md-nav__link">
        微信支付
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7_5" type="checkbox" id="__nav_1_7_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7_5">
          尚医通
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="尚医通" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_7_5">
          <span class="md-nav__icon md-icon"></span>
          尚医通
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day01%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E4%B8%8EMyBatis%20Plus/day01%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E4%B8%8E%20Mybatis%20Plus/" class="md-nav__link">
        项目介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day02%20%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%E5%92%8C%E5%8C%BB%E9%99%A2%E8%AE%BE%E7%BD%AE/day02%20%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%E5%92%8C%E5%8C%BB%E9%99%A2%E8%AE%BE%E7%BD%AE/" class="md-nav__link">
        搭建环境和医院设置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day03%20%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/day03%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/" class="md-nav__link">
        前端基础知识（一）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day04%20%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E4%BA%8C%EF%BC%89/day04%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="md-nav__link">
        前端基础知识（二）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day05%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/day05%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        平台管理前端搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day06%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/day06%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8/" class="md-nav__link">
        数据字典
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day07mongodb/day07mongodb/" class="md-nav__link">
        mongodb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day08%E5%8C%BB%E9%99%A2%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3/day08%E5%8C%BB%E9%99%A2%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3/" class="md-nav__link">
        医院上传接口
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day09%E5%8C%BB%E9%99%A2%E7%AE%A1%E7%90%86/day09%E5%8C%BB%E9%99%A2%E7%AE%A1%E7%90%86/" class="md-nav__link">
        医院管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day10%E6%8E%92%E7%8F%AD%E7%AE%A1%E7%90%86%E5%92%8C%E7%BD%91%E5%85%B3/day10%E6%8E%92%E7%8F%AD%E7%AE%A1%E7%90%86%E5%92%8C%E7%BD%91%E5%85%B3/" class="md-nav__link">
        排班管理和网关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day11%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%A6%96%E9%A1%B5/day11%E5%B9%B3%E5%8F%B0%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%A6%96%E9%A1%B5/" class="md-nav__link">
        平台前端搭建与首页
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day12%E6%89%8B%E6%9C%BA%E7%99%BB%E5%BD%95/day12%E6%89%8B%E6%9C%BA%E7%99%BB%E5%BD%95/" class="md-nav__link">
        手机登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day13%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/day13%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95/" class="md-nav__link">
        微信登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day14%E9%98%BF%E9%87%8C%E4%BA%91OSS%E3%80%81%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%B0%B1%E8%AF%8A%E4%BA%BA/day14%E9%98%BF%E9%87%8C%E4%BA%91OSS%E3%80%81%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%B0%B1%E8%AF%8A%E4%BA%BA/" class="md-nav__link">
        阿里云OSS、用户认证与就诊人
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day15%E9%A2%84%E7%BA%A6%E6%8C%82%E5%8F%B7/day15%E9%A2%84%E7%BA%A6%E6%8C%82%E5%8F%B7/" class="md-nav__link">
        预约挂号
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day16%E9%A2%84%E7%BA%A6%E4%B8%8B%E5%8D%95/day16%E9%A2%84%E7%BA%A6%E4%B8%8B%E5%8D%95/" class="md-nav__link">
        预约下单
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day17%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/day17%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/" class="md-nav__link">
        微信支付
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/%E5%B0%9A%E5%8C%BB%E9%80%9A/day18%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E4%B8%8E%E7%BB%9F%E8%AE%A1/day18%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E4%B8%8E%E7%BB%9F%E8%AE%A1/" class="md-nav__link">
        定时任务与统计
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Java就业面试
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java就业面试" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Java就业面试
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC1%E7%AB%A0%20%E9%9D%A2%E8%AF%95%E8%AF%B4%E6%98%8E/" class="md-nav__link">
        第1章 面试说明
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC2%E7%AB%A0%20%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81/" class="md-nav__link">
        第2章 手写代码
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC3%E7%AB%A0%20JavaSE/" class="md-nav__link">
        第3章 JavaSE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC4%E7%AB%A0%20JVM/" class="md-nav__link">
        第4章 JVM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC5%E7%AB%A0%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="md-nav__link">
        第5章 设计模式
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC6%E7%AB%A0%20MySql/" class="md-nav__link">
        第6章 MySql
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC7%E7%AB%A0%20Java%20Web/" class="md-nav__link">
        第7章 Java Web
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC8%E7%AB%A0%20SSM%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        第8章 SSM框架
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC9%E7%AB%A0%20SpringBoot/" class="md-nav__link">
        第9章 SpringBoot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC10%E7%AB%A0%20SpringCloud/" class="md-nav__link">
        第10章 SpringCloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC11%E7%AB%A0%20Redis/" class="md-nav__link">
        第11章 Redis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC12%E7%AB%A0%20MQ/" class="md-nav__link">
        第12章 MQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC13%E7%AB%A0%20ElasticSearch/" class="md-nav__link">
        第13章 ElasticSearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC14%E7%AB%A0%20Dubbo/" class="md-nav__link">
        第14章 Dubbo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC15%E7%AB%A0%20Zookeeper/" class="md-nav__link">
        第15章 Zookeeper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC16%E7%AB%A0%20Git/" class="md-nav__link">
        第16章 Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../java%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%AC%AC17%E7%AB%A0%20Linux/" class="md-nav__link">
        第17章 Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        学习文档
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    课程计划
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 微服务理论
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 分布式概念
  </a>
  
    <nav class="md-nav" aria-label="2. 分布式概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 什么是分布式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    2.2 分布式与集群的关系
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    2.3 软件架构演变
  </a>
  
    <nav class="md-nav" aria-label="2.3 软件架构演变">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    2.3.1 单一应用架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    2.3.2 垂直应用架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233" class="md-nav__link">
    2.3.3 分布式服务架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234" class="md-nav__link">
    2.3.4 流动计算架构
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-rpc" class="md-nav__link">
    2.4 RPC是什么
  </a>
  
    <nav class="md-nav" aria-label="2.4 RPC是什么">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" class="md-nav__link">
    2.4.1 解决分布式系统的各个服务之间互相交互问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242-rpc" class="md-nav__link">
    2.4.2 RPC思想原理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" class="md-nav__link">
    2.4.3 服务之间的交互可以用两种方式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    2.5 分布式思想与基本概念
  </a>
  
    <nav class="md-nav" aria-label="2.5 分布式思想与基本概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251" class="md-nav__link">
    2.5.1 高并发
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#252" class="md-nav__link">
    2.5.2 高可用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#253" class="md-nav__link">
    2.5.3 注册中心
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#254" class="md-nav__link">
    2.5.4 负载均衡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#255" class="md-nav__link">
    2.5.5 服务雪崩
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#256" class="md-nav__link">
    2.5.6 熔断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#257" class="md-nav__link">
    2.5.7 限流
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#258-api" class="md-nav__link">
    2.5.8 API网关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#259" class="md-nav__link">
    2.5.9 服务跟踪
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2510" class="md-nav__link">
    2.5.10 弹性云
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-springcloud" class="md-nav__link">
    3. SpringCloud背景
  </a>
  
    <nav class="md-nav" aria-label="3. SpringCloud背景">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    3.1 背景介绍
  </a>
  
    <nav class="md-nav" aria-label="3.1 背景介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311" class="md-nav__link">
    3.1.1 微服务架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#312-springboot" class="md-nav__link">
    3.1.2 微服务框架之SpringBoot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#313-springcloud" class="md-nav__link">
    3.1.3. 分布式系统微服务架构之SpringCloud
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#314" class="md-nav__link">
    3.1.4 组件概述
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-springbootspringcloud" class="md-nav__link">
    3.2 关于SpringBoot和SpringCloud版本
  </a>
  
    <nav class="md-nav" aria-label="3.2 关于SpringBoot和SpringCloud版本">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-springcloud" class="md-nav__link">
    3.2.1 SpringCloud版本选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-springboot" class="md-nav__link">
    3.2.2.    Springboot版本选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-boot" class="md-nav__link">
    3.2.3 官网看Boot版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#324-springcloud" class="md-nav__link">
    3.2.4 SpringCloud版本选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#325-springcloudspringboot" class="md-nav__link">
    3.2.5 SpringCloud和Springboot之间的依赖关系
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#326-springcloud" class="md-nav__link">
    3.2.6.    SpringCloud（授课选择版本）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-ideaproject" class="md-nav__link">
    3.3 微服务架构编码构建-IDEA新建project工作空间
  </a>
  
    <nav class="md-nav" aria-label="3.3 微服务架构编码构建-IDEA新建project工作空间">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-cloudproject" class="md-nav__link">
    3.3.1 微服务cloud整体聚合父工程Project
  </a>
  
    <nav class="md-nav" aria-label="3.3.1 微服务cloud整体聚合父工程Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-new-project" class="md-nav__link">
    1.   New Project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2.   聚合总工程名字
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-maven" class="md-nav__link">
    3.   Maven选版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4.   工程名字
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5.   字符编码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6.   注解生效激活
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-java" class="md-nav__link">
    7.   java编译版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-file-type" class="md-nav__link">
    8.   File Type过滤【可选】
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#332-pom" class="md-nav__link">
    3.3.2 父工程POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#333-maven" class="md-nav__link">
    3.3.3 Maven工程落地细节复习
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#334-mvninstall" class="md-nav__link">
    3.3.4 父工程创建完成执行mvn:install
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-rest-" class="md-nav__link">
    3.4 微服务架构编码构建-Rest微服务-【服务提供者】
  </a>
  
    <nav class="md-nav" aria-label="3.4 微服务架构编码构建-Rest微服务-【服务提供者】">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#341-cloud-provider-payment8001" class="md-nav__link">
    3.4.1 建cloud-provider-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#342-pom" class="md-nav__link">
    3.4.2 改POM文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#343-yml" class="md-nav__link">
    3.4.3 写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#344" class="md-nav__link">
    3.4.4 主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#345" class="md-nav__link">
    3.4.5 业务类
  </a>
  
    <nav class="md-nav" aria-label="3.4.5 业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-sql" class="md-nav__link">
    1.   建表SQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-entitles" class="md-nav__link">
    2.   Entitles
  </a>
  
    <nav class="md-nav" aria-label="2.   Entitles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-payment" class="md-nav__link">
    1)  主实体Payment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-jsoncommonresult" class="md-nav__link">
    2)  Json封装体CommonResult
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-lombok" class="md-nav__link">
    3)  安装lombok插件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-dao" class="md-nav__link">
    3.   Dao
  </a>
  
    <nav class="md-nav" aria-label="3.   Dao">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-paymentdao" class="md-nav__link">
    1)  接口PaymentDao
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-mybatis" class="md-nav__link">
    2)  mybatis的映射文件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-service" class="md-nav__link">
    4.   Service
  </a>
  
    <nav class="md-nav" aria-label="4.   Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-paymentservice" class="md-nav__link">
    1)  接口PaymentService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-paymentserviceimpl" class="md-nav__link">
    2)  实现类PaymentServiceImpl
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-controller" class="md-nav__link">
    5.   Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#346" class="md-nav__link">
    3.4.6.    测试
  </a>
  
    <nav class="md-nav" aria-label="3.4.6.    测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-postmanget" class="md-nav__link">
    1.   postman测试get请求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-postmanpost" class="md-nav__link">
    2.   postman测试post请求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.   快速运行设置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#347-" class="md-nav__link">
    3.4.7 开发步骤-小总结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#348-devtools" class="md-nav__link">
    3.4.8 热部署Devtools
  </a>
  
    <nav class="md-nav" aria-label="3.4.8 热部署Devtools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-adding-devtools-to-your-project" class="md-nav__link">
    1.   Adding devtools to your project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-adding-plugin-to-your-pomxml" class="md-nav__link">
    2.   Adding plugin to your pom.xml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-enabling-automatic-build" class="md-nav__link">
    3.   Enabling automatic build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-update-the-value-of" class="md-nav__link">
    4.   Update the value of
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-idea" class="md-nav__link">
    5.   重启IDEA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-rest-" class="md-nav__link">
    3.5 微服务架构编码构建-Rest微服务-【服务消费者】
  </a>
  
    <nav class="md-nav" aria-label="3.5 微服务架构编码构建-Rest微服务-【服务消费者】">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351-cloud-consumer-order80" class="md-nav__link">
    3.5.1 建cloud-consumer-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352-pom" class="md-nav__link">
    3.5.2 改POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353-yml" class="md-nav__link">
    3.5.3 写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#354" class="md-nav__link">
    3.5.4 主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#355" class="md-nav__link">
    3.5.5 业务类
  </a>
  
    <nav class="md-nav" aria-label="3.5.5 业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-entities" class="md-nav__link">
    1.   创建entities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-resttemplate" class="md-nav__link">
    2.   RestTemplate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-config" class="md-nav__link">
    3.   config配置类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-controller" class="md-nav__link">
    4.   创建controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#356" class="md-nav__link">
    3.5.6 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36" class="md-nav__link">
    3.6 工程重构
  </a>
  
    <nav class="md-nav" aria-label="3.6 工程重构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#361" class="md-nav__link">
    3.6.1 观察问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#362-cloud-api-commons" class="md-nav__link">
    3.6.2 新建：cloud-api-commons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#363-pom" class="md-nav__link">
    3.6.3 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#364-entities" class="md-nav__link">
    3.6.4 entities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#365-mavenclean-install" class="md-nav__link">
    3.6.5 maven命令clean install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#366-808001" class="md-nav__link">
    3.6.6 订单80和支付8001分别改造
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37" class="md-nav__link">
    3.7 目前工程样图
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-eureka" class="md-nav__link">
    4. Eureka服务注册与发现
  </a>
  
    <nav class="md-nav" aria-label="4. Eureka服务注册与发现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-eureka" class="md-nav__link">
    4.1 Eureka基础知识
  </a>
  
    <nav class="md-nav" aria-label="4.1 Eureka基础知识">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411" class="md-nav__link">
    4.1.1 什么是服务治理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412" class="md-nav__link">
    4.1.2 什么是服务注册
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-eureka" class="md-nav__link">
    4.1.3 Eureka两组件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-eureka" class="md-nav__link">
    4.2 单机Eureka构建步骤
  </a>
  
    <nav class="md-nav" aria-label="4.2 单机Eureka构建步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-ideaeurekaserver" class="md-nav__link">
    4.2.1 IDEA生成eurekaServer端服务注册中心
  </a>
  
    <nav class="md-nav" aria-label="4.2.1 IDEA生成eurekaServer端服务注册中心">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-eureka-server7001" class="md-nav__link">
    1.   建Module：cloud-eureka-server7001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom" class="md-nav__link">
    2.   改POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml" class="md-nav__link">
    3.   写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    5.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422" class="md-nav__link">
    4.2.2 服务提供者
  </a>
  
    <nav class="md-nav" aria-label="4.2.2 服务提供者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-provider-payment8001" class="md-nav__link">
    1.   建Module：cloud-provider-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_1" class="md-nav__link">
    2.   改POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_1" class="md-nav__link">
    3.   写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_2" class="md-nav__link">
    5.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423" class="md-nav__link">
    4.2.3 服务消费者
  </a>
  
    <nav class="md-nav" aria-label="4.2.3 服务消费者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-consumer-order80" class="md-nav__link">
    1.   建Module：cloud-consumer-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_2" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_2" class="md-nav__link">
    3.   写YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_3" class="md-nav__link">
    5.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-ribbon" class="md-nav__link">
    5. Ribbon负载均衡服务调用
  </a>
  
    <nav class="md-nav" aria-label="5. Ribbon负载均衡服务调用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    5.1 概述
  </a>
  
    <nav class="md-nav" aria-label="5.1 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511" class="md-nav__link">
    5.1.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512" class="md-nav__link">
    5.1.2 官网资料
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513" class="md-nav__link">
    5.1.3 能干嘛
  </a>
  
    <nav class="md-nav" aria-label="5.1.3 能干嘛">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-lb" class="md-nav__link">
    1.   LB（负载均衡）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    2.   一句话
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-ribbon" class="md-nav__link">
    5.2 Ribbon负载均衡演示
  </a>
  
    <nav class="md-nav" aria-label="5.2 Ribbon负载均衡演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521" class="md-nav__link">
    5.2.1 架构说明
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-pom" class="md-nav__link">
    5.2.2 POM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-ribbonirule" class="md-nav__link">
    5.3 Ribbon核心组件Irule
  </a>
  
    <nav class="md-nav" aria-label="5.3 Ribbon核心组件Irule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-irule" class="md-nav__link">
    5.3.1 IRule：根据特定算法从服务列表中选取一个要访问的服务
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532" class="md-nav__link">
    5.3.2 如何替换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-package" class="md-nav__link">
    5.3.3 新建package（注意：包的位置）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-myselfrule" class="md-nav__link">
    5.3.4 上面包下新建MySelfRule规则类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#535-ribbonclient" class="md-nav__link">
    5.3.5 主启动类添加@RibbonClient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#536" class="md-nav__link">
    5.3.6 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-ribbon" class="md-nav__link">
    5.4 Ribbon负载均衡算法
  </a>
  
    <nav class="md-nav" aria-label="5.4 Ribbon负载均衡算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541" class="md-nav__link">
    5.4.1 原理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-openfeign" class="md-nav__link">
    6. OpenFeign服务接口调用
  </a>
  
    <nav class="md-nav" aria-label="6. OpenFeign服务接口调用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1. 概述
  </a>
  
    <nav class="md-nav" aria-label="6.1. 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-openfeign" class="md-nav__link">
    6.1.1 OpenFeign是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#612" class="md-nav__link">
    6.1.2 能干嘛
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-openfeign" class="md-nav__link">
    6.2 OpenFeign使用步骤
  </a>
  
    <nav class="md-nav" aria-label="6.2 OpenFeign使用步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621" class="md-nav__link">
    6.2.1 接口+注解
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-modulecloud-consumer-feign-order80" class="md-nav__link">
    6.2.2 新建Module：cloud-consumer-feign-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-pom" class="md-nav__link">
    6.2.3 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#624-yml" class="md-nav__link">
    6.2.4 YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#625" class="md-nav__link">
    6.2.5 主启动类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#626" class="md-nav__link">
    6.2.6 业务类
  </a>
  
    <nav class="md-nav" aria-label="6.2.6 业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-feignclientprovider" class="md-nav__link">
    1.   业务逻辑接口+@FeignClient配置调用provider服务
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-paymentfeignservicefeignclient" class="md-nav__link">
    2.   新建PaymentFeignService接口并新增注解@FeignClient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-controller" class="md-nav__link">
    3.   控制层Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#627" class="md-nav__link">
    6.2.7 测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#628" class="md-nav__link">
    6.2.8 小总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-openfeign" class="md-nav__link">
    6.3 OpenFeign超时控制
  </a>
  
    <nav class="md-nav" aria-label="6.3 OpenFeign超时控制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#631" class="md-nav__link">
    6.3.1 超时设置，故意设置超时演示出错情况
  </a>
  
    <nav class="md-nav" aria-label="6.3.1 超时设置，故意设置超时演示出错情况">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-8001" class="md-nav__link">
    1.   服务提供方8001故意写暂停程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-80paymentfeignservice" class="md-nav__link">
    2.   服务消费方80添加超时方法PaymentFeignService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-80orderfeigncontroller" class="md-nav__link">
    3.   服务消费方80添加超时方法OrderFeignController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_4" class="md-nav__link">
    4.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#632" class="md-nav__link">
    6.3.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#633-ymlopenfeign" class="md-nav__link">
    6.3.3 YML中需要开启OpenFeign客户端超时控制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-openfeign" class="md-nav__link">
    6.4 OpenFeign日志打印功能
  </a>
  
    <nav class="md-nav" aria-label="6.4 OpenFeign日志打印功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#641" class="md-nav__link">
    6.4.1 日志打印功能
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#642" class="md-nav__link">
    6.4.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#643" class="md-nav__link">
    6.4.3 日志级别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#644-bean" class="md-nav__link">
    6.4.4 配置日志bean
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#645-ymlfeign" class="md-nav__link">
    6.4.5 YML文件里需要开启日志的Feign客户端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#646" class="md-nav__link">
    6.4.6 后台日志查看
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-hystrix" class="md-nav__link">
    7. Hystrix断路器
  </a>
  
    <nav class="md-nav" aria-label="7. Hystrix断路器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    7.1 概述
  </a>
  
    <nav class="md-nav" aria-label="7.1 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#711" class="md-nav__link">
    7.1.1 分布式系统面临的问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#712" class="md-nav__link">
    7.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#713" class="md-nav__link">
    7.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#714" class="md-nav__link">
    7.1.4 官网资料
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#715-hystrix" class="md-nav__link">
    7.1.5 Hystrix官宣，停更进维
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-hystrix" class="md-nav__link">
    7.2 Hystrix重要概念
  </a>
  
    <nav class="md-nav" aria-label="7.2 Hystrix重要概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#721-fallback" class="md-nav__link">
    7.2.1 服务降级Fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#722-breaker" class="md-nav__link">
    7.2.2 服务熔断Breaker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#723-flowlimit" class="md-nav__link">
    7.2.3 服务限流Flowlimit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-hystrix" class="md-nav__link">
    7.3 hystrix案例
  </a>
  
    <nav class="md-nav" aria-label="7.3 hystrix案例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#731" class="md-nav__link">
    7.3.1 构建
  </a>
  
    <nav class="md-nav" aria-label="7.3.1 构建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-provider-hystrix-payment8001" class="md-nav__link">
    1.   新建Module：cloud-provider-hystrix-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_3" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_3" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_5" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_4" class="md-nav__link">
    5.   业务类
  </a>
  
    <nav class="md-nav" aria-label="5.   业务类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serviceserviceimpl" class="md-nav__link">
    Service/ServiceImpl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller" class="md-nav__link">
    Controller
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_1" class="md-nav__link">
    6.   正常测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#732" class="md-nav__link">
    7.3.2 高并发测试
  </a>
  
    <nav class="md-nav" aria-label="7.3.2 高并发测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-but" class="md-nav__link">
    1. 上述在非高并发情形下，还能勉强满足  but.....
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-jmeter" class="md-nav__link">
    2. Jmeter压测测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-jmeter" class="md-nav__link">
    3.   Jmeter压测结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-80cloud-consumer-feign-hystrix-order80" class="md-nav__link">
    4.   看热闹不嫌弃事大，80新建加入：cloud-consumer-feign-hystrix-order80
  </a>
  
    <nav class="md-nav" aria-label="4.   看热闹不嫌弃事大，80新建加入：cloud-consumer-feign-hystrix-order80">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-consumer-feign-hystrix-order80" class="md-nav__link">
    1)  新建：cloud-consumer-feign-hystrix-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_4" class="md-nav__link">
    2)  POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_4" class="md-nav__link">
    3)  YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_6" class="md-nav__link">
    4)  主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_5" class="md-nav__link">
    5)  业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_2" class="md-nav__link">
    6)  正常测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7)  高并发测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#733" class="md-nav__link">
    7.3.3 故障现象和导致原因
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#734" class="md-nav__link">
    7.3.4 上诉结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#735" class="md-nav__link">
    7.3.5 如何解决？解决的要求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#736" class="md-nav__link">
    7.3.6 服务降级
  </a>
  
    <nav class="md-nav" aria-label="7.3.6 服务降级">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1. 降低配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-8001" class="md-nav__link">
    2.   8001先从自身找问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-8001fallback" class="md-nav__link">
    3.   8001fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-80fallback" class="md-nav__link">
    4.   80fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_6" class="md-nav__link">
    5.   目前问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_3" class="md-nav__link">
    6.   解决问题
  </a>
  
    <nav class="md-nav" aria-label="6.   解决问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    1)  每个方法配置一个？？？膨胀
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    2)  和业务逻辑混一起？？？混乱
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    3)  测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#737" class="md-nav__link">
    7.3.7 服务熔断
  </a>
  
    <nav class="md-nav" aria-label="7.3.7 服务熔断">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    1.   断路器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    2.   熔断是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    3.   大神论文：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_7" class="md-nav__link">
    4.   实操
  </a>
  
    <nav class="md-nav" aria-label="4.   实操">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-provider-hystrix-payment8001" class="md-nav__link">
    1)  修改cloud-provider-hystrix-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-paymentserviceimpl_1" class="md-nav__link">
    2)  PaymentServiceImpl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-paymentcontroller" class="md-nav__link">
    3)  PaymentController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_8" class="md-nav__link">
    4)  测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_7" class="md-nav__link">
    5.   原理（小总结）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    1)  大神结论
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    2)  熔断类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    3)  官网断路器流程图
  </a>
  
    <nav class="md-nav" aria-label="3)  官网断路器流程图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    ①  官网步骤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    ②  断路器在什么情况下开始起作用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    ③断路器开启或者关闭的条件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_9" class="md-nav__link">
    ④  断路器打开之后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-all" class="md-nav__link">
    ⑤  All配置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#738" class="md-nav__link">
    7.3.8 服务限流
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-hystrixdashboard" class="md-nav__link">
    7.4 服务监控hystrixDashboard
  </a>
  
    <nav class="md-nav" aria-label="7.4 服务监控hystrixDashboard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#741" class="md-nav__link">
    7.4.1 概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#742-9001" class="md-nav__link">
    7.4.2 仪表盘9001
  </a>
  
    <nav class="md-nav" aria-label="7.4.2 仪表盘9001">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloud-consumer-hystrix-dashboard9001" class="md-nav__link">
    1. 新建Module：cloud-consumer-hystrix-dashboard9001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_5" class="md-nav__link">
    2. POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_5" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-hystrixdashboardmain9001enablehystrixdashboard" class="md-nav__link">
    4.   HystrixDashboardMain9001+新注解@EnableHystrixDashboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-provider800180028003" class="md-nav__link">
    5.   所有Provider微服务提供类（8001/8002/8003）都需要监控依赖配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-cloud-consumer-hystrix-dashboard90018001" class="md-nav__link">
    6.   启动cloud-consumer-hystrix-dashboard9001该微服务后续将监控微服务8001
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#743" class="md-nav__link">
    7.4.3 断路器演示
  </a>
  
    <nav class="md-nav" aria-label="7.4.3 断路器演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-provider-hystrix-payment8001_1" class="md-nav__link">
    1.   修改cloud-provider-hystrix-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    2.   监控测试
  </a>
  
    <nav class="md-nav" aria-label="2.   监控测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-1eureka" class="md-nav__link">
    1)  启动1个eureka
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    2)  观察监控窗口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-gateway" class="md-nav__link">
    8. Gateway新一代网关
  </a>
  
    <nav class="md-nav" aria-label="8. Gateway新一代网关">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" class="md-nav__link">
    8.1 概述简介
  </a>
  
    <nav class="md-nav" aria-label="8.1 概述简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#811" class="md-nav__link">
    8.1.1 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#812" class="md-nav__link">
    8.1.2 是什么
  </a>
  
    <nav class="md-nav" aria-label="8.1.2 是什么">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8121-getewayzuul1x" class="md-nav__link">
    8.1.2.1 一句话：Geteway是原Zuul1.x版的替代
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8122" class="md-nav__link">
    8.1.2.2 概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8123" class="md-nav__link">
    8.1.2.3 一句话
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#813" class="md-nav__link">
    8.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#814" class="md-nav__link">
    8.1.4 微服务架构中网关在哪里
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    8.2 三大核心概念
  </a>
  
    <nav class="md-nav" aria-label="8.2 三大核心概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#821-route" class="md-nav__link">
    8.2.1 Route(路由)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#822-predicate" class="md-nav__link">
    8.2.2 Predicate（断言）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#823-filter" class="md-nav__link">
    8.2.3 Filter(过滤)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224" class="md-nav__link">
    2.2.4.    总体
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-gateway" class="md-nav__link">
    2.3. Gateway工作流程
  </a>
  
    <nav class="md-nav" aria-label="2.3. Gateway工作流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231_1" class="md-nav__link">
    2.3.1.    官网总结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#832" class="md-nav__link">
    8.3.2 核心逻辑：路由转发+执行过滤器链
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84" class="md-nav__link">
    8.4 入门配置
  </a>
  
    <nav class="md-nav" aria-label="8.4 入门配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#841-modulecloud-gateway-gateway9527" class="md-nav__link">
    8.4.1 新建Module：cloud-gateway-gateway9527
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#842-pom" class="md-nav__link">
    8.4.2 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#843-yml" class="md-nav__link">
    8.4.3 YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#844" class="md-nav__link">
    8.4.4 业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#845" class="md-nav__link">
    8.4.5 主启动类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#846-9527" class="md-nav__link">
    8.4.6 9527网关如何做路由映射呢？？？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#847-yml" class="md-nav__link">
    8.4.7 YML新增网关配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#848" class="md-nav__link">
    8.4.8 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85" class="md-nav__link">
    8.5 通过微服务名实现动态路由
  </a>
  
    <nav class="md-nav" aria-label="8.5 通过微服务名实现动态路由">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#851" class="md-nav__link">
    8.5.1 启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#852-pom" class="md-nav__link">
    8.5.2 POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#853-yml" class="md-nav__link">
    8.5.3 YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#854" class="md-nav__link">
    8.5.4 测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86-predicate" class="md-nav__link">
    8.6 Predicate的使用
  </a>
  
    <nav class="md-nav" aria-label="8.6 Predicate的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#861" class="md-nav__link">
    8.6.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#862-route-predicate-factories" class="md-nav__link">
    8.6.2 Route Predicate Factories这个是什么东东？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#863-route-predicate" class="md-nav__link">
    8.6.3 常用的Route Predicate
  </a>
  
    <nav class="md-nav" aria-label="8.6.3 常用的Route Predicate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1after-route-predicate" class="md-nav__link">
    1.After Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2before-route-predicate" class="md-nav__link">
    2.Before Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3between-route-predicate" class="md-nav__link">
    3.Between Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4cookie-route-predicate" class="md-nav__link">
    4.Cookie Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5header-route-predicate" class="md-nav__link">
    5.Header Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6host-route-predicate" class="md-nav__link">
    6.Host Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7method-route-predicate" class="md-nav__link">
    7.Method Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8path-route-predicate" class="md-nav__link">
    8.Path Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-query-route-predicate" class="md-nav__link">
    9. Query Route Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10.小总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#87-filter" class="md-nav__link">
    8.7 Filter的使用
  </a>
  
    <nav class="md-nav" aria-label="8.7 Filter的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#871" class="md-nav__link">
    8.7.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#872-spring-cloud-gatewayfilter" class="md-nav__link">
    8.7.2 Spring Cloud Gateway的Filter
  </a>
  
    <nav class="md-nav" aria-label="8.7.2 Spring Cloud Gateway的Filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-only-two" class="md-nav__link">
    1.   生命周期，Only Two
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-only-two" class="md-nav__link">
    2.   种类，Only Two
  </a>
  
    <nav class="md-nav" aria-label="2.   种类，Only Two">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-gatewayfilter31" class="md-nav__link">
    1)  GatewayFilter（31种之多）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-globalfilter" class="md-nav__link">
    2)  GlobalFilter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#873-gatewayfilter" class="md-nav__link">
    8.7.3 常用的GatewayFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#874" class="md-nav__link">
    8.7.4 自定义过滤器
  </a>
  
    <nav class="md-nav" aria-label="8.7.4 自定义过滤器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-globalfilter" class="md-nav__link">
    1.   自定义全局GlobalFilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    2.   能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    3.   案例代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_10" class="md-nav__link">
    4.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-springcloud-sleuth" class="md-nav__link">
    9. SpringCloud Sleuth分布式链路请求跟踪
  </a>
  
    <nav class="md-nav" aria-label="9. SpringCloud Sleuth分布式链路请求跟踪">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 概述
  </a>
  
    <nav class="md-nav" aria-label="9.1 概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#911" class="md-nav__link">
    9.1.1 为什么会出现这个技术？需要解决哪些问题？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#912" class="md-nav__link">
    9.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#913" class="md-nav__link">
    9.1.3 解决
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 搭建链路监控步骤
  </a>
  
    <nav class="md-nav" aria-label="9.2 搭建链路监控步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#921-zipkin" class="md-nav__link">
    9.2.1 zipkin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#922" class="md-nav__link">
    9.2.2 服务提供者
  </a>
  
    <nav class="md-nav" aria-label="9.2.2 服务提供者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-provider-payment8001" class="md-nav__link">
    1.   修改：cloud-provider-payment8001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_6" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_6" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-paymentcontroller" class="md-nav__link">
    4.   业务类PaymentController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#923" class="md-nav__link">
    9.2.3 服务消费者（调用方）
  </a>
  
    <nav class="md-nav" aria-label="9.2.3 服务消费者（调用方）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloud-consumer-order80" class="md-nav__link">
    1.   修改：cloud-consumer-order80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_7" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_7" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-paymentcontroller_1" class="md-nav__link">
    4.   业务类PaymentController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#924-eureka7001800180" class="md-nav__link">
    9.2.4 依次启动eureka7001/8001/80
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#925-httplocalhost9411" class="md-nav__link">
    9.2.5 打开浏览器访问： http://localhost:9411
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-springcloud-alibaba" class="md-nav__link">
    10. SpringCloud Alibaba入门简介
  </a>
  
    <nav class="md-nav" aria-label="10. SpringCloud Alibaba入门简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-whyspringcloud-alibaba" class="md-nav__link">
    10.1 why会出现SpringCloud alibaba
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-springcloud-alibaba" class="md-nav__link">
    10.2 SpringCloud alibaba带来了什么？
  </a>
  
    <nav class="md-nav" aria-label="10.2 SpringCloud alibaba带来了什么？">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1021" class="md-nav__link">
    10.2.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1022" class="md-nav__link">
    10.2.2 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1023" class="md-nav__link">
    10.2.3 去哪下
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1024" class="md-nav__link">
    10.2.4 怎么玩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-springcloud-alibaba" class="md-nav__link">
    10.3 SpringCloud alibaba学习资料获取
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-springcloud-alibaba-nacos" class="md-nav__link">
    11. SpringCloud Alibaba Nacos服务注册和配置中心
  </a>
  
    <nav class="md-nav" aria-label="11. SpringCloud Alibaba Nacos服务注册和配置中心">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-nacos" class="md-nav__link">
    11.1 Nacos简介
  </a>
  
    <nav class="md-nav" aria-label="11.1 Nacos简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1111-nacos" class="md-nav__link">
    11.1.1 为什么叫Nacos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1112" class="md-nav__link">
    11.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1113" class="md-nav__link">
    11.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#314_1" class="md-nav__link">
    3.1.4.    去哪下
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1115" class="md-nav__link">
    11.1.5 各种注册中心比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112-nacos" class="md-nav__link">
    11.2 安装并运行Nacos
  </a>
  
    <nav class="md-nav" aria-label="11.2 安装并运行Nacos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1121-java8mavenok" class="md-nav__link">
    11.2.1 本地Java8+Maven环境已经OK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1122-nacos" class="md-nav__link">
    11.2.2 先从官网下载Nacos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1123-binstartupcmd" class="md-nav__link">
    11.2.3 解压安装包，直接运行bin/startup.cmd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1124" class="md-nav__link">
    11.2.4 命令运行成功后直接访问
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1125" class="md-nav__link">
    11.2.5 登录结果页面
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#113-nacos" class="md-nav__link">
    11.3 Nacos作为服务注册中心演示
  </a>
  
    <nav class="md-nav" aria-label="11.3 Nacos作为服务注册中心演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1131" class="md-nav__link">
    11.3.1 官网文档
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1132-nacos" class="md-nav__link">
    11.3.2 基于Nacos的服务提供者
  </a>
  
    <nav class="md-nav" aria-label="11.3.2 基于Nacos的服务提供者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-provider-payment9001" class="md-nav__link">
    1.   新建Module：cloudalibaba-provider-payment9001
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_8" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_8" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_11" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_8" class="md-nav__link">
    5.   业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_4" class="md-nav__link">
    6.   测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-nacos90019002" class="md-nav__link">
    7.   为了下一章节演示nacos的负载均衡，参照9001新建9002
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1133-nacos" class="md-nav__link">
    11.3.3 基于Nacos的服务消费者
  </a>
  
    <nav class="md-nav" aria-label="11.3.3 基于Nacos的服务消费者">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-consumer-nacos-order83" class="md-nav__link">
    1.   新建Module：cloudalibaba-consumer-nacos-order83
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_9" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_9" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_12" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_9" class="md-nav__link">
    5.   业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-ordernacoscontroller" class="md-nav__link">
    6.   OrderNacosController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_1" class="md-nav__link">
    7.   测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1134" class="md-nav__link">
    11.3.4 服务注册中心对比
  </a>
  
    <nav class="md-nav" aria-label="11.3.4 服务注册中心对比">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nacoscap" class="md-nav__link">
    1.   Nacos和CAP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nacosapcp" class="md-nav__link">
    2.   Nacos支持AP和CP模式的切换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#114-nacos" class="md-nav__link">
    11.4 Nacos作为服务配置中心演示
  </a>
  
    <nav class="md-nav" aria-label="11.4 Nacos作为服务配置中心演示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1141-nacos-" class="md-nav__link">
    11.4.1 Nacos作为配置中心-基础配置
  </a>
  
    <nav class="md-nav" aria-label="11.4.1 Nacos作为配置中心-基础配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-config-nacos-client3377" class="md-nav__link">
    1.   创建Module：cloudalibaba-config-nacos-client3377
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_10" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_10" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_13" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-configclientcontroller" class="md-nav__link">
    5.   业务类:ConfigClientController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-nacos" class="md-nav__link">
    6.   在Nacos中添加配置信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_2" class="md-nav__link">
    7.   测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8.   自带动态刷新
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1142-nacos-" class="md-nav__link">
    11.4.2 Nacos作为配置中心-分类配置
  </a>
  
    <nav class="md-nav" aria-label="11.4.2 Nacos作为配置中心-分类配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    1.   问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nacos" class="md-nav__link">
    2.   Nacos的图形化管理界面
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-namespacegroupdata-id" class="md-nav__link">
    3.   Namespace+Group+Data ID三者关系？为什么这么设计？
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-case" class="md-nav__link">
    4.   Case
  </a>
  
    <nav class="md-nav" aria-label="4.   Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dataid" class="md-nav__link">
    1)  DataID方案
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-group" class="md-nav__link">
    2)  Group方案
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-namespace" class="md-nav__link">
    3)  Namespace方案
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#115-nacos" class="md-nav__link">
    11.5 Nacos集群和持久化配置（重要）
  </a>
  
    <nav class="md-nav" aria-label="11.5 Nacos集群和持久化配置（重要）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1151" class="md-nav__link">
    11.5.1 官网说明
  </a>
  
    <nav class="md-nav" aria-label="11.5.1 官网说明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    1.   官网架构图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_10" class="md-nav__link">
    2.   上图官网翻译，真实情况
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    3.   说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1152-nacos" class="md-nav__link">
    11.5.2 Nacos持久化配置解释
  </a>
  
    <nav class="md-nav" aria-label="11.5.2 Nacos持久化配置解释">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nacosderby" class="md-nav__link">
    1.   Nacos默认自带的是嵌入式数据库derby
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-derbymysql" class="md-nav__link">
    2.   derby到mysql切换配置步骤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nacosderby" class="md-nav__link">
    3.   启动nacos，可以看到是个全新的空记录界面，以前是记录进derby
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-mysql" class="md-nav__link">
    4.   测试：新建配置，发现配置信息写入了MySQL数据库
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1153-linuxnacosmysql" class="md-nav__link">
    11.5.3 Linux版Nacos+MySQL生产环境配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-1nginx3nacos1mysql" class="md-nav__link">
    1.   预计需要，1个nginx+3个nacos注册中心+1个mysql
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nacoslinux" class="md-nav__link">
    2.   Nacos下载linux版本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_7" class="md-nav__link">
    3.   集群配置步骤（重点）
  </a>
  
    <nav class="md-nav" aria-label="3.   集群配置步骤（重点）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1linuxmysql" class="md-nav__link">
    1.Linux服务器上mysql数据库配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2applicationproperties" class="md-nav__link">
    2.application.properties配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3linuxnacosclusterconf" class="md-nav__link">
    3.Linux服务器上nacos的集群配置cluster.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4nacosstartupsh" class="md-nav__link">
    4.编辑Nacos的启动脚本startup.sh，使它能够接受不同的启动端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5nginx" class="md-nav__link">
    5.Nginx的配置，由它作为负载均衡器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#61nginx3nacos1mysql" class="md-nav__link">
    6.截止到此处，1个Nginx+3个nacos注册中心+1个mysql
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_14" class="md-nav__link">
    4.   测试
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_10" class="md-nav__link">
    5.   高可用小总结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-springcloud-alibaba-sentinel" class="md-nav__link">
    12. SpringCloud Alibaba Sentinel实现熔断与限流
  </a>
  
    <nav class="md-nav" aria-label="12. SpringCloud Alibaba Sentinel实现熔断与限流">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-sentinel" class="md-nav__link">
    12.1 Sentinel介绍
  </a>
  
    <nav class="md-nav" aria-label="12.1 Sentinel介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1211" class="md-nav__link">
    12.1.1 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1212" class="md-nav__link">
    12.1.2 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1213" class="md-nav__link">
    12.1.3 能干嘛
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1214" class="md-nav__link">
    12.1.4 去哪下
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1215" class="md-nav__link">
    12.1.5 怎么玩
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-sentinel" class="md-nav__link">
    12.2 安装Sentinel控制台
  </a>
  
    <nav class="md-nav" aria-label="12.2 安装Sentinel控制台">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1221-sentinel2" class="md-nav__link">
    12.2.1 sentinel组件由2部分组成
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1222" class="md-nav__link">
    12.2.2 安装步骤
  </a>
  
    <nav class="md-nav" aria-label="12.2.2 安装步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    1.   下载
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_11" class="md-nav__link">
    2.   运行命令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sentinel" class="md-nav__link">
    3.   访问sentinel管理界面
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    12.3 初始化演示工程
  </a>
  
    <nav class="md-nav" aria-label="12.3 初始化演示工程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1231-nacos8848" class="md-nav__link">
    12.3.1 启动Nacos8848成功
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1232" class="md-nav__link">
    12.3.2 案例
  </a>
  
    <nav class="md-nav" aria-label="12.3.2 案例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-sentinel-service8401" class="md-nav__link">
    1.   创建Module：cloudalibaba-sentinel-service8401
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_11" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_11" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_15" class="md-nav__link">
    4.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-flowlimitcontroller" class="md-nav__link">
    5.   业务类FlowLimitController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1233-sentinel8080" class="md-nav__link">
    12.3.3 启动Sentinel8080
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1234-8401" class="md-nav__link">
    12.3.4 启动微服务8401
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1235-8401sentienl" class="md-nav__link">
    12.3.5 启动8401微服务后查看sentienl控制台
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124" class="md-nav__link">
    12.4 流控规则
  </a>
  
    <nav class="md-nav" aria-label="12.4 流控规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1241" class="md-nav__link">
    12.4.1 基本介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1242" class="md-nav__link">
    12.4.2 流控模式
  </a>
  
    <nav class="md-nav" aria-label="12.4.2 流控模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    1.   直接（默认）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_12" class="md-nav__link">
    2.   关联
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-a" class="md-nav__link">
    3.   配置A
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-postmantestb" class="md-nav__link">
    4.   postman模拟并发密集访问testB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_11" class="md-nav__link">
    5.   链路
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1243" class="md-nav__link">
    12.4.3 流控效果
  </a>
  
    <nav class="md-nav" aria-label="12.4.3 流控效果">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-" class="md-nav__link">
    1.   直接-&gt;快速失败（默认的流控处理）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_13" class="md-nav__link">
    2.   预热
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_8" class="md-nav__link">
    3.   排队等待
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125" class="md-nav__link">
    12.5 降级规则
  </a>
  
    <nav class="md-nav" aria-label="12.5 降级规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1251" class="md-nav__link">
    12.5.1 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1252" class="md-nav__link">
    12.5.2 基本介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1253" class="md-nav__link">
    12.5.3 降级策略实战
  </a>
  
    <nav class="md-nav" aria-label="12.5.3 降级策略实战">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-rt" class="md-nav__link">
    1.   RT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_14" class="md-nav__link">
    2.   异常比例
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_9" class="md-nav__link">
    3.   异常数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#126-key" class="md-nav__link">
    12.6 热点key限流
  </a>
  
    <nav class="md-nav" aria-label="12.6 热点key限流">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1261" class="md-nav__link">
    12.6.1 基本介绍
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1262" class="md-nav__link">
    12.6.2 官网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1263" class="md-nav__link">
    12.6.3 承上启下复习
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1264" class="md-nav__link">
    12.6.4 代码
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1265" class="md-nav__link">
    12.6.5 配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1266" class="md-nav__link">
    12.6.6 参数例外项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1267" class="md-nav__link">
    12.6.7 其他
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#127" class="md-nav__link">
    12.7 系统规则
  </a>
  
    <nav class="md-nav" aria-label="12.7 系统规则">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1271" class="md-nav__link">
    12.7.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1272" class="md-nav__link">
    12.7.2 各项配置参数说明
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1273-qps" class="md-nav__link">
    12.7.3 配置全局QPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#128-sentinelresource" class="md-nav__link">
    12.8 @SentinelResource
  </a>
  
    <nav class="md-nav" aria-label="12.8 @SentinelResource">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1281" class="md-nav__link">
    12.8.1 按资源名称限流+后续处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1282-url" class="md-nav__link">
    12.8.2 按照Url地址限流+后续处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1283" class="md-nav__link">
    12.8.3 上面兜底方法面临的问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1284" class="md-nav__link">
    12.8.4 客户自定义限流处理逻辑
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1285" class="md-nav__link">
    12.8.5 更多注解属性说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#129" class="md-nav__link">
    12.9 服务熔断功能
  </a>
  
    <nav class="md-nav" aria-label="12.9 服务熔断功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1291-sentinelribbonopenfeignfallback" class="md-nav__link">
    12.9.1 sentinel整合ribbon+openFeign+fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1292-ribbon" class="md-nav__link">
    12.9.2 Ribbon系列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-nacossentinel" class="md-nav__link">
    1.   启动nacos和sentinel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-90039004" class="md-nav__link">
    2.   提供者9003/9004
  </a>
  
    <nav class="md-nav" aria-label="2.   提供者9003/9004">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-provider-payment90039004" class="md-nav__link">
    1)  新建Module：cloudalibaba-provider-payment9003/9004
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_12" class="md-nav__link">
    2)  POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_12" class="md-nav__link">
    3)  YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_16" class="md-nav__link">
    4)  主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_12" class="md-nav__link">
    5)  业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_5" class="md-nav__link">
    6)  测试地址
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-84" class="md-nav__link">
    3.   消费者84
  </a>
  
    <nav class="md-nav" aria-label="3.   消费者84">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-modulecloudalibaba-consumer-nacos-order84" class="md-nav__link">
    1)  新建Module：cloudalibaba-consumer-nacos-order84
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_13" class="md-nav__link">
    2)  POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_13" class="md-nav__link">
    3)  YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_17" class="md-nav__link">
    4)  主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_13" class="md-nav__link">
    5)  业务类
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_18" class="md-nav__link">
    4.   目的
  </a>
  
    <nav class="md-nav" aria-label="4.   目的">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    实验1.没有任何配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2fallback" class="md-nav__link">
    实验2.只配置fallback
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3blockhandler" class="md-nav__link">
    实验3.只配置blockHandler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4fallbackblockhandler" class="md-nav__link">
    实验4.fallback和blockHandler都配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_14" class="md-nav__link">
    实验5.忽略属性…
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1293-feign" class="md-nav__link">
    12.9.3 Feign系列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-84" class="md-nav__link">
    1.   修改84模块
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_14" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_14" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_19" class="md-nav__link">
    4.   业务类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_15" class="md-nav__link">
    5.   主启动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-httplocalhost84consumerpaymentsql1" class="md-nav__link">
    6.   http://localhost:84/consumer/paymentSQL/1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-849003900384" class="md-nav__link">
    7.   测试84调用9003，此时故意关闭9003微服务提供者，看84消费侧自动降级，不会被耗死
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#194" class="md-nav__link">
    1.9.4.    熔断框架比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210" class="md-nav__link">
    12.10 规则持久化
  </a>
  
    <nav class="md-nav" aria-label="12.10 规则持久化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#12101" class="md-nav__link">
    12.10.1 是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12102" class="md-nav__link">
    12.10.2 怎么玩
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12103" class="md-nav__link">
    12.10.3 步骤
  </a>
  
    <nav class="md-nav" aria-label="12.10.3 步骤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cloudalibaba-sentinel-service8401" class="md-nav__link">
    1.   修改：cloudalibaba-sentinel-service8401
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-pom_15" class="md-nav__link">
    2.   POM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml_15" class="md-nav__link">
    3.   YML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-nacos" class="md-nav__link">
    4.   添加Nacos业务规则配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-8401sentinel" class="md-nav__link">
    5.   启动8401后刷新sentinel发现业务规则有了
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_6" class="md-nav__link">
    6.   快速访问测试接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-8401sentinel" class="md-nav__link">
    7.   停止8401再看sentinel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-8401sentinel" class="md-nav__link">
    8.   重新启动8401再看sentinel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="springcloud">框架高级课程系列之SpringCloud<a class="headerlink" href="#springcloud" title="Permanent link">&para;</a></h1>
<h2 id="_1">课程计划<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>微服务、分布式概念、微服务架构 </p>
</li>
<li>
<p>注册中心：Eureka</p>
</li>
<li>
<p>负载均衡：Ribbon</p>
</li>
<li>
<p>声明式调用远程方法：OpenFeign</p>
</li>
<li>
<p>熔断、降级、监控：Hystrix</p>
</li>
<li>
<p>网关：Gateway</p>
</li>
<li>
<p>链路跟踪：Sleuth </p>
</li>
<li>
<p>服务注册和配置中心：Spring Cloud Alibaba Nacos</p>
</li>
<li>
<p>熔断、降级、限流：Spring Cloud Alibaba Sentinel</p>
</li>
</ul>
<h2 id="1">1. 微服务理论<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p><a href="https://www.martinfowler.com/articles/microservices.html">https://www.martinfowler.com/articles/microservices.html</a></p>
<p><a href="http://blog.cuicc.com/blog/2015/07/22/microservices/">http://blog.cuicc.com/blog/2015/07/22/microservices/</a></p>
<blockquote>
<p>In short（简言之）, the microservice architectural style 【架构风格】[1] is an approach to developing a single application as a suite of small services【独立应用变成一套小服务】, each running in its own process and communicating with lightweight(轻量级沟通) mechanisms(每一个都运行在自己的进程内（容器）), often an HTTP resource API(用HTTP，将功能写成能接受请求). These services are built around business capabilities （独立业务能力）and independently deployable by fully automated deployment machinery（应该自动化独立部署）. There is a bare minimum of centralized management of these services（应该有一个能管理这些服务的中心）, which may be written in different programming languages (独立开发语言)and use different data storage technologies（独立的数据存储）.</p>
</blockquote>
<h2 id="2">2. 分布式概念<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 什么是分布式<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<blockquote>
<p>《分布式系统原理与范型》定义：“分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统”。</p>
</blockquote>
<p>分布式系统（distributed system）是建立在网络之上的软件系统。</p>
<h3 id="22">2.2 分布式与集群的关系<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<p>集群指的是将几台服务器集中在一起，实现同一业务。</p>
<p><strong>分布式中的每一个节点，都可以做集群。</strong> <strong>而集群并不一定就是分布式的。</strong></p>
<h3 id="23">2.3 软件架构演变<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<p><img alt="1608023031" src="../imgs/1608023031.jpg" /></p>
<h4 id="231">2.3.1 单一应用架构<a class="headerlink" href="#231" title="Permanent link">&para;</a></h4>
<p>当网站流量很小时，只需一个应用，将所有功能都部署在一起，以减少部署节点和成本。此时，用于简化增删改查工作量的数据访问框架(ORM) 是关键。</p>
<p><img alt="1608023271" src="../imgs/1608023271.jpg" /></p>
<h4 id="232">2.3.2 垂直应用架构<a class="headerlink" href="#232" title="Permanent link">&para;</a></h4>
<p>当访问量逐渐增大，单一应用增加机器带来的加速度越来越小，将应用拆成互不相干的几个应用，以提升效率。此时，用于加速前端页面开发的Web框架(MVC)是关键。</p>
<p><img alt="1608023397" src="../imgs/1608023397.jpg" /></p>
<h4 id="233">2.3.3 分布式服务架构<a class="headerlink" href="#233" title="Permanent link">&para;</a></h4>
<p>当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，使前端应用能更快速的响应多变的市场需求。此时，用于提高业务复用及整合的分布式服务框架RPC)是关键。</p>
<p><img alt="1608098806" src="../imgs/1608098806.jpg" /></p>
<h4 id="234">2.3.4 流动计算架构<a class="headerlink" href="#234" title="Permanent link">&para;</a></h4>
<p>当服务越来越多，容量的评估，小服务资源的浪费等问题逐渐显现，此时需增加一个调度中心基于访问压力实时管理集群容量，提高集群利用率。此时，用于提高机器利用率的<strong>资源调度和治理中心(SOA)是关键</strong>。</p>
<p><img alt="1608098942" src="../imgs/1608098942.jpg" /></p>
<h3 id="24-rpc">2.4 RPC是什么<a class="headerlink" href="#24-rpc" title="Permanent link">&para;</a></h3>
<p><strong>RPC【Remote Procedure Call】</strong>是指远程过程调用，是一种进程间通信方式，他是一种技术的思想，而不是规范。</p>
<p>它允许程序调用另一个地址空间（通常是共享网络的另一台机器上）的过程或函数，而不用程序员显式编码这个远程调用的细节。</p>
<p>即程序员无论是调用本地的还是远程的函数，本质上编写的调用代码基本相同。</p>
<h4 id="241">2.4.1 解决分布式系统的各个服务之间互相交互问题<a class="headerlink" href="#241" title="Permanent link">&para;</a></h4>
<h4 id="242-rpc">2.4.2 RPC思想原理<a class="headerlink" href="#242-rpc" title="Permanent link">&para;</a></h4>
<p><img alt="1608099187" src="../imgs/1608099187.jpg" /></p>
<p><img alt="1608099252" src="../imgs/1608099252.jpg" /></p>
<h4 id="243">2.4.3 服务之间的交互可以用两种方式<a class="headerlink" href="#243" title="Permanent link">&para;</a></h4>
<ul>
<li>RPC</li>
<li>Netty（Socket）+自定义序列化</li>
<li>RestAPI   (严格来说，SpringCloud是使用Rest方式进行服务之间交互的，不属于RPC)</li>
<li>HTTP+JSON</li>
</ul>
<h3 id="25">2.5 分布式思想与基本概念<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<h4 id="251">2.5.1 高并发<a class="headerlink" href="#251" title="Permanent link">&para;</a></h4>
<p><strong>1)</strong>  <strong>通过设计保证系统可以并行处理很多请求。应对大量流量与请求</strong></p>
<ul>
<li><strong>Tomcat最多支持并发多少用户？</strong></li>
</ul>
<p>Tomcat 默认配置的最大请求数是 150，也就是说同时支持 150 个并发，当然了，也可以将其改大。</p>
<p>当某个应用拥有 250 个以上并发的时候，应考虑应用服务器的集群。</p>
<p>具体能承载多少并发，需要看硬件的配置，CPU 越多性能越高，分配给 JVM 的内存越多性能也就越高，但也会加重 GC 的负担。</p>
<ul>
<li><strong>操作系统对于进程中的线程数有一定的限制：</strong></li>
</ul>
<p>Windows 每个进程中的线程数不允许超过 2000</p>
<p>Linux 每个进程中的线程数不允许超过 1000</p>
<p>另外，在 Java 中每开启一个线程需要耗用 1MB 的 JVM 内存空间用于作为线程栈之用。</p>
<p>Tomcat 默认的 HTTP 实现是采用阻塞式的 Socket 通信，每个请求都需要创建一个线程处理。这种模式下的并发量受到线程数的限制，但对于 Tomcat 来说几乎没有 BUG 存在了。</p>
<p>Tomcat 还可以配置 NIO 方式的 Socket 通信，在性能上高于阻塞式的，每个请求也不需要创建一个线程进行处理，并发能力比前者高。但没有阻塞式的成熟。</p>
<p>这个并发能力还与应用的逻辑密切相关，如果逻辑很复杂需要大量的计算，那并发能力势必会下降。如果每个请求都含有很多的数据库操作，那么对于数据库的性能也是非常高的。</p>
<p>对于单台数据库服务器来说，允许客户端的连接数量是有限制的。</p>
<p>并发能力问题涉及整个系统架构和业务逻辑。</p>
<p>系统环境不同，Tomcat版本不同、JDK版本不同、以及修改的设定参数不同。并发量的差异还是满大的。</p>
<ul>
<li>maxThreads="1000" 最大并发数 ，默认值为200</li>
<li>minSpareThreads="100"//初始化时创建的线程数，默认值为10</li>
<li>acceptCount="700"// 指定当所有可以使用的处理请求的线程数都被使用时，可以放到处理队列中的请求数，超过这个数的请求将不予处理，默认值为100</li>
</ul>
<p><a href="https://tomcat.apache.org/tomcat-8.0-doc/config/http.html">https://tomcat.apache.org/tomcat-8.0-doc/config/http.html</a></p>
<p><strong>2)</strong>  <strong>高并发衡量指标</strong></p>
<ul>
<li>响应时间(RT) </li>
<li>
<p>请求做出响应的时间，即一个http请求返回所用的时间</p>
</li>
<li>
<p>吞吐量</p>
</li>
<li>
<p>系统在单位时间内处理请求的数量</p>
</li>
<li>
<p>QPS(Query/Request Per Second)、 TPS（Transaction Per Second） </p>
</li>
<li>每秒查询（请求）数、每秒事务数</li>
<li>专业的测试工具：Load Runner</li>
<li>Apache ab</li>
<li>
<p>Apache JMeter</p>
</li>
<li>
<p>并发用户数</p>
</li>
<li>承载的正常使用系统功能的用户的数量</li>
</ul>
<h4 id="252">2.5.2 高可用<a class="headerlink" href="#252" title="Permanent link">&para;</a></h4>
<p>服务<strong>集群</strong>部署
数据库主从+双机热备</p>
<ul>
<li>主-备方式（Active-Standby方式）</li>
</ul>
<p>主-备方式即指的是一台服务器处于某种业务的激活状态（即Active状态），另一台服务器处于该业务的备用状态（即Standby状态)。</p>
<ul>
<li>双主机方式（Active-Active方式）</li>
</ul>
<p>双主机方式即指两种不同业务分别在两台服务器上互为主备状态（即Active-Standby和Standby-Active状态）</p>
<h4 id="253">2.5.3 注册中心<a class="headerlink" href="#253" title="Permanent link">&para;</a></h4>
<p>保存某个服务所在地址等信息，方便调用者实时获取其他服务信息</p>
<ul>
<li>服务注册</li>
<li>服务提供者</li>
<li>服务发现</li>
<li>服务消费者</li>
</ul>
<h4 id="254">2.5.4 负载均衡<a class="headerlink" href="#254" title="Permanent link">&para;</a></h4>
<p><strong>动态将请求派发给比较闲的服务器</strong></p>
<p>策略：</p>
<ul>
<li>轮询(Round Robin)</li>
<li>加权轮询(Weighted Round Robin)</li>
<li>随机Random</li>
<li>哈希Hash</li>
<li>最小连接数LC</li>
<li>最短响应时间LRT</li>
</ul>
<h4 id="255">2.5.5 服务雪崩<a class="headerlink" href="#255" title="Permanent link">&para;</a></h4>
<p>服务之间复杂调用，一个服务不可用，导致整个系统受影响不可用</p>
<p><img alt="1608101183" src="../imgs/1608101183.jpg" /></p>
<h4 id="256">2.5.6 熔断<a class="headerlink" href="#256" title="Permanent link">&para;</a></h4>
<p>某个服务频繁超时，直接将其短路，快速返回mock（模拟/虚拟）值</p>
<p><img alt="1608101262" src="../imgs/1608101262.jpg" /></p>
<h4 id="257">2.5.7 限流<a class="headerlink" href="#257" title="Permanent link">&para;</a></h4>
<p>限制某个服务每秒的调用本服务的频率</p>
<p><img alt="1608101331" src="../imgs/1608101331.jpg" /></p>
<h4 id="258-api">2.5.8 API网关<a class="headerlink" href="#258-api" title="Permanent link">&para;</a></h4>
<p>API网关要做很多工作，它作为一个系统的后端总入口，承载着所有服务的组合路由转换等工作，除此之外，我们一般也会把安全，限流，缓存，日志，监控，重试，熔断等放到 API 网关来做</p>
<h4 id="259">2.5.9 服务跟踪<a class="headerlink" href="#259" title="Permanent link">&para;</a></h4>
<p>追踪服务的调用链，记录整个系统执行请求过程。如：请求响应时间，判断链中的哪些服务属于慢服务（可能存在问题，需要改善）。</p>
<h4 id="2510">2.5.10 弹性云<a class="headerlink" href="#2510" title="Permanent link">&para;</a></h4>
<p>Elastic Compute Service（ECS）弹性计算服务</p>
<p>动态扩容，压榨服务器闲时能力</p>
<p>例如：双11,618，高峰时多配置些服务器，平时减少多余的服务器配置（用于其他服务应用），避免资源浪费</p>
<h2 id="3-springcloud">3. SpringCloud背景<a class="headerlink" href="#3-springcloud" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 背景介绍<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<h4 id="311">3.1.1 微服务架构<a class="headerlink" href="#311" title="Permanent link">&para;</a></h4>
<p><img alt="1608101954" src="../imgs/1608101954.jpg" /></p>
<p><strong>物联网（ IoT ，Internet of things ）</strong>即“万物相连的互联网”，是互联网基础上的延伸和扩展的网络，将各种信息传感设备与互联网结合起来而形成的一个巨大网络，实现在任何时间、任何地点，人、机、物的互联互通。</p>
<p><strong>Breaker dashboard 断路器仪表板</strong></p>
<p><strong>Distributed Tracing分布式跟踪</strong> （分布式处理程序链跟踪用于监视网络等待时间，并可视化通过微服务的请求流）</p>
<h4 id="312-springboot">3.1.2 微服务框架之SpringBoot<a class="headerlink" href="#312-springboot" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/htmlsingle/">https://docs.spring.io/spring-boot/docs/2.2.2.RELEASE/reference/htmlsingle/</a></p>
<h4 id="313-springcloud">3.1.3. 分布式系统微服务架构之SpringCloud<a class="headerlink" href="#313-springcloud" title="Permanent link">&para;</a></h4>
<p><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/">https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/</a></p>
<p>英文困难的同学，也不耽误学习的</p>
<p><a href="https://www.bookstack.cn/read/spring-cloud-docs/docs-index.md">https://www.bookstack.cn/read/spring-cloud-docs/docs-index.md</a></p>
<h4 id="314">3.1.4 组件概述<a class="headerlink" href="#314" title="Permanent link">&para;</a></h4>
<p><img alt="1608102029" src="../imgs/1608102029.jpg" /></p>
<h3 id="32-springbootspringcloud">3.2 关于SpringBoot和SpringCloud版本<a class="headerlink" href="#32-springbootspringcloud" title="Permanent link">&para;</a></h3>
<h4 id="321-springcloud">3.2.1 SpringCloud版本选择<a class="headerlink" href="#321-springcloud" title="Permanent link">&para;</a></h4>
<p>SpringBoot2.X版和SpringCloud H版</p>
<p>SpringCloud Alibaba 2.1</p>
<h4 id="322-springboot">3.2.2.    Springboot版本选择<a class="headerlink" href="#322-springboot" title="Permanent link">&para;</a></h4>
<p>git源码地址： </p>
<p><a href="https://github.com/spring-projects/spring-boot/releases/">https://github.com/spring-projects/spring-boot/releases/</a></p>
<p>SpringBoot2.0新特性：</p>
<p><a href="https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.0-Release-Notes">https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.0-Release-Notes</a></p>
<p>通过上面官网发现，Boot官方强烈建议你升级到<strong>2.X</strong>以上版本</p>
<p><img alt="1608102187" src="../imgs/1608102187.jpg" /></p>
<h4 id="323-boot">3.2.3 官网看Boot版本<a class="headerlink" href="#323-boot" title="Permanent link">&para;</a></h4>
<p>springboot(截至2020.4.4)</p>
<p><img alt="1608102241" src="../imgs/1608102241.jpg" /></p>
<h4 id="324-springcloud">3.2.4 SpringCloud版本选择<a class="headerlink" href="#324-springcloud" title="Permanent link">&para;</a></h4>
<ul>
<li>git源码地址： <a href="https://github.com/spring-projects/spring-cloud/wiki">https://github.com/spring-projects/spring-cloud/wiki</a></li>
<li>官网： <a href="https://spring.io/projects/spring-cloud">https://spring.io/projects/spring-cloud</a></li>
</ul>
<p>官网看Cloud版本 </p>
<ul>
<li>Cloud命名规则</li>
</ul>
<p>Spring Cloud采用了英国伦敦地铁站的名称来命名，并由地铁站名称字母A-Z依次类推的形式来发布迭代版本。</p>
<p>Spring Cloud 是一个由许多子项目组成的综合项目，各子项目有不同的发布节奏。为了管理SpringCloud与各子项目的版本依赖关系，发布了一个清单，其中包括了某个SpringCloud版本对应的子项目版本。为了避免SpringCloud版本号与子项目版本号混淆，SpringCloud版本采用了名称而非版本号的命名，这些版本的名字采用了<strong>伦敦地铁站</strong>的名字，根据字母表的顺序来应对版本时间顺序。例如Angel是第一个版本，Brixton是第二个版本。当SpringCloud的发布内容积累到临界点或者一个重大BUG被解决后，会发布一个"service releases"版本，简称SRX版本，比如Greenwich.SR2就是SpringCloud发布的Greenwich版本的第二个SRX版本。</p>
<ul>
<li>SpringCloud(截至2020.4.4)</li>
</ul>
<p><img alt="1608102384" src="../imgs/1608102384.jpg" /></p>
<h4 id="325-springcloudspringboot">3.2.5 SpringCloud和Springboot之间的依赖关系<a class="headerlink" href="#325-springcloudspringboot" title="Permanent link">&para;</a></h4>
<p><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/">https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/</a></p>
<p><img alt="1608102441" src="../imgs/1608102441.jpg" /></p>
<p>最新版本对应关系：截止2020年4月初</p>
<p><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR3/reference/html/spring-cloud.html">https://cloud.spring.io/spring-cloud-static/Hoxton.SR3/reference/html/spring-cloud.html</a></p>
<p><img alt="1608102494" src="../imgs/1608102494.jpg" /></p>
<p>更详细的版本对应查看方法： <a href="https://start.spring.io/actuator/info">https://start.spring.io/actuator/info</a></p>
<p><img alt="1608102640" src="../imgs/1608102640.jpg" /></p>
<h4 id="326-springcloud">3.2.6.    SpringCloud（授课选择版本）<a class="headerlink" href="#326-springcloud" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>cloud</p>
</li>
<li>
<p>Hoxton.SR1</p>
</li>
<li>
<p>boot</p>
</li>
<li>
<p>2.2.2.RELEASE</p>
</li>
<li>
<p>cloud Alibaba</p>
</li>
<li>
<p>2.1.0.RELEASE</p>
</li>
<li>
<p>java</p>
</li>
<li>
<p>JAVA8</p>
</li>
<li>
<p>maven</p>
</li>
<li>
<p>3.5及以上</p>
</li>
<li>
<p>mysql</p>
</li>
<li>
<p>5.7及以上</p>
</li>
</ul>
<h3 id="33-ideaproject">3.3 微服务架构编码构建-IDEA新建project工作空间<a class="headerlink" href="#33-ideaproject" title="Permanent link">&para;</a></h3>
<h4 id="331-cloudproject">3.3.1 微服务cloud整体聚合父工程Project<a class="headerlink" href="#331-cloudproject" title="Permanent link">&para;</a></h4>
<h5 id="1-new-project">1.   New Project<a class="headerlink" href="#1-new-project" title="Permanent link">&para;</a></h5>
<p><img alt="1608102842" src="../imgs/1608102842.jpg" /></p>
<h5 id="2_1">2.   聚合总工程名字<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h5>
<p><img alt="1608102886" src="../imgs/1608102886.jpg" /></p>
<h5 id="3-maven">3.   Maven选版本<a class="headerlink" href="#3-maven" title="Permanent link">&para;</a></h5>
<p><img alt="1608102952" src="../imgs/1608102952.jpg" /></p>
<h5 id="4">4.   工程名字<a class="headerlink" href="#4" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216151657966" src="../imgs/image-20201216151657966.png" /></p>
<h5 id="5">5.   字符编码<a class="headerlink" href="#5" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216155700313" src="../imgs/image-20201216155700313.png" /></p>
<h5 id="6">6.   注解生效激活<a class="headerlink" href="#6" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216155732948" src="../imgs/image-20201216155732948.png" /></p>
<h5 id="7-java">7.   java编译版本<a class="headerlink" href="#7-java" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216155759533" src="../imgs/image-20201216155759533.png" /></p>
<h5 id="8-file-type">8.   File Type过滤【可选】<a class="headerlink" href="#8-file-type" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216155820250" src="../imgs/image-20201216155820250.png" /></p>
<h4 id="332-pom">3.3.2 父工程POM<a class="headerlink" href="#332-pom" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;

  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
  &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;pom&lt;/packaging&gt;

  &lt;!-- 统一管理jar包版本 --&gt;
  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;junit.version&gt;4.12&lt;/junit.version&gt;
    &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt;
    &lt;lombok.version&gt;1.16.18&lt;/lombok.version&gt;
    &lt;mysql.version&gt;5.1.47&lt;/mysql.version&gt;
    &lt;druid.version&gt;1.1.16&lt;/druid.version&gt;
    &lt;mybatis.spring.boot.version&gt;1.3.0&lt;/mybatis.spring.boot.version&gt;
  &lt;/properties&gt;

  &lt;!-- 子模块继承之后，提供作用：锁定版本+子modlue不用写groupId和version  --&gt;
  &lt;dependencyManagement&gt;
    &lt;dependencies&gt;
      &lt;!--spring boot 2.2.2--&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;
        &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;import&lt;/scope&gt;
      &lt;/dependency&gt;
      &lt;!--spring cloud Hoxton.SR1--&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
        &lt;version&gt;Hoxton.SR1&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;import&lt;/scope&gt;
      &lt;/dependency&gt;
      &lt;!--spring cloud alibaba 2.1.0.RELEASE--&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;
        &lt;version&gt;2.1.0.RELEASE&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;import&lt;/scope&gt;
      &lt;/dependency&gt;

      &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;version&gt;${mysql.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
        &lt;artifactId&gt;druid&lt;/artifactId&gt;
        &lt;version&gt;${druid.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
        &lt;version&gt;${mybatis.spring.boot.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;junit&lt;/groupId&gt;
        &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;version&gt;${junit.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j&lt;/artifactId&gt;
        &lt;version&gt;${log4j.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
        &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;version&gt;${lombok.version}&lt;/version&gt;
        &lt;optional&gt;true&lt;/optional&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;

  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;fork&gt;true&lt;/fork&gt;
          &lt;addResources&gt;true&lt;/addResources&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;

&lt;/project&gt;
</code></pre></div>
<h4 id="333-maven">3.3.3 Maven工程落地细节复习<a class="headerlink" href="#333-maven" title="Permanent link">&para;</a></h4>
<p>Maven中的<strong>dependencyManagement</strong>和<strong>dependencies</strong>区别</p>
<p>maven中跳过单元测试【可选】</p>
<p><img alt="image-20201216160039027" src="../imgs/image-20201216160039027.png" /></p>
<h4 id="334-mvninstall">3.3.4 父工程创建完成执行mvn:install<a class="headerlink" href="#334-mvninstall" title="Permanent link">&para;</a></h4>
<h3 id="34-rest-">3.4 微服务架构编码构建-Rest微服务-【服务提供者】<a class="headerlink" href="#34-rest-" title="Permanent link">&para;</a></h3>
<h4 id="341-cloud-provider-payment8001">3.4.1 建cloud-provider-payment8001<a class="headerlink" href="#341-cloud-provider-payment8001" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216160140774" src="../imgs/image-20201216160140774.png" /></p>
<p><img alt="image-20201216160200666" src="../imgs/image-20201216160200666.png" /></p>
<p>创建完成后请回到父工程查看pom文件变化，增加了聚合模块</p>
<div class="highlight"><pre><span></span><code> &lt;modules&gt;
    &lt;module&gt;cloud-provider-payment8001&lt;/module&gt;
  &lt;/modules&gt;
</code></pre></div>
<h4 id="342-pom">3.4.2 改POM文件<a class="headerlink" href="#342-pom" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;artifactId&gt;cloud-provider-payment8001&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;1.1.10&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
           &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h4 id="343-yml">3.4.3 写YML<a class="headerlink" href="#343-yml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 8001

spring:
  application:
    name: cloud-payment-service
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://localhost:3306/cloud2020?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false
    username: root
    password: root

mybatis:
  mapperLocations: classpath:/mapper/*.xml
  type-aliases-package: com.atguigu.springcloud.entities
</code></pre></div>
<h4 id="344">3.4.4 主启动<a class="headerlink" href="#344" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class PaymentMain8001 {
    public static void main(String[] args) {
        SpringApplication.run(PaymentMain8001.class,args);
    }
}
</code></pre></div>
<h4 id="345">3.4.5 业务类<a class="headerlink" href="#345" title="Permanent link">&para;</a></h4>
<h5 id="1-sql">1.   建表SQL<a class="headerlink" href="#1-sql" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>CREATE DATABASE  IF NOT EXISTS cloud2020 DEFAULT CHARACTER SET utf8 ;

USE cloud2020 ;

DROP TABLE IF EXISTS payment ;

CREATE TABLE payment (
  id BIGINT (20) NOT NULL AUTO_INCREMENT COMMENT &#39;ID&#39;,
  SERIAL VARCHAR (300) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE = INNODB AUTO_INCREMENT = 33 DEFAULT CHARSET = utf8 ;

INSERT INTO payment (id, SERIAL) VALUES(31, &#39;尚硅谷001&#39;),(32, &#39;atguigu002&#39;) ;
</code></pre></div>
<h5 id="2-entitles">2.   Entitles<a class="headerlink" href="#2-entitles" title="Permanent link">&para;</a></h5>
<h6 id="1-payment">1)  主实体Payment<a class="headerlink" href="#1-payment" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.entities;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import java.io.Serializable;

@Data
@AllArgsConstructor
@NoArgsConstructor
public class Payment implements Serializable {
    private Long id;
    private String serial;
}
</code></pre></div>
<h6 id="2-jsoncommonresult">2)  Json封装体CommonResult<a class="headerlink" href="#2-jsoncommonresult" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.entities;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@AllArgsConstructor
@NoArgsConstructor
public class CommonResult &lt;T&gt; implements Serializable{

    private Integer code;
    private String message;
    private T data;

    public CommonResult(Integer code,String message){
        this(code,message,null);//如果这行报错，请安装lombok插件
    }
}
</code></pre></div>
<h6 id="3-lombok">3)  安装lombok插件<a class="headerlink" href="#3-lombok" title="Permanent link">&para;</a></h6>
<p><img alt="image-20201216160512654" src="../imgs/image-20201216160512654.png" /></p>
<p><a href="https://www.projectlombok.org/">https://www.projectlombok.org/</a></p>
<p>@Data：提供getter/setter</p>
<p>@NoArgsConstructor, 无参构造器 @RequiredArgsConstructor  @AllArgsConstructor 全参数构造器</p>
<p>@EqualsAndHashCode：提供equals和hashCode方法</p>
<p>@Getter/@Setter</p>
<p>@Slf4j 内置log对象，直接调用日志方法输出日志</p>
<h5 id="3-dao">3.   Dao<a class="headerlink" href="#3-dao" title="Permanent link">&para;</a></h5>
<h6 id="1-paymentdao">1)  接口PaymentDao<a class="headerlink" href="#1-paymentdao" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.dao;

import com.atguigu.springcloud.entities.Payment;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Repository;

@Component       //代替@Repository声明bean
@Mapper               //mybatis提供的，等价：@MapperScan(&quot;com.atguigu.springcloud.dao&quot;)
//@Repository     //spring提供的。在此，只是为了声明bean对象
public interface PaymentDao {
    public int create(Payment payment);    
    public Payment getPaymentById(@Param(&quot;id&quot;) Long id);
}
</code></pre></div>
<h6 id="2-mybatis">2)  mybatis的映射文件<a class="headerlink" href="#2-mybatis" title="Permanent link">&para;</a></h6>
<p>src\main\resources\mapper\PaymentMapper.xml</p>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;com.atguigu.springcloud.dao.PaymentDao&quot;&gt;
    &lt;insert id=&quot;create&quot;  useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;
            insert into payment(serial) values(#{serial});
    &lt;/insert&gt;

    &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.atguigu.springcloud.entities.Payment&quot;&gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot; jdbcType=&quot;BIGINT&quot;&gt;&lt;/id&gt;
        &lt;result column=&quot;serial&quot; property=&quot;serial&quot; jdbcType=&quot;VARCHAR&quot;&gt;&lt;/result&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;getPaymentById&quot;  parameterType=&quot;Long&quot; resultMap=&quot;BaseResultMap&quot;&gt;
            select * from payment where id=#{id}
    &lt;/select&gt;

&lt;/mapper&gt;
</code></pre></div>
<h5 id="4-service">4.   Service<a class="headerlink" href="#4-service" title="Permanent link">&para;</a></h5>
<h6 id="1-paymentservice">1)  接口PaymentService<a class="headerlink" href="#1-paymentservice" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service;

import com.atguigu.springcloud.entities.Payment;
import org.apache.ibatis.annotations.Param;

public interface PaymentService {
    public int create(Payment payment); //写
    public Payment getPaymentById(Long id);  //读取
}
</code></pre></div>
<h6 id="2-paymentserviceimpl">2)  实现类PaymentServiceImpl<a class="headerlink" href="#2-paymentserviceimpl" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service.impl;

import com.atguigu.springcloud.dao.PaymentDao;
import com.atguigu.springcloud.entities.Payment;
import com.atguigu.springcloud.service.PaymentService;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Service;
import javax.annotation.Resource;

@Service
public class PaymentServiceImpl implements PaymentService {

    @Resource
    //@Autowired
    private PaymentDao paymentDao;

    public int create(Payment payment){
        return paymentDao.create(payment);
    }

    public Payment getPaymentById( Long id){
        return paymentDao.getPaymentById(id);
    }
}
</code></pre></div>
<h5 id="5-controller">5.   Controller<a class="headerlink" href="#5-controller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.controller;

import com.atguigu.springcloud.entities.CommonResult;
import com.atguigu.springcloud.entities.Payment;
import com.atguigu.springcloud.service.PaymentService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RestController;
import javax.annotation.Resource;

@RestController
@Slf4j
public class PaymentController {

    @Resource
    private PaymentService paymentService;

    @PostMapping(value = &quot;/payment/create&quot;)
    public CommonResult&lt;Payment&gt; create(Payment payment){ //埋雷
       int result = paymentService.create(payment);
       log.info(&quot;*****插入结果：&quot;+result);
       if (result&gt;0){  //成功
           return new CommonResult(200,&quot;插入数据库成功&quot;,result);
       }else {
           return new CommonResult(444,&quot;插入数据库失败&quot;,null);
       }
    }

    @GetMapping(value = &quot;/payment/get/{id}&quot;)
    public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id){
        Payment payment = paymentService.getPaymentById(id);
        log.info(&quot;*****查询结果：&quot;+payment);
        if (payment!=null){  //说明有数据，能查询成功
            return new CommonResult(200,&quot;查询成功&quot;,payment);
        }else {
            return new CommonResult(444,&quot;没有对应记录，查询ID：&quot;+id,null);
        }
    }
}
</code></pre></div>
<h4 id="346">3.4.6.    测试<a class="headerlink" href="#346" title="Permanent link">&para;</a></h4>
<h5 id="1-postmanget">1.   postman测试get请求<a class="headerlink" href="#1-postmanget" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216160849918" src="../imgs/image-20201216160849918.png" /></p>
<h5 id="2-postmanpost">2.   postman测试post请求<a class="headerlink" href="#2-postmanpost" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216160906150" src="../imgs/image-20201216160906150.png" /></p>
<h5 id="3">3.   快速运行设置<a class="headerlink" href="#3" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216160930081" src="../imgs/image-20201216160930081.png" /></p>
<p><img alt="image-20201216160955575" src="../imgs/image-20201216160955575.png" /></p>
<h4 id="347-">3.4.7 开发步骤-小总结<a class="headerlink" href="#347-" title="Permanent link">&para;</a></h4>
<p>1)  建module</p>
<p>2)  改POM</p>
<p>3)  写YML</p>
<p>4)  主启动</p>
<p>5)  业务类</p>
<h4 id="348-devtools">3.4.8 热部署Devtools<a class="headerlink" href="#348-devtools" title="Permanent link">&para;</a></h4>
<h5 id="1-adding-devtools-to-your-project">1.   Adding devtools to your project<a class="headerlink" href="#1-adding-devtools-to-your-project" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
   &lt;scope&gt;runtime&lt;/scope&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="2-adding-plugin-to-your-pomxml">2.   Adding plugin to your pom.xml<a class="headerlink" href="#2-adding-plugin-to-your-pomxml" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;!--下一段配置黏贴到父工程当中的pom里--&gt;
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
        &lt;fork&gt;true&lt;/fork&gt;
        &lt;addResources&gt;true&lt;/addResources&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
</code></pre></div>
<h5 id="3-enabling-automatic-build">3.   Enabling automatic build<a class="headerlink" href="#3-enabling-automatic-build" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216161203271" src="../imgs/image-20201216161203271.png" /></p>
<h5 id="4-update-the-value-of">4.   Update the value of<a class="headerlink" href="#4-update-the-value-of" title="Permanent link">&para;</a></h5>
<p>Ctrl+Shift+Alt+/选择Registry…</p>
<p><img alt="image-20201216161219139" src="../imgs/image-20201216161219139.png" /></p>
<p>compiler.automake.allow.when.app.running -&gt; 自动编译</p>
<p>compile.document.save.trigger.delay -&gt; 自动更新文件；它主要是针对静态文件如JS CSS的更新，将延迟时间减少后，直接按F5刷新页面就能看到效果！</p>
<p><img alt="image-20201216161237555" src="../imgs/image-20201216161237555.png" /></p>
<h5 id="5-idea">5.   重启IDEA<a class="headerlink" href="#5-idea" title="Permanent link">&para;</a></h5>
<h3 id="35-rest-">3.5 微服务架构编码构建-Rest微服务-【服务消费者】<a class="headerlink" href="#35-rest-" title="Permanent link">&para;</a></h3>
<h4 id="351-cloud-consumer-order80">3.5.1 建cloud-consumer-order80<a class="headerlink" href="#351-cloud-consumer-order80" title="Permanent link">&para;</a></h4>
<h4 id="352-pom">3.5.2 改POM<a class="headerlink" href="#352-pom" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-consumer-order80&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h4 id="353-yml">3.5.3 写YML<a class="headerlink" href="#353-yml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 80
spring:
  application:
    name: cloud-consumer-order80
</code></pre></div>
<h4 id="354">3.5.4 主启动<a class="headerlink" href="#354" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class OrderMain80 {
    public static void main(String[] args) {
        SpringApplication.run(OrderMain80.class,args);
    }
}
</code></pre></div>
<h4 id="355">3.5.5 业务类<a class="headerlink" href="#355" title="Permanent link">&para;</a></h4>
<h5 id="1-entities">1.   创建entities<a class="headerlink" href="#1-entities" title="Permanent link">&para;</a></h5>
<p>(将cloud-provider-payment8001工程下的entities包下的两个实体类复制过来)</p>
<h5 id="2-resttemplate">2.   RestTemplate<a class="headerlink" href="#2-resttemplate" title="Permanent link">&para;</a></h5>
<ul>
<li>是什么</li>
</ul>
<p>RestTemplate提供了多种便捷访问远程Http服务的方法，是一种简单便捷的访问Restful服务模板类，是Spring 提供的用于访问Rest服务的客户端模板工具集</p>
<ul>
<li>官网及使用</li>
</ul>
<p>官网地址： <a href="https://docs.spring.io/spring-framework/docs/5.2.2.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html">https://docs.spring.io/spring-framework/docs/5.2.2.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html</a></p>
<p>使用RestTemplate访问Restful接口非常的简单粗暴无脑。（url，requestMap，ResponseBean.class）这三个参数分别代表REST请求地址、请求参数、Http响应转换被转换成的对象类型。</p>
<h5 id="3-config">3.   config配置类<a class="headerlink" href="#3-config" title="Permanent link">&para;</a></h5>
<p>ApplicationContextConfig</p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;

//@Configuration
@SpringBootConfiguration
public class ApplicationContextConfig {

    @Bean
    //@LoadBalanced
    public RestTemplate getRestTemplate(){
        return new RestTemplate();
    }

}
</code></pre></div>
<h5 id="4-controller">4.   创建controller<a class="headerlink" href="#4-controller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.controller;

import com.atguigu.springcloud.entities.CommonResult;
import com.atguigu.springcloud.entities.Payment;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;
import javax.annotation.Resource;

@RestController
@Slf4j
public class OrderController {

    public static final String PAYMENT_URL = &quot;http://localhost:8001&quot;;

    @Resource
    private RestTemplate restTemplate;

    @PostMapping(&quot;/consumer/payment/create&quot;)
    public CommonResult&lt;Payment&gt;   create(Payment payment){
        return restTemplate.postForObject(PAYMENT_URL+&quot;/payment/create&quot;,payment,CommonResult.class);  //写操作
    }

    @GetMapping(&quot;/consumer/payment/get/{id}&quot;)
    public CommonResult&lt;Payment&gt; getPayment(@PathVariable(&quot;id&quot;) Long id){
        return restTemplate.getForObject(PAYMENT_URL+&quot;/payment/get/&quot;+id,CommonResult.class);
    }
}
</code></pre></div>
<h4 id="356">3.5.6 测试<a class="headerlink" href="#356" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>先启动cloud-provider-payment8001</p>
</li>
<li>
<p>再启动cloud-consumer-order80</p>
</li>
<li>
<p><a href="http://localhost/consumer/payment/get/32">http://localhost/consumer/payment/get/32</a></p>
</li>
<li>
<p>不要忘记@RequestBody注解</p>
</li>
<li>
<p>服务提供者接口方法需要增加@RequestBody注解(踩雷or破雷)；否则，接收不到数据。</p>
</li>
</ol>
<h3 id="36">3.6 工程重构<a class="headerlink" href="#36" title="Permanent link">&para;</a></h3>
<h4 id="361">3.6.1 观察问题<a class="headerlink" href="#361" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216172015197" src="../imgs/image-20201216172015197.png" /></p>
<h4 id="362-cloud-api-commons">3.6.2 新建：cloud-api-commons<a class="headerlink" href="#362-cloud-api-commons" title="Permanent link">&para;</a></h4>
<h4 id="363-pom">3.6.3 POM<a class="headerlink" href="#363-pom" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
           &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;cn.hutool&lt;/groupId&gt;
            &lt;artifactId&gt;hutool-all&lt;/artifactId&gt;
            &lt;version&gt;5.1.0&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;
</code></pre></div>
<h4 id="364-entities">3.6.4 entities<a class="headerlink" href="#364-entities" title="Permanent link">&para;</a></h4>
<p>Payment实体</p>
<p>CommonResult通用封装类</p>
<h4 id="365-mavenclean-install">3.6.5 maven命令clean install<a class="headerlink" href="#365-mavenclean-install" title="Permanent link">&para;</a></h4>
<h4 id="366-808001">3.6.6 订单80和支付8001分别改造<a class="headerlink" href="#366-808001" title="Permanent link">&para;</a></h4>
<p>删除各自的原先有过的entities</p>
<p>各自黏贴POM内容，依赖于cloud-api-commons公共项目</p>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
    &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
    &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div>
<h3 id="37">3.7 目前工程样图<a class="headerlink" href="#37" title="Permanent link">&para;</a></h3>
<p><img alt="image-20201216172255598" src="../imgs/image-20201216172255598.png" /></p>
<h2 id="4-eureka">4. Eureka服务注册与发现<a class="headerlink" href="#4-eureka" title="Permanent link">&para;</a></h2>
<h3 id="41-eureka">4.1 Eureka基础知识<a class="headerlink" href="#41-eureka" title="Permanent link">&para;</a></h3>
<h4 id="411">4.1.1 什么是服务治理<a class="headerlink" href="#411" title="Permanent link">&para;</a></h4>
<p>SpringCloud封装了Netflix公司开发的Eureka模块来实现服务治理。</p>
<p>在传统的RPC远程调用框架中，管理每个服务与服务之间依赖关系比较复杂、所以需要进行服务治理，管理服务与服务之间依赖关联，以实现服务调用，负载均衡、容错等，实现服务发现与注册。</p>
<h4 id="412">4.1.2 什么是服务注册<a class="headerlink" href="#412" title="Permanent link">&para;</a></h4>
<p>Eureka采用了CS的设计架构，Eureka Server作为服务注册功能的服务器，它是服务注册中心。</p>
<p>而系统中的其他微服务，使用Eureka的客户端连接到Eureka Server并维持心跳连接。这样系统的维护人员可以通过Eureka Server来监控系统中各个微服务是否正常运行。</p>
<p>在服务注册与发现中，有一个注册中心。当服务器启动的时候，会把当前自己服务器的信息，比如：服务通讯地址等以别名方式注册到注册中心上。</p>
<p>另一方（消费者服务），以该别名的方式去注册中心上获取到实际的服务通讯地址，然后，再实现本地RPC远程调用。</p>
<p>RPC远程调用框架核心设计思想：在于注册中心，因为使用注册中心管理每个服务与服务之间的一个依赖关系（服务治理概念）。</p>
<p>在任何RPC远程框架中，都会有一个注册中心（存放服务地址相关信息（接口地址））。</p>
<p><img alt="image-20201216172548697" src="../imgs/image-20201216172548697.png" /></p>
<h4 id="413-eureka">4.1.3 Eureka两组件<a class="headerlink" href="#413-eureka" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Eureka Server提供服务注册服务</strong></li>
</ul>
<p>各个微服务节点通过配置启动后，会在Eureka Server中进行注册，这样Eureka Server中的服务注册表中将会存储所有可用服务节点的信息，服务节点的信息可以在界面中直观看到。</p>
<ul>
<li><strong>Eureka Client通过注册中心进行访问</strong></li>
</ul>
<p>是一个Java客户端，用于简化Eureka Server的交互，客户端同时也具备一个内置的、使用轮询（round-robin）负载算法的负载均衡器。在应用启动后，将会在Eureka Server发送心跳（默认周期30秒）。如果Eureka Server在多个心跳周期内没有收到某个节点的心跳，Eureka Server将会从服务注册表中把这个服务节点移出（默认90秒）</p>
<h3 id="42-eureka">4.2 单机Eureka构建步骤<a class="headerlink" href="#42-eureka" title="Permanent link">&para;</a></h3>
<h4 id="421-ideaeurekaserver">4.2.1 IDEA生成eurekaServer端服务注册中心<a class="headerlink" href="#421-ideaeurekaserver" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloud-eureka-server7001">1.   建Module：cloud-eureka-server7001<a class="headerlink" href="#1-modulecloud-eureka-server7001" title="Permanent link">&para;</a></h5>
<h5 id="2-pom">2.   改POM<a class="headerlink" href="#2-pom" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-eureka-server7001&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<ul>
<li>1.X和2.X的对比说明</li>
</ul>
<div class="highlight"><pre><span></span><code>1.X版本
&lt;dependency&gt;
&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
&lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;
&lt;/dependency&gt;

2.X版本
&lt;dependency&gt;
&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
&lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="3-yml">3.   写YML<a class="headerlink" href="#3-yml" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 7001

eureka:
  instance:
    hostname: localhost

  client:
    register-with-eureka: false
    fetchRegistry: false
    service-url:
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h5 id="4_1">4.   主启动<a class="headerlink" href="#4_1" title="Permanent link">&para;</a></h5>
<p>@EnableEurekaServer</p>
<h5 id="5_1">5.   测试<a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost:7001/">http://localhost:7001/</a></p>
<h4 id="422">4.2.2 服务提供者<a class="headerlink" href="#422" title="Permanent link">&para;</a></h4>
<p><strong>EurekaClient端cloud-provider-payment8001将注册进EurekaServer成为服务提供者provider</strong></p>
<h5 id="1-modulecloud-provider-payment8001">1.   建Module：cloud-provider-payment8001<a class="headerlink" href="#1-modulecloud-provider-payment8001" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_1">2.   改POM<a class="headerlink" href="#2-pom_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="3-yml_1">3.   写YML<a class="headerlink" href="#3-yml_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>eureka:
  client:
    register-with-eureka: true
    fetchRegistry: true
    service-url:
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h5 id="4_2">4.   主启动<a class="headerlink" href="#4_2" title="Permanent link">&para;</a></h5>
<p>@EnableEurekaClient</p>
<h5 id="5_2">5.   测试<a class="headerlink" href="#5_2" title="Permanent link">&para;</a></h5>
<p>先启动EurekaServer</p>
<p><a href="http://localhost:7001/">http://localhost:7001/</a></p>
<h4 id="423">4.2.3 服务消费者<a class="headerlink" href="#423" title="Permanent link">&para;</a></h4>
<p><strong>EurekaClient端cloud-consumer-order80将注册进EurekaServer成为服务消费者consumer</strong></p>
<h5 id="1-modulecloud-consumer-order80">1.   建Module：cloud-consumer-order80<a class="headerlink" href="#1-modulecloud-consumer-order80" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_2">2.   POM<a class="headerlink" href="#2-pom_2" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="3-yml_2">3.   写YML<a class="headerlink" href="#3-yml_2" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>eureka:
  client:
    register-with-eureka: true
    fetchRegistry: true
    service-url:
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h5 id="4_3">4.   主启动<a class="headerlink" href="#4_3" title="Permanent link">&para;</a></h5>
<p>@EnableEurekaClient</p>
<h5 id="5_3">5.   测试<a class="headerlink" href="#5_3" title="Permanent link">&para;</a></h5>
<p>1)   先要启动EurekaServer，7001服务</p>
<p>2)   再要启动服务提供者8001服务和服务消费者80服务</p>
<p>3)   eureka服务器</p>
<p><img alt="image-20201216173207670" src="../imgs/image-20201216173207670.png" /></p>
<p>4)   测试查询：<a href="http://localhost/consumer/payment/get/31">http://localhost/consumer/payment/get/31</a></p>
<p>5)   测试添加：postman测试添加</p>
<p>6)   测试8001服务和80服务效果一样</p>
<p><img alt="image-20201216173237753" src="../imgs/image-20201216173237753.png" /></p>
<h2 id="5-ribbon">5. Ribbon负载均衡服务调用<a class="headerlink" href="#5-ribbon" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 概述<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<h4 id="511">5.1.1 是什么<a class="headerlink" href="#511" title="Permanent link">&para;</a></h4>
<p>Spring Cloud Ribbon是基于Netflix Ribbon实现的一套客户端负载均衡的工具。</p>
<p>简单的说，Ribbon是Netflix发布的开源项目，主要功能是提供客户端的软件负载均衡算法和服务调用。</p>
<p>Ribbon客户端组件提供一系列完善的配置项，如：连接超时，重试等。</p>
<p>简单的说，就是在配置文件中列出Load Balancer(简称LB)后面所有的机器，Ribbon会自动的帮助你基于某种规则（如简单轮询，随机连接等）去连接这些机器。</p>
<h4 id="512">5.1.2 官网资料<a class="headerlink" href="#512" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/Netflix/ribbon/wiki/Getting-Started">https://github.com/Netflix/ribbon/wiki/Getting-Started</a></p>
<p>Ribbon目前也进入维护模式</p>
<p><img alt="image-20201216173426268" src="../imgs/image-20201216173426268.png" />                              </p>
<ul>
<li>未来替换方案</li>
<li>Spring Cloud LoadBalancer</li>
</ul>
<h4 id="513">5.1.3 能干嘛<a class="headerlink" href="#513" title="Permanent link">&para;</a></h4>
<h5 id="1-lb">1.   LB（负载均衡）<a class="headerlink" href="#1-lb" title="Permanent link">&para;</a></h5>
<p>1)  简单的说就是将用户的请求平均分配到多个服务器上，从而达到系统的HA(高可用)。</p>
<p>2)  常见的负载均衡有软件Nginx，LVS，硬件F5等。</p>
<p>3)  <strong>Ribbon的本地负载均衡客户端  VS  Nginx服务端负载均衡区别</strong>：</p>
<ul>
<li>
<p>Nginx是服务器负载均衡，客户端所有请求都会交给Nginx，然后，由nginx实现转发请求。即负载均衡是由服务器端完成的。</p>
</li>
<li>
<p>Ribbon本地负载均衡，在调用微服务接口时候，会在注册中心上获取注册信息服务列表之后缓存到JVM本地，从而在本地实现RPC远程服务调用。</p>
</li>
</ul>
<p>4)  集中式LB</p>
<ul>
<li>即在服务的消费方和提供方之间使用独立的LB设施（可以是硬件，如F5，也可以是软件，如Nginx）,由该设施负责把访问请求通过某种策略转发至服务的提供方；</li>
</ul>
<p>5)  进程内LB</p>
<ul>
<li>
<p>将LB逻辑集成到消费方，消费方从服务注册中心获知有哪些地址可用，然后自己再从这些地址中选择出一个合适的服务器。</p>
</li>
<li>
<p>Ribbon就属于进程内LB，它只是一个类库，集成于消费方进程，消费方通过它来获取到服务提供方的地址。</p>
</li>
</ul>
<h5 id="2_2">2.   一句话<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h5>
<p>Ribbon=负载均衡+RestTemplate调用 </p>
<h3 id="52-ribbon">5.2 Ribbon负载均衡演示<a class="headerlink" href="#52-ribbon" title="Permanent link">&para;</a></h3>
<h4 id="521">5.2.1 架构说明<a class="headerlink" href="#521" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216173657425" src="../imgs/image-20201216173657425.png" /></p>
<p>Ribbon在工作时分成两步：</p>
<p>第一步，先选择EurekaServer，它优先选择在同一个区域内负载较少的server。</p>
<p>第二步，再根据用户指定的策略，在从server取到的服务注册列表中选择一个地址。其中Ribbon提供了多种策略。比如：轮询、随机和根据响应时间加权。</p>
<p>总结：<strong>Ribbon其实就是一个软负载均衡的客户端组件，他可以和其他所需请求的客户端结合使用，和eureka结合只是其中的一个实例。</strong></p>
<h4 id="522-pom">5.2.2 POM<a class="headerlink" href="#522-pom" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<p><strong><em>注意：这个不需要手动引用，Eureka客户端自带Ribbon</em></strong></p>
<p><img alt="image-20201216173822410" src="../imgs/image-20201216173822410.png" /></p>
<h3 id="53-ribbonirule">5.3 Ribbon核心组件Irule<a class="headerlink" href="#53-ribbonirule" title="Permanent link">&para;</a></h3>
<p><img alt="image-20201216173903594" src="../imgs/image-20201216173903594.png" /></p>
<p><img alt="image-20201216173921070" src="../imgs/image-20201216173921070.png" /></p>
<h4 id="531-irule">5.3.1 IRule：根据特定算法从服务列表中选取一个要访问的服务<a class="headerlink" href="#531-irule" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>com.netflix.loadbalancer.RoundRobinRule 轮询，默认策略。</p>
</li>
<li>
<p>com.netflix.loadbalancer.RandomRule 随机</p>
</li>
<li>
<p>com.netflix.loadbalancer.RetryRule 先按照RoundRobinRule的策略获取服务，如果获取服务失败则在指定时间内会进行重试，获取可用的服务 </p>
</li>
<li>
<p>WeightedResponseTimeRule 对RoundRobinRule的扩展，响应速度越快的实例选择权重越大，越容易被选择</p>
</li>
<li>
<p>BestAvailableRule 会先过滤掉由于多次访问故障而处于断路器跳闸状态的服务，然后选择一个并发量最小的服务</p>
</li>
<li>
<p>AvailabilityFilteringRule 先过滤掉故障实例，再选择并发较小的实例</p>
</li>
<li>
<p>ZoneAvoidanceRule 默认规则，复合判断server所在区域的性能和server的可用性选择服务器</p>
</li>
</ol>
<h4 id="532">5.3.2 如何替换<a class="headerlink" href="#532" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>修改cloud-consumer-order80</p>
</li>
<li>
<p>注意配置细节</p>
</li>
</ul>
<p>官方文档明确给出警告：</p>
<p><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#customizing-the-ribbon-client">https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#customizing-the-ribbon-client</a></p>
<p><img alt="image-20201216174043119" src="../imgs/image-20201216174043119.png" /></p>
<p>这个自定义配置类不能放在@ComponentScan所扫描的当前包下以及子包下，否则我们自定义的这个配置类就会被所有的Ribbon客户端所共享，达不到特殊化订制的目的了。</p>
<h4 id="533-package">5.3.3 新建package（注意：包的位置）<a class="headerlink" href="#533-package" title="Permanent link">&para;</a></h4>
<p>com.atguigu.myrule</p>
<h4 id="534-myselfrule">5.3.4 上面包下新建MySelfRule规则类<a class="headerlink" href="#534-myselfrule" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.myrule;

import com.netflix.loadbalancer.IRule;
import com.netflix.loadbalancer.RandomRule;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class MySelfRule {

    @Bean
    public IRule myRule(){
        return new RandomRule();//定义为随机
    }
}
</code></pre></div>
<h4 id="535-ribbonclient">5.3.5 主启动类添加@RibbonClient<a class="headerlink" href="#535-ribbonclient" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import com.atguigu.myrule.MySelfRule;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;
import org.springframework.cloud.netflix.ribbon.RibbonClient;

@EnableEurekaClient
@SpringBootApplication
@RibbonClient(name = &quot;CLOUD-PAYMENT-SERVICE&quot;,configuration = MySelfRule.class)
public class OrderMain80 {
    public static void main(String[] args) {
        SpringApplication.run(OrderMain80.class,args);
    }
}
</code></pre></div>
<h4 id="536">5.3.6 测试<a class="headerlink" href="#536" title="Permanent link">&para;</a></h4>
<p><a href="http://localhost/consumer/payment/get/31">http://localhost/consumer/payment/get/31</a></p>
<h3 id="54-ribbon">5.4 Ribbon负载均衡算法<a class="headerlink" href="#54-ribbon" title="Permanent link">&para;</a></h3>
<h4 id="541">5.4.1 原理<a class="headerlink" href="#541" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216193051886" src="../imgs/image-20201216193051886.png" /></p>
<h2 id="6-openfeign">6. OpenFeign服务接口调用<a class="headerlink" href="#6-openfeign" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1. 概述<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<h4 id="611-openfeign">6.1.1 OpenFeign是什么<a class="headerlink" href="#611-openfeign" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Feign是一个声明式的web服务客户端，让编写web服务客户端变得非常容易，只需创建一个接口并在接口上添加注解即可</p>
</li>
<li>
<p>SpringCloud对Feign进行了封装，使其支持了SpringMVC标准注解和HttpMessageConverters。Feign可以与Eureka和Ribbon组合使用以支持负载均衡。</p>
</li>
</ul>
<p><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#spring-cloud-openfeign">https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#spring-cloud-openfeign</a></p>
<p><a href="https://github.com/spring-cloud/spring-cloud-openfeign">https://github.com/spring-cloud/spring-cloud-openfeign</a></p>
<h4 id="612">6.1.2 能干嘛<a class="headerlink" href="#612" title="Permanent link">&para;</a></h4>
<ul>
<li>Feign能干什么？</li>
</ul>
<p>Feign旨在使用编写Java Http客户端变得更容易。</p>
<p>前面在使用Ribbon+RestTemplate时，利用RestTemplate对Http请求的封装处理，形成了一套模板化的调用方法。</p>
<p>但是在实际开发中，由于对服务依赖的调用可能不止一处，往往一个接口会被多处调用，所以通常都会针对每个微服务自行封装一些客户端类来包装这些依赖服务端额调用。所以，Feign在此基础上做了进一步封装，由他来帮助我们定义和实现依赖服务接口的定义。</p>
<p>在Feign的实现下，我们只需创建一个接口并使用注解的方式来配置它（以前是DAO接口上面标注Mapper注解，现在是一个微服务接口上面标注一个Feign注解即可），即可完成对服务提供方的接口绑定，简化了使用Spring Cloud Ribbon时，自动封装服务调用客户端的开发量。</p>
<ul>
<li>Feign集成了 Ribbon</li>
</ul>
<p>利用Ribbon维护了Payment的服务列表信息，并且通过轮询实现了客户端的负载均衡。而与Ribbon不同的是，通过Feign只需要定义服务绑定接口且以声明式的方法，优雅而简单的实现了服务调用。</p>
<ul>
<li>Feign和OpenFeign两者区别</li>
</ul>
<p><img alt="image-20201216193436610" src="../imgs/image-20201216193436610.png" />           </p>
<h3 id="62-openfeign">6.2 OpenFeign使用步骤<a class="headerlink" href="#62-openfeign" title="Permanent link">&para;</a></h3>
<p><img alt="image-20201216193519707" src="../imgs/image-20201216193519707.png" /></p>
<h4 id="621">6.2.1 接口+注解<a class="headerlink" href="#621" title="Permanent link">&para;</a></h4>
<p>微服务调用接口+@FeignClient</p>
<h4 id="622-modulecloud-consumer-feign-order80">6.2.2 新建Module：cloud-consumer-feign-order80<a class="headerlink" href="#622-modulecloud-consumer-feign-order80" title="Permanent link">&para;</a></h4>
<h4 id="623-pom">6.2.3 POM<a class="headerlink" href="#623-pom" title="Permanent link">&para;</a></h4>
<p><strong><em>注意：openFeign也是自带bibbon</em></strong></p>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-consumer-feign-order80&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;!--openfeign--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt; 
</code></pre></div>
<h4 id="624-yml">6.2.4 YML<a class="headerlink" href="#624-yml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 80
spring:
  application:
    name: cloud-consumer-feign-order80
eureka:
  client:
register-with-eureka: true
fetch-registry: true
    service-url:
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h4 id="625">6.2.5 主启动类<a class="headerlink" href="#625" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.openfeign.EnableFeignClients;

@SpringBootApplication
@EnableEurekaClient
@EnableFeignClients
public class OrderFeignMain80 {
    public static void main(String[] args) {
        SpringApplication.run(OrderFeignMain80.class,args);
    }
}
</code></pre></div>
<h4 id="626">6.2.6 业务类<a class="headerlink" href="#626" title="Permanent link">&para;</a></h4>
<h5 id="1-feignclientprovider">1.   业务逻辑接口+@FeignClient配置调用provider服务<a class="headerlink" href="#1-feignclientprovider" title="Permanent link">&para;</a></h5>
<h5 id="2-paymentfeignservicefeignclient">2.   新建PaymentFeignService接口并新增注解@FeignClient<a class="headerlink" href="#2-paymentfeignservicefeignclient" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service;

import com.atguigu.springcloud.entities.CommonResult;
import com.atguigu.springcloud.entities.Payment;
import feign.Param;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.stereotype.Component;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;

@Component
@FeignClient(value = &quot;CLOUD-PAYMENT-SERVICE&quot;)
public interface PaymentFeignService {
    @GetMapping(value = &quot;/payment/get/{id}&quot;)
    public CommonResult getPaymentById(@PathVariable(&quot;id&quot;) Long id);
}
</code></pre></div>
<h5 id="3-controller">3.   控制层Controller<a class="headerlink" href="#3-controller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.controller;

import com.atguigu.springcloud.entities.CommonResult;
import com.atguigu.springcloud.entities.Payment;
import com.atguigu.springcloud.service.PaymentFeignService;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import javax.annotation.Resource;

@RestController
public class OrderFeignController {

    @Resource
    private PaymentFeignService paymentFeignService;  //调用远程的微服接口

    @GetMapping(value = &quot;/consumer/payment/get/{id}&quot;)
    public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id){
       return paymentFeignService.getPaymentById(id);
    }
}
</code></pre></div>
<h4 id="627">6.2.7 测试<a class="headerlink" href="#627" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>先启动Eureka7001</p>
</li>
<li>
<p>再启动2个微服务8001/8002</p>
</li>
<li>
<p>启动OpenFeign微服务：cloud-consumer-feign-order80</p>
</li>
<li>
<p><a href="http://localhost/consumer/payment/get/31">http://localhost/consumer/payment/get/31</a></p>
</li>
<li>
<p>Feign自带负载均衡配置项</p>
</li>
</ol>
<h4 id="628">6.2.8 小总结<a class="headerlink" href="#628" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216193941531" src="../imgs/image-20201216193941531.png" /></p>
<h3 id="63-openfeign">6.3 OpenFeign超时控制<a class="headerlink" href="#63-openfeign" title="Permanent link">&para;</a></h3>
<h4 id="631">6.3.1 超时设置，故意设置超时演示出错情况<a class="headerlink" href="#631" title="Permanent link">&para;</a></h4>
<h5 id="1-8001">1.   服务提供方8001故意写暂停程序<a class="headerlink" href="#1-8001" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>@GetMapping(value = &quot;/payment/feign/timeout&quot;)
public String paymentFeignTimeout(){
    try { TimeUnit.SECONDS.sleep(3); }catch (Exception e) {e.printStackTrace();} //单位秒
    return serverPort;
}
</code></pre></div>
<h5 id="2-80paymentfeignservice">2.   服务消费方80添加超时方法PaymentFeignService<a class="headerlink" href="#2-80paymentfeignservice" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>@GetMapping(value = &quot;/payment/feign/timeout&quot;)
public String paymentFeignTimeout();
</code></pre></div>
<h5 id="3-80orderfeigncontroller">3.   服务消费方80添加超时方法OrderFeignController<a class="headerlink" href="#3-80orderfeigncontroller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>@GetMapping(value = &quot;/consumer/payment/feign/timeout&quot;)
public String paymentFeignTimeout(){
   return paymentFeignService.paymentFeignTimeout();
}
</code></pre></div>
<h5 id="4_4">4.   测试<a class="headerlink" href="#4_4" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost/consumer/payment/feign/timeout">http://localhost/consumer/payment/feign/timeout</a></p>
<p>错误页面，OpenFeign默认等待一秒钟，超过后报错</p>
<p><img alt="image-20201216194141365" src="../imgs/image-20201216194141365.png" /></p>
<h4 id="632">6.3.2 是什么<a class="headerlink" href="#632" title="Permanent link">&para;</a></h4>
<p>默认Feign客户端只等待一秒钟，但是，服务端处理需要超过1秒钟，导致Feign客户端不想等待了，直接报错。</p>
<p>为了避免这样的情况，有时候我们需要设置Feign客户端的超时控制，也即Ribbon的超时时间，因为Feign集成了Ribbon进行负载均衡。</p>
<h4 id="633-ymlopenfeign">6.3.3 YML中需要开启OpenFeign客户端超时控制<a class="headerlink" href="#633-ymlopenfeign" title="Permanent link">&para;</a></h4>
<p>Feign设置超时时间</p>
<p>使用Feign调用接口分两层，ribbon的调用和hystrix的调用，所以ribbon的超时时间和Hystrix的超时时间的结合就是Feign的超时时间</p>
<div class="highlight"><pre><span></span><code>#设置Feign客户端超时时间（openfeign默认支持ribbon）
ribbon:
  ReadTimeout:  3000
  ConnectTimeout: 3000
  MaxAutoRetries: 1 #同一台实例最大重试次数,不包括首次调用
  MaxAutoRetriesNextServer: 1 #重试负载均衡其他的实例最大重试次数,不包括首次调用
  OkToRetryOnAllOperations: false  #是否所有操作都重试
#hystrix的超时时间
hystrix:
  command:
    default:
      execution:
        timeout:
          enabled: true
        isolation:
          thread:
            timeoutInMilliseconds: 9000
</code></pre></div>
<p>一般情况下 都是 ribbon 的超时时间（&lt;）hystrix的超时时间（因为涉及到ribbon的重试机制）
 <strong>因为ribbon的重试机制和Feign的重试机制有冲突，所以源码中默认关闭Feign的重试机制，源码如下</strong></p>
<p><img alt="image-20201216194323368" src="../imgs/image-20201216194323368.png" /></p>
<p>要开启Feign的重试机制如下：（Feign默认重试五次 源码中有）</p>
<div class="highlight"><pre><span></span><code>@Bean
Retryer feignRetryer() {
        return  new Retryer.Default();
}
</code></pre></div>
<p>根据上面的参数计算重试的次数：MaxAutoRetries+MaxAutoRetriesNextServer+(MaxAutoRetries *MaxAutoRetriesNextServer) 即重试3次 则一共产生4次调用</p>
<p>如果在重试期间，时间超过了hystrix的超时时间，便会立即执行熔断，fallback。所以要根据上面配置的参数计算hystrix的超时时间，使得在重试期间不能达到hystrix的超时时间，不然重试机制就会没有意义</p>
<p>hystrix超时时间的计算： (1 + MaxAutoRetries + MaxAutoRetriesNextServer) * ReadTimeout 即按照以上的配置 hystrix的超时时间应该配置为 （1+1+1）*3=9秒</p>
<p>当ribbon超时后且hystrix没有超时，便会采取重试机制。当OkToRetryOnAllOperations设置为false时，只会对get请求进行重试。如果设置为true，便会对所有的请求进行重试，如果是put或post等写操作，如果服务器接口没做幂等性，会产生不好的结果，所以OkToRetryOnAllOperations慎用。</p>
<p>如果不配置ribbon的重试次数，默认会重试一次</p>
<p>注意：</p>
<p>默认情况下,GET方式请求无论是连接异常还是读取异常,都会进行重试</p>
<p>非GET方式请求,只有连接异常时,才会进行重试</p>
<h3 id="64-openfeign">6.4 OpenFeign日志打印功能<a class="headerlink" href="#64-openfeign" title="Permanent link">&para;</a></h3>
<h4 id="641">6.4.1 日志打印功能<a class="headerlink" href="#641" title="Permanent link">&para;</a></h4>
<h4 id="642">6.4.2 是什么<a class="headerlink" href="#642" title="Permanent link">&para;</a></h4>
<p>Feign提供了日志打印功能，我们可以通过配置来调整日志级别，从而了解Feign中Http请求的细节。说白了就是对Feign接口的调用情况进行监控和输出。</p>
<h4 id="643">6.4.3 日志级别<a class="headerlink" href="#643" title="Permanent link">&para;</a></h4>
<p>NONE：默认的，不显示任何日志</p>
<p>BASIC：仅记录请求方法、RUL、响应状态码及执行时间</p>
<p>HEADERS：除了BASIC中定义的信息之外，还有请求和响应的头信息</p>
<p>FULL：除了HEADERS中定义的信息之外，还有请求和响应的正文及元数据</p>
<h4 id="644-bean">6.4.4 配置日志bean<a class="headerlink" href="#644-bean" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.config;

import feign.Logger;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class FeignConfig {

    @Bean
    public Logger.Level feignLoggerLevel(){
        return Logger.Level.FULL;
    }
}
</code></pre></div>
<h4 id="645-ymlfeign">6.4.5 YML文件里需要开启日志的Feign客户端<a class="headerlink" href="#645-ymlfeign" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>logging:
  level:
    com.atguigu.springcloud.service.PaymentFeignService: debug
</code></pre></div>
<h4 id="646">6.4.6 后台日志查看<a class="headerlink" href="#646" title="Permanent link">&para;</a></h4>
<p><a href="http://localhost/consumer/payment/get/31">http://localhost/consumer/payment/get/31</a></p>
<p><img alt="image-20201216194617508" src="../imgs/image-20201216194617508.png" /></p>
<h2 id="7-hystrix">7. Hystrix断路器<a class="headerlink" href="#7-hystrix" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 概述<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<h4 id="711">7.1.1 分布式系统面临的问题<a class="headerlink" href="#711" title="Permanent link">&para;</a></h4>
<p>复杂分布式体系结构中的应用程序有数十个依赖关系，每一个依赖关系在某些时候将不可避免的失败。</p>
<p><img alt="image-20201216194930906" src="../imgs/image-20201216194930906.png" />                      </p>
<p>服务雪崩</p>
<p>多个微服务之间调用的时候，假如微服务A调用微服务B和微服务C，微服务B和微服务C又调用其他的微服务，这就是所谓的"扇出"。</p>
<p>如果扇出的链路上某个微服务的调用响应的时间过长或者不可用，对微服A的调用就会占用越来越多的系统资源，进而引起系统崩溃，所谓的"雪崩效应"。</p>
<p>对于高流量的应用来说，单一的后端依赖可能会导致所有的服务器上的所有资源都在几秒钟内饱和。比失败更糟糕的是，这些应用程序还可能导致服务之间的延迟增加，备份队列，线程和其他系统资源紧张，导致整个系统发生更多的级联故障。这些都表示需要对故障和延迟进行<strong>隔离和管理</strong>，以便单个依赖关系的失败，不能取消整个应用程序或系统。</p>
<p>所以，通常当你发现一个模块下的某个实例失败后，这时候这个模块依然还会接收流量，然后这个有问题的模块还调用了其他的模块，这样就会发生级联故障，或者叫雪崩。</p>
<h4 id="712">7.1.2 是什么<a class="headerlink" href="#712" title="Permanent link">&para;</a></h4>
<p>Hystrix是一个用于处理分布式系统的延迟和容错的开源库，在分布式系统里，许多依赖不可避免的会调用失败，比如超时、异常等，</p>
<p>Hystrix能够保证在一个依赖出问题的情况下，不会导致整体服务失败，避免级联故障，以提高分布式系统的弹性。</p>
<p>“断路器”本身是一种开关装置，当某个服务单元发生故障之后，通过断路器的故障监控（类似熔断保险丝），向调用方返回一个符合预期的、可处理的备选响应（Fallback），而不是长时间的等待或者抛出调用方无法处理的异常，这样就保证了服务调用方的线程不会被长时间、不必要地占用，从而避免了故障在分布式系统中的蔓延，乃至雪崩。</p>
<h4 id="713">7.1.3 能干嘛<a class="headerlink" href="#713" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>服务降级</p>
</li>
<li>
<p>服务熔断</p>
</li>
<li>
<p>接近实时的监控</p>
</li>
<li>
<p>。。。</p>
</li>
</ul>
<h4 id="714">7.1.4 官网资料<a class="headerlink" href="#714" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/Netflix/Hystrix/wiki/How-To-Use">https://github.com/Netflix/Hystrix/wiki/How-To-Use</a></p>
<h4 id="715-hystrix">7.1.5 Hystrix官宣，停更进维<a class="headerlink" href="#715-hystrix" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/Netflix/Hystrix">https://github.com/Netflix/Hystrix</a></p>
<p><img alt="image-20201216195117621" src="../imgs/image-20201216195117621.png" /></p>
<h3 id="72-hystrix">7.2 Hystrix重要概念<a class="headerlink" href="#72-hystrix" title="Permanent link">&para;</a></h3>
<h4 id="721-fallback">7.2.1 服务降级Fallback<a class="headerlink" href="#721-fallback" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>服务器忙，请稍候再试，不让客户端等待并立刻返回一个友好提示</p>
</li>
<li>
<p>哪些情况会触发降级</p>
</li>
<li>程序运行异常</li>
<li>超时自动降级</li>
<li>服务熔断触发服务降级</li>
<li>线程池/信号量打满也会导致服务降级</li>
<li>人工降级</li>
</ul>
<h4 id="722-breaker">7.2.2 服务熔断Breaker<a class="headerlink" href="#722-breaker" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>类比保险丝达到最大服务访问后，直接拒绝访问，拉闸限电，然后调用服务降级的方法并返回友好提示</p>
</li>
<li>
<p>就是保险丝</p>
</li>
<li>服务的降级-&gt;进而熔断-&gt;恢复调用链路</li>
</ul>
<h4 id="723-flowlimit">7.2.3 服务限流Flowlimit<a class="headerlink" href="#723-flowlimit" title="Permanent link">&para;</a></h4>
<p>秒杀高并发等操作，严禁一窝蜂的过来拥挤，大家排队，一秒钟N个，有序进行</p>
<h3 id="73-hystrix">7.3 hystrix案例<a class="headerlink" href="#73-hystrix" title="Permanent link">&para;</a></h3>
<h4 id="731">7.3.1 构建<a class="headerlink" href="#731" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloud-provider-hystrix-payment8001">1.   新建Module：cloud-provider-hystrix-payment8001<a class="headerlink" href="#1-modulecloud-provider-hystrix-payment8001" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_3">2.   POM<a class="headerlink" href="#2-pom_3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;artifactId&gt;cloud-provider-hystrix-payment8001&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;!--新增hystrix--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h5 id="3-yml_3">3.   YML<a class="headerlink" href="#3-yml_3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 8001

spring:
  application:
    name: cloud-hystrix-payment-service

eureka:
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: http://localhost:7001/eureka/
</code></pre></div>
<h5 id="4_5">4.   主启动<a class="headerlink" href="#4_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;

@SpringBootApplication
@EnableEurekaClient
public class PaymentHystrixMain8001 {
    public static void main(String[] args) {
        SpringApplication.run(PaymentHystrixMain8001.class,args);
    }
}
</code></pre></div>
<h5 id="5_4">5.   业务类<a class="headerlink" href="#5_4" title="Permanent link">&para;</a></h5>
<h6 id="serviceserviceimpl">Service/ServiceImpl<a class="headerlink" href="#serviceserviceimpl" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service;

public interface PaymentService {
    public String paymentInfo_OK(Integer id);
    public String payment_Timeout(Integer id);
}
package com.atguigu.springcloud.service.impl;

import org.springframework.stereotype.Service;
import java.util.concurrent.TimeUnit;

@Service
public class PaymentServiceImpl implements PaymentService {

    //成功
    public String paymentInfo_OK(Integer id){
        return &quot;线程池：&quot;+Thread.currentThread().getName()+&quot;   paymentInfo_OK,id：  &quot;+id+&quot;\t&quot;+&quot;哈哈哈&quot;  ;
    }

    //失败
    public String payment_Timeout(Integer id){
        int timeNumber = 3;
        try { TimeUnit.SECONDS.sleep(timeNumber); }catch (Exception e) {e.printStackTrace();}
        return &quot;线程池：&quot;+Thread.currentThread().getName()+&quot;   paymentInfo_TimeOut,id：  &quot;+id+&quot;\t&quot;+&quot;呜呜呜&quot;+&quot; 耗时(秒)&quot;+timeNumber;
    }
}
</code></pre></div>
<h6 id="controller">Controller<a class="headerlink" href="#controller" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.controller;

import com.atguigu.springcloud.service.PaymentService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import javax.annotation.Resource;

@RestController
@Slf4j
public class PaymentController {

    @Resource
    private PaymentService paymentService;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/payment/hystrix/ok/{id}&quot;)
    public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id){
        String result = paymentService.paymentInfo_OK(id);
        log.info(&quot;*******result:&quot;+result);
        return result;
    }
    @GetMapping(&quot;/payment/hystrix/timeout/{id}&quot;)
    public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id){
        String result = paymentService.paymentInfo_TimeOut(id);
        log.info(&quot;*******result:&quot;+result);
        return result;
    }
}
</code></pre></div>
<h5 id="6_1">6.   正常测试<a class="headerlink" href="#6_1" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>启动eureka7001</p>
</li>
<li>
<p>启动cloud-provider-hystrix-payment8001</p>
</li>
<li>
<p>访问</p>
</li>
</ul>
<p>访问： <a href="http://localhost:8001/payment/hystrix/ok/31">http://localhost:8001/payment/hystrix/ok/31</a></p>
<p>每次调用耗费3秒钟： <a href="http://localhost:8001/payment/hystrix/timeout/31">http://localhost:8001/payment/hystrix/timeout/31</a></p>
<ul>
<li>上述module均OK</li>
</ul>
<p>以上述为根基平台，从正确-&gt;错误-&gt;降级熔断-&gt;恢复</p>
<h4 id="732">7.3.2 高并发测试<a class="headerlink" href="#732" title="Permanent link">&para;</a></h4>
<h5 id="1-but">1. 上述在非高并发情形下，还能勉强满足  but.....<a class="headerlink" href="#1-but" title="Permanent link">&para;</a></h5>
<h5 id="2-jmeter">2. Jmeter压测测试<a class="headerlink" href="#2-jmeter" title="Permanent link">&para;</a></h5>
<p>下载地址：<a href="https://archive.apache.org/dist/jmeter/binaries/">https://archive.apache.org/dist/jmeter/binaries/</a></p>
<p>开启Jmeter，来20000个并发压死8001，20000个请求都去访问paymentInfo_TimeOut服务</p>
<p><img alt="image-20201216195730634" src="../imgs/image-20201216195730634.png" /></p>
<p><img alt="image-20201216195748255" src="../imgs/image-20201216195748255.png" /></p>
<ul>
<li>压测的过程中再来访问一下微服务</li>
</ul>
<p><a href="http://localhost:8001/payment/hystrix/ok/31">http://localhost:8001/payment/hystrix/ok/31</a></p>
<p><a href="http://localhost:8001/payment/hystrix/timeout/31">http://localhost:8001/payment/hystrix/timeout/31</a></p>
<ul>
<li>演示结果</li>
<li>两个都在自己转圈圈</li>
<li>为什么会被卡死</li>
</ul>
<p>tomcat的默认的工作线程数被打满了，没有多余的线程来分解压力和处理。</p>
<h5 id="3-jmeter">3.   Jmeter压测结论<a class="headerlink" href="#3-jmeter" title="Permanent link">&para;</a></h5>
<p>上面还是服务提供者8001自己测试，假如此时外部的消费者80也来访问，那消费者只能干等，最终导致消费端80不满意，服务端8001直接被拖死</p>
<h5 id="4-80cloud-consumer-feign-hystrix-order80">4.   看热闹不嫌弃事大，80新建加入：cloud-consumer-feign-hystrix-order80<a class="headerlink" href="#4-80cloud-consumer-feign-hystrix-order80" title="Permanent link">&para;</a></h5>
<h6 id="1-cloud-consumer-feign-hystrix-order80">1)  新建：cloud-consumer-feign-hystrix-order80<a class="headerlink" href="#1-cloud-consumer-feign-hystrix-order80" title="Permanent link">&para;</a></h6>
<h6 id="2-pom_4">2)  POM<a class="headerlink" href="#2-pom_4" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-consumer-feign-hystrix-order80&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;!--新增hystrix--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h6 id="3-yml_4">3)  YML<a class="headerlink" href="#3-yml_4" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>server:
  port: 80

spring:
  application:
    name: cloud-provider-hystrix-payment-service

eureka:
  client:
    register-with-eureka: true    #表识不向注册中心注册自己
    fetch-registry: true   #表示自己就是注册中心，职责是维护服务实例，并不需要去检索服务
    service-url:
      defaultZone: http://localhost:7001/eureka/
</code></pre></div>
<h6 id="4_6">4)  主启动<a class="headerlink" href="#4_6" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.openfeign.EnableFeignClients;

@SpringBootApplication
@EnableEurekaClient
@EnableFeignClients
public class OrderHystrixMain80 {
    public static void main(String[] args) {
        SpringApplication.run(OrderHystrixMain80.class,args);
    }
}
</code></pre></div>
<h6 id="5_5">5)  业务类<a class="headerlink" href="#5_5" title="Permanent link">&para;</a></h6>
<p><strong>PaymentHystrixService</strong> </p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service;

import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;

@FeignClient(&quot;CLOUD-HYSTRIX-PAYMENT-SERVICE&quot;)
public interface PaymentHystrixService {
    @GetMapping(&quot;/payment/hystrix/ok/{id}&quot;)
    public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id);

    @GetMapping(&quot;/payment/hystrix/timeout/{id}&quot;)
    public String payment_Timeout(@PathVariable(&quot;id&quot;) Integer id);
}
</code></pre></div>
<p><strong>OrderHystrixController</strong></p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.controller;

import com.atguigu.springcloud.service.PaymentHystrixService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import javax.annotation.Resource;

@RestController
@Slf4j
public class OrderHystrixController {
    @Resource
    private PaymentHystrixService paymentHystrixService;

    @GetMapping(&quot;/consumer/payment/hystrix/ok/{id}&quot;)
    public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id){
        String result = paymentHystrixService.paymentInfo_OK(id);
        log.info(&quot;*******result:&quot;+result);
        return result;
    }
    @GetMapping(&quot;/consumer/payment/hystrix/timeout/{id}&quot;)
    public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id){
        String result = paymentHystrixService.payment_Timeout(id);
        log.info(&quot;*******result:&quot;+result);
        return result;
    }

}
</code></pre></div>
<h6 id="6_2">6)  正常测试<a class="headerlink" href="#6_2" title="Permanent link">&para;</a></h6>
<p><a href="http://localhost/consumer/payment/hystrix/ok/32">http://localhost/consumer/payment/hystrix/ok/32</a></p>
<h6 id="7">7)  高并发测试<a class="headerlink" href="#7" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p>2W个线程压8001</p>
</li>
<li>
<p>消费端80微服务再去访问正常的OK微服务8001地址</p>
</li>
<li>
<p><a href="http://localhost/consumer/payment/hystrix/timeout/32">http://localhost/consumer/payment/hystrix/timeout/32</a></p>
</li>
<li>
<p>消费者80，呜呜呜</p>
</li>
<li>要么转圈圈等待</li>
<li>要么消费端报超时错误</li>
</ul>
<p><img alt="image-20201216200145192" src="../imgs/image-20201216200145192.png" /></p>
<h4 id="733">7.3.3 故障现象和导致原因<a class="headerlink" href="#733" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>8001同一层次的其他接口服务被困死，因为tomcat线程里面的工作线程已经被挤占完毕</p>
</li>
<li>
<p>80此时调用8001，客户端访问响应缓慢，转圈圈</p>
</li>
</ul>
<h4 id="734">7.3.4 上诉结论<a class="headerlink" href="#734" title="Permanent link">&para;</a></h4>
<ul>
<li>正因为有上述故障或不佳表现，才有我们的降级/容错/限流等技术诞生</li>
</ul>
<h4 id="735">7.3.5 如何解决？解决的要求<a class="headerlink" href="#735" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>超时导致服务器变慢（转圈）</p>
<p>超时不再等待</p>
</li>
<li>
<p>出错（宕机或程序运行出错）</p>
<p>出错要有兜底</p>
</li>
<li>
<p>解决</p>
</li>
<li>
<p>对方服务（8001）超时了，调用者（80）不能一直卡死等待，必须有服务降级</p>
</li>
<li>
<p>对方服务（8001）down机了，调用者（80）不能一直卡死等待，必须有服务降级</p>
</li>
<li>
<p>对方服务（8001）OK，调用者（80）自己出故障或有自我要求（自己的等待时间小于服务提供者），自己处理降级</p>
</li>
</ul>
<h4 id="736">7.3.6 服务降级<a class="headerlink" href="#736" title="Permanent link">&para;</a></h4>
<h5 id="1_1">1. 降低配置<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h5>
<p>@HystrixCommand</p>
<h5 id="2-8001">2.   8001先从自身找问题<a class="headerlink" href="#2-8001" title="Permanent link">&para;</a></h5>
<p>设置自身调用超时时间的峰值，峰值内可以正常运行，超过了需要有兜底的方法处理，作服务降级fallback</p>
<h5 id="3-8001fallback">3.   8001fallback<a class="headerlink" href="#3-8001fallback" title="Permanent link">&para;</a></h5>
<p>业务类启用阶级处理：使用@HystrixCommand注解来干活。</p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service.impl;

import com.atguigu.springcloud.service.PaymentService;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixProperty;
import org.springframework.stereotype.Service;
import java.util.concurrent.TimeUnit;

@Service
public class PaymentServiceImpl implements PaymentService {

    @Override
    public String paymentInfo_OK(Integer id) {
        return &quot;线程池：&quot;+Thread.currentThread().getName()+&quot; paymentInfo_OK,id=&quot;+id +&quot; \t O(∩_∩)O哈哈~&quot;;
    }

    //超时降级演示
    @HystrixCommand(fallbackMethod = &quot;payment_TimeoutHandler&quot;,commandProperties = {
            @HystrixProperty(name=&quot;execution.isolation.thread.timeoutInMilliseconds&quot;,value=&quot;5000&quot;) //5秒钟以内就是正常的业务逻辑
    })
    @Override
    public String payment_Timeout(Integer id) {
        //int timeNumber = 3; //小于等于3秒算是正常情况
        int timeNumber = 15; //模拟非正常情况
        //int i = 1/0 ; //模拟非正常情况
        try {
            TimeUnit.SECONDS.sleep(timeNumber);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return &quot;线程池：&quot;+Thread.currentThread().getName()+&quot; payment_Timeout,id=&quot;+id+&quot; \t o(╥﹏╥)o 耗时：&quot;+timeNumber;
    }

    //兜底方法，上面方法出问题,我来处理，返回一个出错信息
    public String payment_TimeoutHandler(Integer id) {
        return &quot;线程池：&quot;+Thread.currentThread().getName()+&quot; payment_TimeoutHandler,系统繁忙,请稍后再试\t o(╥﹏╥)o &quot;;
    }
}
</code></pre></div>
<p>一旦调用服务方法失败并抛出了错误信息后，会自动调用@HystrixCommand标注好的fallbackMethod调用类中的指定方法</p>
<p>主启动类激活</p>
<p>@EnableCircuitBreaker</p>
<p>测试超时和算数异常，都会走兜底方法——服务降级</p>
<p><a href="http://localhost:8001/payment/hystrix/timeout/1">http://localhost:8001/payment/hystrix/timeout/1</a></p>
<p><img alt="image-20201216200448015" src="../imgs/image-20201216200448015.png" /></p>
<h5 id="4-80fallback">4.   80fallback<a class="headerlink" href="#4-80fallback" title="Permanent link">&para;</a></h5>
<p>1)  80订单微服务，也可以更好的保护自己，自己也依样画葫芦进行客户端降级保护。注意：服务降级可以在服务提供者侧，也可以在服务消费者侧。更多是在服务消费者侧。</p>
<p>2)  题外话，切记</p>
<p>我们自己配置过的热部署方式对java代码的改动明显，但对@HystrixCommand内属性的修改建议重启微服务</p>
<p>3)  YML</p>
<div class="highlight"><pre><span></span><code>feign:
  hystrix:
    enabled: true #如果处理自身的容错就开启。开启方式与生产端不一样。  
</code></pre></div>
<p>4)  主启动</p>
<p>@EnableHystrix</p>
<p>5)  业务类：OrderHystrixController</p>
<div class="highlight"><pre><span></span><code>    //超时降级演示
    @HystrixCommand(fallbackMethod = &quot;payment_TimeoutHandler&quot;,commandProperties = {
            @HystrixProperty(name=&quot;execution.isolation.thread.timeoutInMilliseconds&quot;,value=&quot;1500&quot;)//超过1.5秒就降级自己
    })
    @GetMapping(&quot;/consumer/payment/hystrix/timeout/{id}&quot;)
    public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id){
        //int age= 1/0;
        String result = paymentHystrixService.payment_Timeout(id);
        log.info(&quot;*******result:&quot;+result);
        return result;
    }

    //兜底方法，上面方法出问题,我来处理，返回一个出错信息
    public String payment_TimeoutHandler(Integer id) {
        return &quot;我是消费者80,对方支付系统繁忙请10秒后再试。或自己运行出错，请检查自己。&quot;;
    }
</code></pre></div>
<p>6)  测试超时</p>
<p><a href="http://localhost/consumer/payment/hystrix/timeout/1">http://localhost/consumer/payment/hystrix/timeout/1</a></p>
<p><img alt="image-20201216200617249" src="../imgs/image-20201216200617249.png" /></p>
<h5 id="5_6">5.   目前问题<a class="headerlink" href="#5_6" title="Permanent link">&para;</a></h5>
<p>每个业务方法对应一个兜底的方法，代码膨胀，代码耦合</p>
<p>统一通用处理和自定义独立处理的分开</p>
<h5 id="6_3">6.   解决问题<a class="headerlink" href="#6_3" title="Permanent link">&para;</a></h5>
<h6 id="1_2">1)  每个方法配置一个？？？膨胀<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h6>
<p>feign接口系列</p>
<p>@DefaultProperties(defaultFallback = "")</p>
<p><img alt="image-20201216200647985" src="../imgs/image-20201216200647985.png" /></p>
<p>说明</p>
<p>@DefaultProperties(defaultFallback = "")</p>
<p>1:1 每个方法配置一个服务降级方法，技术上可以，但实际上傻X</p>
<p>1:N 除了个别重要核心业务有专属，其它普通的可以通过@DefaultProperties(defaultFallback = "")统一跳转到统一处理结果页面</p>
<p>通用的和独享的各自分开，避免了代码膨胀，合理减少了代码量</p>
<p>controller配置</p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.controller;

import com.atguigu.springcloud.service.PaymentHystrixService;
import com.netflix.hystrix.contrib.javanica.annotation.DefaultProperties;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixProperty;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import javax.annotation.Resource;

@RestController
@Slf4j
@DefaultProperties(defaultFallback = &quot;payment_Global_FallbackMethod&quot;)  //全局的
public class OrderHystrixController {

    @Resource
    private PaymentHystrixService paymentHystrixService;

    @GetMapping(&quot;/consumer/payment/hystrix/ok/{id}&quot;)
    public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id){
        String result = paymentHystrixService.paymentInfo_OK(id);
        return result;
    }

    @HystrixCommand
    public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id){
        int age = 10/0;
        String result = paymentHystrixService.paymentInfo_TimeOut(id);
        return result;
    }

    //兜底方法
    public String paymentTimeOutFallbackMethod(@PathVariable(&quot;id&quot;) Integer id){
        return &quot;我是消费者80，对付支付系统繁忙请10秒钟后再试或者自己运行出错请检查自己,(┬＿┬)&quot;;
    }

    //下面是全局fallback方法
    public String payment_Global_FallbackMethod(){
        return &quot;Global异常处理信息，请稍后再试,(┬＿┬)&quot;;
    }
}
</code></pre></div>
<p>测试结果</p>
<p><img alt="image-20201216200822987" src="../imgs/image-20201216200822987.png" /></p>
<h6 id="2_3">2)  和业务逻辑混一起？？？混乱<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h6>
<p>服务降级，客户端去调用服务端，碰上服务端宕机或关闭</p>
<p>本次案例服务降级处理是在客户端80实现完成的，与服务端8001没有关系，只需要为Feign客户端定义的接口添加一个服务降级处理的实现类即可实现解耦</p>
<p>未来我们要面对的异常</p>
<ul>
<li>
<p>运行</p>
</li>
<li>
<p>超时</p>
</li>
<li>
<p>宕机</p>
</li>
</ul>
<p>再看我们的业务类PaymentController</p>
<p>修改cloud-consumer-feign-hystrix-order80</p>
<p>根据cloud-consumer-feign-hystrix-order80已经有的PaymentHystrixService接口，重新新建一个类（PaymentFallbackService）实现该接口，统一为接口里面的方法进行异常处理</p>
<p>PaymentFallbackService类实现PaymentFeignClientService接口</p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service;

import org.springframework.stereotype.Component;

@Component
public class PaymentFallbackService implements PaymentHystrixService {
    @Override
    public String paymentInfo_OK(Integer id) {
        return &quot;-----PaymentFallbackService fall back-paymentInfo_OK , (┬＿┬)&quot;;
    }

    @Override
    public String paymentInfo_TimeOut(Integer id) {
        return &quot;-----PaymentFallbackService fall back-paymentInfo_TimeOut , (┬＿┬)&quot;;
    }
}
</code></pre></div>
<p>YML</p>
<div class="highlight"><pre><span></span><code>feign:
  hystrix:
    enabled: true #如果处理自身的容错就开启。开启方式与生产端不一样。
</code></pre></div>
<p>PaymentFeignClientService接口</p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.service;

import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.stereotype.Component;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;

@Component
@FeignClient(value = &quot;CLOUD-PROVIDER-HYSTRIX-PAYMENT&quot;,fallback = PaymentFallbackService.class)
public interface PaymentHystrixService {

    @GetMapping(&quot;/payment/hystrix/ok/{id}&quot;)
    public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id);

    @GetMapping(&quot;/payment/hystrix/timeout/{id}&quot;)
    public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id);
}
</code></pre></div>
<h6 id="3_1">3)  测试<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h6>
<p>单个eureka先启动7001</p>
<p>PaymentHystrixMain8001启动</p>
<p>正常访问测试：<a href="http://localhost/consumer/payment/hystrix/ok/31">http://localhost/consumer/payment/hystrix/ok/31</a></p>
<p>故意关闭微服务8001</p>
<p>客户端自己调用提升</p>
<p>此时服务端provider已经down了，但是我们做了服务降级处理，让客户端在服务端不可用时也会获得提示信息而不会挂起耗死服务器</p>
<h4 id="737">7.3.7 服务熔断<a class="headerlink" href="#737" title="Permanent link">&para;</a></h4>
<h5 id="1_3">1.   断路器<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h5>
<p>一句话就是家里保险丝</p>
<h5 id="2_4">2.   熔断是什么<a class="headerlink" href="#2_4" title="Permanent link">&para;</a></h5>
<p>熔断机制概述</p>
<p>熔断机制是应对雪崩效应的一种微服务链路保护机制。当扇出链路的某个微服务出错不可用或者响应时间太长时，会进行服务的降级，进而熔断该节点微服务的调用，快速返回错误的响应信息。</p>
<p>当检测到该节点微服务调用响应正常后，恢复调用链路。</p>
<p>在SpringCloud框架里，熔断机制通过Hystrix实现。Hystrix会监控微服务间调用的状态，当失败的调用到一定阈值，缺省是5秒内20次调用失败，就会启动熔断机制。熔断机制的注解是@HystrixCommand</p>
<h5 id="3_2">3.   大神论文：<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h5>
<p><a href="https://martinfowler.com/bliki/CircuitBreaker.html">https://martinfowler.com/bliki/CircuitBreaker.html</a></p>
<p><img alt="image-20201216201058572" src="../imgs/image-20201216201058572.png" /></p>
<h5 id="4_7">4.   实操<a class="headerlink" href="#4_7" title="Permanent link">&para;</a></h5>
<h6 id="1-cloud-provider-hystrix-payment8001">1)  修改cloud-provider-hystrix-payment8001<a class="headerlink" href="#1-cloud-provider-hystrix-payment8001" title="Permanent link">&para;</a></h6>
<h6 id="2-paymentserviceimpl_1">2)  PaymentServiceImpl<a class="headerlink" href="#2-paymentserviceimpl_1" title="Permanent link">&para;</a></h6>
<p>com.netflix.hystrix.HystrixCommandProperties</p>
<div class="highlight"><pre><span></span><code>//服务熔断
@HystrixCommand(fallbackMethod = &quot;paymentCircuitBreaker_fallback&quot;,commandProperties = {
        @HystrixProperty(name = &quot;circuitBreaker.enabled&quot;,value = &quot;true&quot;),  //是否开启断路器
        @HystrixProperty(name = &quot;circuitBreaker.requestVolumeThreshold&quot;,value = &quot;10&quot;),   //当在配置时间窗口内达到此数量的失败后，打开断路，默认20个
        @HystrixProperty(name = &quot;circuitBreaker.sleepWindowInMilliseconds&quot;,value = &quot;10000&quot;),  //断路多久以后开始尝试是否恢复，默认5s
        @HystrixProperty(name = &quot;circuitBreaker.errorThresholdPercentage&quot;,value = &quot;60&quot;), //出错百分比阈值，当达到此阈值后，开始短路。默认50%
})
public String paymentCircuitBreaker(Integer id){
    if (id &lt; 0){
        throw new RuntimeException(&quot;*****id 不能负数&quot;);
    }
    String serialNumber = IdUtil.simpleUUID();//hutool.cn工具包

    return Thread.currentThread().getName()+&quot;\t&quot;+&quot;调用成功,流水号：&quot;+serialNumber;
}
public String paymentCircuitBreaker_fallback(@PathVariable(&quot;id&quot;) Integer id){
    return &quot;id 不能负数，请稍候再试,(┬＿┬)/~~     id: &quot; +id;
}
</code></pre></div>
<h6 id="3-paymentcontroller">3)  PaymentController<a class="headerlink" href="#3-paymentcontroller" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>//===服务熔断
@GetMapping(&quot;/payment/circuit/{id}&quot;)
public String paymentCircuitBreaker(@PathVariable(&quot;id&quot;) Integer id){
    String result = paymentService.paymentCircuitBreaker(id);
    log.info(&quot;*******result:&quot;+result);
    return result;
}
</code></pre></div>
<h6 id="4_8">4)  测试<a class="headerlink" href="#4_8" title="Permanent link">&para;</a></h6>
<p>自测cloud-provider-hystrix-payment8001</p>
<p>正确： <a href="http://localhost:8001/payment/circuit/31">http://localhost:8001/payment/circuit/31</a></p>
<p>错误： <a href="http://localhost:8001/payment/circuit/-31">http://localhost:8001/payment/circuit/-31</a></p>
<p>一次正确一次错误trytry</p>
<p>重点测试</p>
<p>多次错误（狂点），然后慢慢正确，发现刚开始不满足条件，就算是正确的访问地址也不能进行访问，需要慢慢的恢复链路</p>
<h5 id="5_7">5.   原理（小总结）<a class="headerlink" href="#5_7" title="Permanent link">&para;</a></h5>
<h5 id="1_4">1)  大神结论<a class="headerlink" href="#1_4" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216201217770" src="../imgs/image-20201216201217770.png" /></p>
<h5 id="2_5">2)  熔断类型<a class="headerlink" href="#2_5" title="Permanent link">&para;</a></h5>
<p><strong>熔断打开</strong></p>
<p>请求不再进行调用当前服务，内部设置时钟一般为MTTR(平均故障处理时间)，当打开时长达到所设时钟则进入熔断状态</p>
<p><strong>熔断关闭</strong></p>
<p>熔断关闭不会对服务进行熔断</p>
<p><strong>熔断半开</strong></p>
<p>部分请求根据规则调用当前服务，如果请求成功且符合规则则认为当前服务恢复正常，<strong>关闭熔断</strong></p>
<h5 id="3_3">3)  官网断路器流程图<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h5>
<h6 id="1_5">①  官网步骤<a class="headerlink" href="#1_5" title="Permanent link">&para;</a></h6>
<h6 id="2_6">②  断路器在什么情况下开始起作用<a class="headerlink" href="#2_6" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>  //服务熔断

@HystrixCommand(fallbackMethod = &quot;paymentCircuitBreaker_fallback&quot;,commandProperties = {

@HystrixProperty(name = &quot;circuitBreaker.enabled&quot;,value = &quot;true&quot;), //是否开启断路器

@HystrixProperty(name = &quot;circuitBreaker.requestVolumeThreshold&quot;,value = &quot;20&quot;),  //当快照时间窗（默认10秒）内达到此数量才有资格打开断路，默认20个

@HystrixProperty(name = &quot;circuitBreaker.sleepWindowInMilliseconds&quot;,value = &quot;50000&quot;), //断路多久以后开始尝试是否恢复，默认5s

@HystrixProperty(name = &quot;circuitBreaker.errorThresholdPercentage&quot;,value = &quot;50&quot;), //出错百分比阈值，当达到此阈值后，开始短路。默认50%

})
</code></pre></div>
<p>涉及到断路器的三个重要参数：<strong>快照时间窗、请求总数阈值、错误百分比阈值。</strong></p>
<p>1、快照时间窗：断路器确定是否打开需要统计一些请求和错误数据，而统计的时间范围就是快照时间窗，默认为最近的10秒。</p>
<p>2、请求总数阈值：在快照时间窗内，必须满足请求总数阈值才有资格熔断。默认20，意味着在10秒内，如果该hystrix命令的调用次数不足20次，即使所有的请求都超时或其他原因失败，断路器都不会打开。</p>
<p>3、错误百分比阈值：当请求总数在快照时间窗内超过了阈值，比如发生了30次调用，如果在这30次调用，有15次发生了超时异常，也就是超过50%的错误百分比，在默认设定50%阈值情况下，这时候就会将断路器打开。</p>
<h6 id="3_4">③断路器开启或者关闭的条件<a class="headerlink" href="#3_4" title="Permanent link">&para;</a></h6>
<p>当满足一定阀值的时候（默认10秒内超过20个请求次数）</p>
<p>当失败率达到一定的时候（默认10秒内超过50%请求失败）</p>
<p>到达以上阀值，断路器将会开启</p>
<p>当开启的时候，所有请求都不会进行转发</p>
<p>一段时间之后（默认是5秒），这个时候断路器是半开状态，会让其中一个请求进行转发。如果成功，断路器会关闭，若失败，继续开启。重复4和5</p>
<h6 id="4_9">④  断路器打开之后<a class="headerlink" href="#4_9" title="Permanent link">&para;</a></h6>
<p>1：再有请求调用的时候，将不会调用主逻辑，而是直接调用降级fallbak。通过断路器，实现了自动地发现错误并将降级逻辑切换为主逻辑，减少响应延迟的效果。</p>
<p>2：原来的主逻辑要如何恢复呢？</p>
<p>对于这一个问题，hystrix也为我们实现了自动恢复功能。</p>
<p>当断路器打开，对主逻辑进行熔断之后，hystrix会启动一个休眠时间窗，在这个时间窗内，降级逻辑是临时的成为主逻辑，当休眠时间窗到期，断路器将进入半开状态，释放一次请求到原来的主逻辑上，如果此次请求正常返回，那么断路器将继续闭合，主逻辑恢复，如果这次请求依然有问题，断路器继续进入打开状态，休眠时间窗重新计时。</p>
<h6 id="5-all">⑤  All配置<a class="headerlink" href="#5-all" title="Permanent link">&para;</a></h6>
<p><img alt="image-20201216201342082" src="../imgs/image-20201216201342082.png" /></p>
<h4 id="738">7.3.8 服务限流<a class="headerlink" href="#738" title="Permanent link">&para;</a></h4>
<p>后面讲</p>
<h3 id="74-hystrixdashboard">7.4 服务监控hystrixDashboard<a class="headerlink" href="#74-hystrixdashboard" title="Permanent link">&para;</a></h3>
<h4 id="741">7.4.1 概述<a class="headerlink" href="#741" title="Permanent link">&para;</a></h4>
<p>除了隔离依赖服务的调用以外，Hystrix还提供了准实时的调用监控(Hystrix Dashboard)，Hystrix会持续地记录所有通过Hystrix发起的请求的执行信息，并以统计报表和图形的形式展示给用户，包括每秒执行多少请求多少成功，多少失败等。Netflix通过hystrix-metrics-event-stram项目实现了对以上指示的监控。Spring Cloud也提供了Hystrix Dashboard的整合，对监控内容转化成可视化界面。</p>
<h4 id="742-9001">7.4.2 仪表盘9001<a class="headerlink" href="#742-9001" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloud-consumer-hystrix-dashboard9001">1. 新建Module：cloud-consumer-hystrix-dashboard9001<a class="headerlink" href="#1-modulecloud-consumer-hystrix-dashboard9001" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_5">2. POM<a class="headerlink" href="#2-pom_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-consumer-hystrix-dashboard9001&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;!--新增hystrix dashboard--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h5 id="3-yml_5">3.   YML<a class="headerlink" href="#3-yml_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 9001
</code></pre></div>
<h5 id="4-hystrixdashboardmain9001enablehystrixdashboard">4.   HystrixDashboardMain9001+新注解@EnableHystrixDashboard<a class="headerlink" href="#4-hystrixdashboardmain9001enablehystrixdashboard" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.hystrix.dashboard.EnableHystrixDashboard;

@SpringBootApplication
@EnableHystrixDashboard
public class HystrixDashboardMain9001 {
    public static void main(String[] args) {
        SpringApplication.run(HystrixDashboardMain9001.class,args);
    }
}
</code></pre></div>
<h5 id="5-provider800180028003">5.   所有Provider微服务提供类（8001/8002/8003）都需要监控依赖配置<a class="headerlink" href="#5-provider800180028003" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="6-cloud-consumer-hystrix-dashboard90018001">6.   启动cloud-consumer-hystrix-dashboard9001该微服务后续将监控微服务8001<a class="headerlink" href="#6-cloud-consumer-hystrix-dashboard90018001" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost:9001/hystrix">http://localhost:9001/hystrix</a></p>
<p><img alt="image-20201216201600454" src="../imgs/image-20201216201600454.png" /></p>
<h4 id="743">7.4.3 断路器演示<a class="headerlink" href="#743" title="Permanent link">&para;</a></h4>
<h5 id="1-cloud-provider-hystrix-payment8001_1">1.   修改cloud-provider-hystrix-payment8001<a class="headerlink" href="#1-cloud-provider-hystrix-payment8001_1" title="Permanent link">&para;</a></h5>
<p>注意：新版本Hystrix需要在主启动类MainAppHystrix8001中指定监控路径</p>
<div class="highlight"><pre><span></span><code>/**
 *此配置是为了服务监控而配置，与服务容错本身无关，springcloud升级后的坑
 *ServletRegistrationBean因为springboot的默认路径不是&quot;/hystrix.stream&quot;，
 *只要在自己的项目里配置上下面的servlet就可以了
 */
@Bean
public ServletRegistrationBean getServlet() {
HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet();
ServletRegistrationBean registrationBean = new ServletRegistrationBean(streamServlet);
registrationBean.setLoadOnStartup(1);
registrationBean.addUrlMappings(&quot;/hystrix.stream&quot;);
registrationBean.setName(&quot;HystrixMetricsStreamServlet&quot;);
return registrationBean;
}
</code></pre></div>
<p>Unable to connect to Command Metric Stream</p>
<p>404</p>
<h5 id="2_7">2.   监控测试<a class="headerlink" href="#2_7" title="Permanent link">&para;</a></h5>
<h6 id="1-1eureka">1)  启动1个eureka<a class="headerlink" href="#1-1eureka" title="Permanent link">&para;</a></h6>
<h6 id="2_8">2)  观察监控窗口<a class="headerlink" href="#2_8" title="Permanent link">&para;</a></h6>
<p>9001监控8001</p>
<p><a href="http://localhost:9001/hystrix">http://localhost:9001/hystrix</a></p>
<p><a href="http://localhost:8001/hystrix.stream">http://localhost:8001/hystrix.stream</a></p>
<p><img alt="image-20201216201701733" src="../imgs/image-20201216201701733.png" /></p>
<p>测试地址</p>
<p><a href="http://localhost:8001/payment/circuit/31">http://localhost:8001/payment/circuit/31</a></p>
<p><a href="http://localhost:8001/payment/circuit/-31">http://localhost:8001/payment/circuit/-31</a></p>
<p>上述测试通过</p>
<p>ok</p>
<p>先访问正确地址，再访问错误地址，再正确地址，会发现图示断路器都是慢慢放开的</p>
<p>监控结果，成功</p>
<p><img alt="image-20201216201721543" src="../imgs/image-20201216201721543.png" /></p>
<p>监控结果，失败</p>
<p><img alt="image-20201216201738225" src="../imgs/image-20201216201738225.png" /></p>
<p>如何看</p>
<p>7色</p>
<p><img alt="image-20201216201753001" src="../imgs/image-20201216201753001.png" /></p>
<p>1圈</p>
<p>实心圆：共有两种含义。它通过颜色的变化代表了实例的健康程度，它的健康度从绿色&lt;黄色&lt;橙色&lt;红色递减。</p>
<p>该实心圆除了颜色的变化之外，它的大小也会根据实例的请求流量发生变化，流量越大该实心圆就越大。所以通过该实心圆的展示，就可以在大量的实体中快速的发现故障实例和高压力实例。</p>
<p>1线</p>
<p>曲线：用来记录2分钟内流量的相对变化，可以通过它来观察到流量的上升和下降趋势。</p>
<p><strong>整图说明</strong></p>
<p><img alt="image-20201216201819373" src="../imgs/image-20201216201819373.png" /></p>
<p><strong>整图说明2</strong></p>
<p><img alt="image-20201216201833837" src="../imgs/image-20201216201833837.png" /></p>
<p><strong>搞懂一个才能看懂复杂的</strong></p>
<p><img alt="image-20201216201849842" src="../imgs/image-20201216201849842.png" /></p>
<h2 id="8-gateway">8. Gateway新一代网关<a class="headerlink" href="#8-gateway" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 概述简介<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<h4 id="811">8.1.1 官网<a class="headerlink" href="#811" title="Permanent link">&para;</a></h4>
<p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/">https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/</a></p>
<p><img alt="image-20201216201947012" src="../imgs/image-20201216201947012.png" /></p>
<h4 id="812">8.1.2 是什么<a class="headerlink" href="#812" title="Permanent link">&para;</a></h4>
<p>Cloud全家桶中有个很重要的组件就是网关，在1.x版本中都是采用的Zuul网关https://github.com/Netflix/zuul/wiki</p>
<p>但在2.x版本中，zuul的升级一直跳票，SpringCloud最后自己研发了一个网关代替Zull，那就是SpringCloud Geteway； </p>
<h5 id="8121-getewayzuul1x">8.1.2.1 一句话：Geteway是原Zuul1.x版的替代<a class="headerlink" href="#8121-getewayzuul1x" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216202032865" src="../imgs/image-20201216202032865.png" /></p>
<h5 id="8122">8.1.2.2 概述<a class="headerlink" href="#8122" title="Permanent link">&para;</a></h5>
<p>Gateway是在spring生态系统之上构建的API网关服务，基于Spring5，SpringBoot2和Project Reactor等技术。</p>
<p>Gateway旨在提供一种简单而有效的方式来对API进行路由，以及提供一些强大的过滤器功能，例如：熔断、限流、重试等</p>
<p><img alt="image-20201216202102177" src="../imgs/image-20201216202102177.png" /></p>
<p>SpringCloud Gateway是SpringCloud的一个全新项目，基于Spring5.0+SpringBoot2.0和Project Reactor等技术开发的网关，它旨在为微服务架构提供一种简单有效的统一的API路由管理方式。</p>
<p>为了提升网关的性能，SpringCloud Gatway是基于WebFlux框架实现的，而WebFlux框架底层则使用了高性能的<strong>Reactor</strong>模式通讯框架<strong>Netty</strong>。</p>
<p>SpringCloud Gateway的目标提供统一的路由方式且基于Filter链的方式提供了网关基本的功能，例如：安全、监控/指标、和限流。</p>
<h5 id="8123">8.1.2.3 一句话<a class="headerlink" href="#8123" title="Permanent link">&para;</a></h5>
<p>Spring Cloud Gateway 使用的Webflux中的reactor-netty响应式编程组件，底层使用了Netty通讯框架</p>
<p>源码架构</p>
<p><img alt="image-20201216202133726" src="../imgs/image-20201216202133726.png" /></p>
<h4 id="813">8.1.3 能干嘛<a class="headerlink" href="#813" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>反向代理</p>
</li>
<li>
<p>鉴权</p>
</li>
<li>
<p>流量控制</p>
</li>
<li>
<p>熔断</p>
</li>
<li>
<p>日志监控</p>
</li>
<li>
<p>。。。。。。</p>
</li>
</ul>
<h4 id="814">8.1.4 微服务架构中网关在哪里<a class="headerlink" href="#814" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216202214866" src="../imgs/image-20201216202214866.png" /></p>
<h3 id="82">8.2 三大核心概念<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<h4 id="821-route">8.2.1 Route(路由)<a class="headerlink" href="#821-route" title="Permanent link">&para;</a></h4>
<p>路由是构建网关的基本模块，它由ID，目标URI，一系列的断言和过滤器组成，如果断言为true则匹配该路由</p>
<h4 id="822-predicate">8.2.2 Predicate（断言）<a class="headerlink" href="#822-predicate" title="Permanent link">&para;</a></h4>
<p>参考的是java8的java.util.function.Predicate开发人员可以匹配HTTP请求中的所有内容（例如请求头或请求参数），如果请求与断言相匹配则进行路由</p>
<h4 id="823-filter">8.2.3 Filter(过滤)<a class="headerlink" href="#823-filter" title="Permanent link">&para;</a></h4>
<p>指的是Spring框架中GatewayFilter的实例，使用过滤器，可以在请求被路由前或者之后对请求进行修改。</p>
<h4 id="224">2.2.4.    总体<a class="headerlink" href="#224" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216202323128" src="../imgs/image-20201216202323128.png" /></p>
<p>Web请求，通过一些匹配条件，定位到真正的服务节点。并在这个转发过程的前后，进行一些精细化控制。</p>
<p>Predicate就是我们的匹配条件： 而Filter，就是可以理解为一个无所不能的拦截器。有了这两个元素，再加上目标uri,就可以实现一个具体的路由了。</p>
<h3 id="23-gateway">2.3. Gateway工作流程<a class="headerlink" href="#23-gateway" title="Permanent link">&para;</a></h3>
<h4 id="231_1">2.3.1.    官网总结<a class="headerlink" href="#231_1" title="Permanent link">&para;</a></h4>
<p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gateway-how-it-works">https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gateway-how-it-works</a></p>
<p><img alt="image-20201216202349363" src="../imgs/image-20201216202349363.png" /></p>
<p><img alt="image-20201216202404138" src="../imgs/image-20201216202404138.png" /></p>
<p>客户端向Spring Cloud Gateway发出请求。然后在Gateway Handler Mapping中找到与请求匹配的路由，将其发送到Gateway Web Handler.</p>
<p>Handler再通过指定的过滤器链来将请求发送给我们实际的服务执行业务逻辑，然后返回。</p>
<p>过滤器之间用虚线分开是因为过滤器可能会在发送代理请求之前（"pre"）或之后("post")执行业务逻辑。</p>
<p>Filter在"pre"类型的过滤器可以做参数校验、权限校验、流量监控、日志输出、协议转换等，在"post"类型的过滤器中可以做响应内容、响应头的修改，日志的输出，流量控制等有着非常重要的作用</p>
<h4 id="832">8.3.2 核心逻辑：路由转发+执行过滤器链<a class="headerlink" href="#832" title="Permanent link">&para;</a></h4>
<h3 id="84">8.4 入门配置<a class="headerlink" href="#84" title="Permanent link">&para;</a></h3>
<h4 id="841-modulecloud-gateway-gateway9527">8.4.1 新建Module：cloud-gateway-gateway9527<a class="headerlink" href="#841-modulecloud-gateway-gateway9527" title="Permanent link">&para;</a></h4>
<h4 id="842-pom">8.4.2 POM<a class="headerlink" href="#842-pom" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloud-gateway-gateway9527&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;!--新增gateway，不需要引入web和actuator模块--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h4 id="843-yml">8.4.3 YML<a class="headerlink" href="#843-yml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 9527
spring:
  application:
    name: cloud-gateway

eureka:
  instance:
    hostname: cloud-gateway-service
  client:
      register-with-eureka: true
      fetch-registry: true
      service-url:
          defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h4 id="844">8.4.4 业务类<a class="headerlink" href="#844" title="Permanent link">&para;</a></h4>
<p>无</p>
<h4 id="845">8.4.5 主启动类<a class="headerlink" href="#845" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.EnableEurekaClient;

@SpringBootApplication
@EnableEurekaClient
public class GateWayMain9527 {
    public static void main(String[] args) {
            SpringApplication.run( GateWayMain9527.class,args);
        }
}
</code></pre></div>
<h4 id="846-9527">8.4.6 9527网关如何做路由映射呢？？？<a class="headerlink" href="#846-9527" title="Permanent link">&para;</a></h4>
<p>我们目前不想暴露8001端口，希望在8001外面套一层9527</p>
<h4 id="847-yml">8.4.7 YML新增网关配置<a class="headerlink" href="#847-yml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
      routes:
       - id: payment_routh #路由的ID，没有固定规则但要求唯一，建议配合服务名
         uri: http://localhost:8001   #匹配后提供服务的路由地址
         predicates:
           - Path=/payment/get/**   #断言,路径相匹配的进行路由

       - id: payment_routh2
         uri: http://localhost:8001
         predicates:
           - Path=/payment/lb/**   #断言,路径相匹配的进行路由

eureka:
  instance:
    hostname: cloud-gateway-service
  client:
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h4 id="848">8.4.8 测试<a class="headerlink" href="#848" title="Permanent link">&para;</a></h4>
<p>启动7001：cloud-eureka-server7001</p>
<p>启动8001：cloud-provider-payment8001</p>
<p>启动9527网关：cloud-gateway-gateway9527</p>
<p>访问说明</p>
<p><img alt="image-20201216202902326" src="../imgs/image-20201216202902326.png" /></p>
<p>添加网关前： <a href="http://localhost:8001/payment/get/31">http://localhost:8001/payment/get/31</a></p>
<p>添加网关后： <a href="http://localhost:9527/payment/get/31">http://localhost:9527/payment/get/31</a></p>
<h3 id="85">8.5 通过微服务名实现动态路由<a class="headerlink" href="#85" title="Permanent link">&para;</a></h3>
<p>默认情况下Gateway会根据注册中心的服务列表，以注册中心上微服务名为路径创建动态路由进行转发，从而实现动态路由的功能</p>
<h4 id="851">8.5.1 启动<a class="headerlink" href="#851" title="Permanent link">&para;</a></h4>
<p>一个eureka7001+两个服务提供者8001/8002</p>
<h4 id="852-pom">8.5.2 POM<a class="headerlink" href="#852-pom" title="Permanent link">&para;</a></h4>
<h4 id="853-yml">8.5.3 YML<a class="headerlink" href="#853-yml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true  #开启从注册中心动态创建路由的功能，利用微服务名进行路由
      routes:
        - id: payment_routh #路由的ID，没有固定规则但要求唯一，建议配合服务名
          #uri: http://localhost:8001   #匹配后提供服务的路由地址
          uri: lb://cloud-payment-service
          predicates:
            - Path=/payment/get/**   #断言,路径相匹配的进行路由

        - id: payment_routh2
          #uri: http://localhost:8001   #匹配后提供服务的路由地址
          uri: lb://cloud-payment-service
          predicates:
            - Path=/payment/lb/**   #断言,路径相匹配的进行路由

eureka:
  instance:
    hostname: cloud-gateway-service
  client:
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<p>需要注意的是uri的协议为lb，表示启用Gateway的负载均衡功能。</p>
<p>lb://serviceName是spring cloud gateway在微服务中自动为我们创建的负载均衡uri</p>
<h4 id="854">8.5.4 测试<a class="headerlink" href="#854" title="Permanent link">&para;</a></h4>
<p><a href="http://localhost:9527/payment/lb">http://localhost:9527/payment/lb</a></p>
<p>8001/8002两个端口切换</p>
<h3 id="86-predicate">8.6 Predicate的使用<a class="headerlink" href="#86-predicate" title="Permanent link">&para;</a></h3>
<h4 id="861">8.6.1 是什么<a class="headerlink" href="#861" title="Permanent link">&para;</a></h4>
<p>启动我们的gatewat9527，查看启动日志</p>
<p><img alt="image-20201216203100137" src="../imgs/image-20201216203100137.png" /></p>
<h4 id="862-route-predicate-factories">8.6.2 Route Predicate Factories这个是什么东东？<a class="headerlink" href="#862-route-predicate-factories" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216203126873" src="../imgs/image-20201216203126873.png" /></p>
<p>Spring Cloud Gateway将路由匹配作为Spring WebFlux HandlerMapper基础框架的一部分。</p>
<p>Spring Cloud Gateway包括许多内置的Route Predicate工厂。所有这些Predicate都与HTTP请求的不同属性匹配。多个Route Predicate工厂可以进行组合</p>
<p>Spring Cloud Gateway创建Route对象时，使用RoutePredicateFactory创建Predicate对象，Predicate对象可以赋值给 Route。Spring Cloud Gateway包含许</p>
<p>多内置的Route Predicate Factories。</p>
<p>所有这些谓词都匹配HTTP请求的不同属性。多种谓词工厂可以组合，并通过逻辑and 。</p>
<h4 id="863-route-predicate">8.6.3 常用的Route Predicate<a class="headerlink" href="#863-route-predicate" title="Permanent link">&para;</a></h4>
<h5 id="1after-route-predicate">1.After Route Predicate<a class="headerlink" href="#1after-route-predicate" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216203203060" src="../imgs/image-20201216203203060.png" /></p>
<p>ZonedDateTime zonedDateTime = ZonedDateTime.now();</p>
<p>System.out.println(zonedDateTime);</p>
<ul>
<li>
<p>After=2020-03-08T10:59:34.102+08:00[Asia/Shanghai]</p>
</li>
<li>
<p>测试：没到时间进行测试报错</p>
</li>
</ul>
<p><img alt="image-20201216203244801" src="../imgs/image-20201216203244801.png" /></p>
<h5 id="2before-route-predicate">2.Before Route Predicate<a class="headerlink" href="#2before-route-predicate" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>YML</p>
</li>
<li>
<p>Before=2020-03-08T10:59:34.102+08:00[Asia/Shanghai]</p>
</li>
</ul>
<h5 id="3between-route-predicate">3.Between Route Predicate<a class="headerlink" href="#3between-route-predicate" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>YML</p>
</li>
<li>
<p>Between=2020-03-08T10:59:34.102+08:00[Asia/Shanghai] , 2020-03-08T10:59:34.102+08:00[Asia/Shanghai]</p>
</li>
</ul>
<h5 id="4cookie-route-predicate">4.Cookie Route Predicate<a class="headerlink" href="#4cookie-route-predicate" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216203328396" src="../imgs/image-20201216203328396.png" /></p>
<ul>
<li>YML</li>
<li>
<p>Cookie=username,atguigu  #并且Cookie是username=zhangshuai才能访问</p>
</li>
<li>
<p>不带cookies访问</p>
</li>
</ul>
<p><img alt="image-20201216204736280" src="../imgs/image-20201216204736280.png" /></p>
<ul>
<li>带上cookies访问</li>
<li>curl下载地址：<a href="https://curl.haxx.se/download.html">https://curl.haxx.se/download.html</a></li>
</ul>
<p><img alt="image-20201216204811341" src="../imgs/image-20201216204811341.png" /></p>
<ul>
<li>加入curl返回中文乱码（帖子）： <a href="https://blog.csdn.net/leedee/article/details/82685636">https://blog.csdn.net/leedee/article/details/82685636</a></li>
</ul>
<h5 id="5header-route-predicate">5.Header Route Predicate<a class="headerlink" href="#5header-route-predicate" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216204839238" src="../imgs/image-20201216204839238.png" /></p>
<ul>
<li>YML</li>
<li>Header=X-Request-Id, \d+  #请求头中要有X-Request-Id属性并且值为整数的正则表达式</li>
</ul>
<p><img alt="image-20201216204922763" src="../imgs/image-20201216204922763.png" /></p>
<h5 id="6host-route-predicate">6.Host Route Predicate<a class="headerlink" href="#6host-route-predicate" title="Permanent link">&para;</a></h5>
<p>YML： - Host=**.atguigu.com</p>
<h5 id="7method-route-predicate">7.Method Route Predicate<a class="headerlink" href="#7method-route-predicate" title="Permanent link">&para;</a></h5>
<p>YML：- Method=GET</p>
<h5 id="8path-route-predicate">8.Path Route Predicate<a class="headerlink" href="#8path-route-predicate" title="Permanent link">&para;</a></h5>
<p>YML：</p>
<h5 id="9-query-route-predicate">9. Query Route Predicate<a class="headerlink" href="#9-query-route-predicate" title="Permanent link">&para;</a></h5>
<p>YML： - Query=username, \d+ #要有参数名称并且是正整数才能路由</p>
<h5 id="10">10.小总结<a class="headerlink" href="#10" title="Permanent link">&para;</a></h5>
<ul>
<li>All</li>
</ul>
<div class="highlight"><pre><span></span><code>server:
  port: 9527

spring:
  application:
    name: cloud-gateway
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true  #开启从注册中心动态创建路由的功能，利用微服务名进行路由
      routes:
        - id: payment_routh #路由的ID，没有固定规则但要求唯一，建议配合服务名
          #uri: http://localhost:8001   #匹配后提供服务的路由地址
          uri: lb://cloud-payment-service
          predicates:
            - Path=/payment/get/**   #断言,路径相匹配的进行路由

        - id: payment_routh2
          #uri: http://localhost:8001   #匹配后提供服务的路由地址
          uri: lb://cloud-payment-service
          predicates:
            - Path=/payment/lb/**   #断言,路径相匹配的进行路由
            #- After=2020-03-08T10:59:34.102+08:00[Asia/Shanghai]
            #- Cookie=username,zhangshuai #并且Cookie是username=zhangshuai才能访问
            #- Header=X-Request-Id, \d+ #请求头中要有X-Request-Id属性并且值为整数的正则表达式
            #- Host=**.atguigu.com
            #- Method=GET
            #- Query=username, \d+ #要有参数名称并且是正整数才能路由


eureka:
  instance:
    hostname: cloud-gateway-service
  client:
    service-url:
      register-with-eureka: true
      fetch-registry: true
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<p>说白了，Predicate就是为了实现一组匹配规则，让请求过来找到对应的Route进行处理</p>
<h3 id="87-filter">8.7 Filter的使用<a class="headerlink" href="#87-filter" title="Permanent link">&para;</a></h3>
<h4 id="871">8.7.1 是什么<a class="headerlink" href="#871" title="Permanent link">&para;</a></h4>
<p>路由过滤器可用于修改进入的HTTP请求和返回的HTTP响应，路由过滤器只能指定路由进行使用。</p>
<p>SpringCloud Gateway内置了多种路由过滤器，他们都由GatewayFilter的工厂类来产生。</p>
<p><img alt="image-20201216205102316" src="../imgs/image-20201216205102316.png" /></p>
<h4 id="872-spring-cloud-gatewayfilter">8.7.2 Spring Cloud Gateway的Filter<a class="headerlink" href="#872-spring-cloud-gatewayfilter" title="Permanent link">&para;</a></h4>
<h5 id="1-only-two">1.   生命周期，Only Two<a class="headerlink" href="#1-only-two" title="Permanent link">&para;</a></h5>
<ul>
<li>pre</li>
<li>
<p>在业务逻辑之前</p>
</li>
<li>
<p>post</p>
</li>
<li>在业务逻辑之后</li>
</ul>
<h5 id="2-only-two">2.   种类，Only Two<a class="headerlink" href="#2-only-two" title="Permanent link">&para;</a></h5>
<p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.2.RELEASE/reference/html/#gatewayfilter-factories">https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.2.RELEASE/reference/html/#gatewayfilter-factories</a></p>
<h6 id="1-gatewayfilter31">1)  GatewayFilter（31种之多）<a class="headerlink" href="#1-gatewayfilter31" title="Permanent link">&para;</a></h6>
<p><img alt="image-20201216205201483" src="../imgs/image-20201216205201483.png" /></p>
<h6 id="2-globalfilter">2)  GlobalFilter<a class="headerlink" href="#2-globalfilter" title="Permanent link">&para;</a></h6>
<p><img alt="image-20201216205218672" src="../imgs/image-20201216205218672.png" /></p>
<h4 id="873-gatewayfilter">8.7.3 常用的GatewayFilter<a class="headerlink" href="#873-gatewayfilter" title="Permanent link">&para;</a></h4>
<p>AddRequestParameter</p>
<p>YML</p>
<p><img alt="image-20201216205244997" src="../imgs/image-20201216205244997.png" /></p>
<p>省略</p>
<p>…</p>
<h4 id="874">8.7.4 自定义过滤器<a class="headerlink" href="#874" title="Permanent link">&para;</a></h4>
<h5 id="1-globalfilter">1.   自定义全局GlobalFilter<a class="headerlink" href="#1-globalfilter" title="Permanent link">&para;</a></h5>
<p>两个主要接口介绍</p>
<p>impiemerts  GlobalFilter ，Ordered</p>
<h5 id="2_9">2.   能干嘛<a class="headerlink" href="#2_9" title="Permanent link">&para;</a></h5>
<p>全局日志记录</p>
<p>统一网关鉴权</p>
<p>。。。。。。</p>
<h5 id="3_5">3.   案例代码<a class="headerlink" href="#3_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.filter;

import lombok.extern.slf4j.Slf4j;
import org.springframework.cloud.gateway.filter.GatewayFilterChain;
import org.springframework.cloud.gateway.filter.GlobalFilter;
import org.springframework.core.Ordered;
import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Component;
import org.springframework.util.StringUtils;
import org.springframework.web.server.ServerWebExchange;
import reactor.core.publisher.Mono;
import java.util.Date;

@Component
@Slf4j
public class MyLogGateWayFilter implements GlobalFilter,Ordered {
    @Override
    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        log.info(&quot;*********come in MyLogGateWayFilter: &quot;+new Date());
        String uname = exchange.getRequest().getQueryParams().getFirst(&quot;username&quot;);
        if(StringUtils.isEmpty(username)){
            log.info(&quot;*****用户名为Null 非法用户,(┬＿┬)&quot;);
            exchange.getResponse().setStatusCode(HttpStatus.NOT_ACCEPTABLE);
            return exchange.getResponse().setComplete();
        }
        return chain.filter(exchange);
    }

    @Override
    public int getOrder() {
        return 0;
    }
}
</code></pre></div>
<h5 id="4_10">4.   测试<a class="headerlink" href="#4_10" title="Permanent link">&para;</a></h5>
<p>启动 </p>
<p><img alt="image-20201216205350335" src="../imgs/image-20201216205350335.png" /></p>
<p>正确：<a href="http://localhost:9527/payment/lb?username=z3">http://localhost:9527/payment/lb?username=z3</a></p>
<p>错误：<a href="http://localhost:9527/payment/lb?uname=z3">http://localhost:9527/payment/lb?uname=z3</a></p>
<h2 id="9-springcloud-sleuth">9. SpringCloud Sleuth分布式链路请求跟踪<a class="headerlink" href="#9-springcloud-sleuth" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 概述<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<h4 id="911">9.1.1 为什么会出现这个技术？需要解决哪些问题？<a class="headerlink" href="#911" title="Permanent link">&para;</a></h4>
<p>问题</p>
<p>在微服务框架中，一个由客户端发起的请求在后端系统中会经过多个不同的服务节点调用来协同产生最后的请求结果，每一个前端请求都会形成一个复杂的分布式服务调用链路，链路中的任何一环出现高延时或错误都会引起整个请求最后的失败。</p>
<p><img alt="image-20201216205441771" src="../imgs/image-20201216205441771.png" /></p>
<h4 id="912">9.1.2 是什么<a class="headerlink" href="#912" title="Permanent link">&para;</a></h4>
<p>Spring Cloud Sleuth提供了一套完整的服务跟踪的解决方案</p>
<p>在分布式系统中提供追踪解决方案并且兼容支持了zipkin(负责展现)</p>
<p><a href="https://github.com/spring-cloud/spring-cloud-sleuth">https://github.com/spring-cloud/spring-cloud-sleuth</a>                   </p>
<p><img alt="image-20201216205749400" src="../imgs/image-20201216205749400.png" /></p>
<p><a href="https://cloud.spring.io/spring-cloud-sleuth/reference/html/">https://cloud.spring.io/spring-cloud-sleuth/reference/html/</a></p>
<p><img alt="image-20201216205815551" src="../imgs/image-20201216205815551.png" /></p>
<h4 id="913">9.1.3 解决<a class="headerlink" href="#913" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216205846063" src="../imgs/image-20201216205846063.png" /></p>
<h3 id="92">9.2 搭建链路监控步骤<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<h4 id="921-zipkin">9.2.1 zipkin<a class="headerlink" href="#921-zipkin" title="Permanent link">&para;</a></h4>
<p>下载</p>
<p><strong>SpringCloud从F版起已不需要自己构建Zipkin server了，只需要调用jar包即可</strong></p>
<p><a href="https://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/">https://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/</a></p>
<p>zipkin-server-2.12.9.exec.jar</p>
<p>运行jar</p>
<p>java -jar zipkin-server-2.12.9-exec.jar</p>
<p>运行控制台</p>
<p><a href="http://localhost:9411/zipkin/">http://localhost:9411/zipkin/</a></p>
<p>术语</p>
<p>完整的调用链路</p>
<p>表示一请求链路，一条链路通过Trace Id唯一标识，Span标识发起的请求信息，各span通过parent id 关联起来。</p>
<p><img alt="image-20201216205959741" src="../imgs/image-20201216205959741.png" /></p>
<p>上图what</p>
<p>一条链路通过Trace Id唯一标识，Span标识发起的请求信息，各span通过parent id 关联起来。</p>
<p><img alt="image-20201216210017354" src="../imgs/image-20201216210017354.png" /></p>
<p>整个链路的依赖关系如下：</p>
<p><img alt="image-20201216210033970" src="../imgs/image-20201216210033970.png" /></p>
<p>名词解释</p>
<p>Trace:类似于树结构的Span集合，表示一条调用链路，存在唯一标识</p>
<p>span:表示调用链路来源，通俗的理解span就是一次请求信息</p>
<h4 id="922">9.2.2 服务提供者<a class="headerlink" href="#922" title="Permanent link">&para;</a></h4>
<h5 id="1-cloud-provider-payment8001">1.   修改：cloud-provider-payment8001<a class="headerlink" href="#1-cloud-provider-payment8001" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_6">2.   POM<a class="headerlink" href="#2-pom_6" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;!--包含了sleuth+zipkin--&gt;
&lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="3-yml_6">3.   YML<a class="headerlink" href="#3-yml_6" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 8001

spring:
  application:
    name: cloud-payment-service
  zipkin:
    base-url: http://localhost:9411
  sleuth:
    sampler:
      #采样率值介于0~1之间，1表示全部采样
      probability: 1
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://localhost:3306/cloud2020?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false
    username: root
    password: root

mybatis:
  mapperLocations: classpath:/mapper/*.xml
  type-aliases-package: com.atguigu.springcloud.entities

eureka:
  client:
    register-with-eureka: true
    fetchRegistry: true
    service-url:
      defaultZone: http://localhost:7001/eureka
</code></pre></div>
<h5 id="4-paymentcontroller">4.   业务类PaymentController<a class="headerlink" href="#4-paymentcontroller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/payment/zipkin&quot;)
public String paymentZipkin(){
        return &quot;hi ,i&#39;am paymentzipkin server，welcome to atguigu，O(∩_∩)O哈哈~&quot;;
}
</code></pre></div>
<h4 id="923">9.2.3 服务消费者（调用方）<a class="headerlink" href="#923" title="Permanent link">&para;</a></h4>
<h5 id="1-cloud-consumer-order80">1.   修改：cloud-consumer-order80<a class="headerlink" href="#1-cloud-consumer-order80" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_7">2.   POM<a class="headerlink" href="#2-pom_7" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code> &lt;!--包含了sleuth+zipkin--&gt;
&lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="3-yml_7">3.   YML<a class="headerlink" href="#3-yml_7" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 80

spring:
    application:
        name: cloud-order-service
    zipkin:
      base-url: http://localhost:9411
    sleuth:
      sampler:
        probability: 1

eureka:
  client:
    #表示是否将自己注册进EurekaServer默认为true。
    register-with-eureka: false
    #是否从EurekaServer抓取已有的注册信息，默认为true。单节点无所谓，集群必须设置为true才能配合ribbon使用负载均衡
    fetchRegistry: true
    service-url:
      #单机
      defaultZone: http://localhost:7001/eureka
      #集群
      #defaultZone: http://eureka7001.com:7001/eureka,http://eureka7002.com:7002/eureka  # 集群版
</code></pre></div>
<h5 id="4-paymentcontroller_1">4.   业务类PaymentController<a class="headerlink" href="#4-paymentcontroller_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code> //==&gt; zipkin+sleuth
@GetMapping(&quot;/consumer/payment/zipkin&quot;)
public String paymentZipkin(){
        String result = restTemplate.getForObject(&quot;http://localhost:8001&quot;+&quot;/payment/zipkin/&quot;, String.class);
        return result;
}
</code></pre></div>
<h4 id="924-eureka7001800180">9.2.4 依次启动eureka7001/8001/80<a class="headerlink" href="#924-eureka7001800180" title="Permanent link">&para;</a></h4>
<p>80调用8001几次测试下</p>
<h4 id="925-httplocalhost9411">9.2.5 打开浏览器访问： <a href="http://localhost:9411">http://localhost:9411</a><a class="headerlink" href="#925-httplocalhost9411" title="Permanent link">&para;</a></h4>
<p>会出现以下界面</p>
<p>查看</p>
<p><img alt="image-20201216210354958" src="../imgs/image-20201216210354958.png" /></p>
<p>查看依赖关系</p>
<p><img alt="image-20201216210409309" src="../imgs/image-20201216210409309.png" /></p>
<h2 id="10-springcloud-alibaba">10. SpringCloud Alibaba入门简介<a class="headerlink" href="#10-springcloud-alibaba" title="Permanent link">&para;</a></h2>
<h3 id="101-whyspringcloud-alibaba">10.1 why会出现SpringCloud alibaba<a class="headerlink" href="#101-whyspringcloud-alibaba" title="Permanent link">&para;</a></h3>
<p>Spring Cloud Netflix项目进入维护模式</p>
<p><a href="https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now">https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now</a></p>
<p><img alt="image-20201216210454943" src="../imgs/image-20201216210454943.png" /></p>
<p>说明：</p>
<p><strong>Spring Cloud Netflix项目进入维护模式</strong></p>
<p>最近，Netflix宣布Hystrix正在进入维护模式。自2016年以来，Ribbon已处于类似状态。</p>
<p>虽然Hystrix和Ribbon现已处于维护模式，但它们仍然在Netflix大规模部署。</p>
<p>Hystrix Dashboard和Turbine已被Atlas取代。这些项目的最后一次提交是2年和4年前。Zuul1和Archaius1都被后来不兼容的版本所取代。</p>
<p>这不包括Eureka或并发限制模块。</p>
<p><strong>什么是维护模式？</strong></p>
<p>将模块置于维护模式，意味着SpringCloud团队将不会再向模块添加新功能。我们将修复block级别的bug以及安全问题，我们也会考虑并审查社区的小型pull request。</p>
<p>我们打算继续支持这些模块，直到Greenwich版本被普遍采用至少一年。</p>
<p><strong>进入维护模式意味着什么？</strong></p>
<p>Spring Cloud Netflix将不再开放新的组件</p>
<p>我们都知道SpringCloud版本迭代算是比较快的，因而出现了很多重大ISSU都还来不及Fix就又推出另一个Release了。</p>
<p>进入维护模式意思就是目前以致以后一段时间SpringCloud netflix提供的服务和功能就这么多了，不再开发新的组件和功能了。以后将以维护和Merge分支Pull Request为主。</p>
<p>新组件功能将以其他替代的方式实现</p>
<p><img alt="image-20201216210549928" src="../imgs/image-20201216210549928.png" /></p>
<h3 id="102-springcloud-alibaba">10.2 SpringCloud alibaba带来了什么？<a class="headerlink" href="#102-springcloud-alibaba" title="Permanent link">&para;</a></h3>
<h4 id="1021">10.2.1 是什么<a class="headerlink" href="#1021" title="Permanent link">&para;</a></h4>
<p>诞生：2018.10.31，Spring Cloud Alibaba正式入驻了Spring Cloud官网孵化器，并在Maven中央库发布了第一个版本。</p>
<p><a href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md">https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md</a></p>
<p><img alt="image-20201216210635238" src="../imgs/image-20201216210635238.png" /></p>
<h4 id="1022">10.2.2 能干嘛<a class="headerlink" href="#1022" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>服务限流降级</strong>：默认支持 WebServlet、WebFlux, OpenFeign、RestTemplate、Spring Cloud Gateway, Zuul, Dubbo 和 RocketMQ 限流降级功能的接入，可以在运行时通过控制台实时修改限流降级规则，还支持查看限流降级 Metrics 监控。</p>
</li>
<li>
<p><strong>服务注册与发现</strong>：适配 Spring Cloud 服务注册与发现标准，默认集成了 Ribbon 的支持。</p>
</li>
<li>
<p><strong>分布式配置管理</strong>：支持分布式系统中的外部化配置，配置更改时自动刷新。</p>
</li>
<li>
<p><strong>消息驱动能力</strong>：基于 Spring Cloud Stream 为微服务应用构建消息驱动能力。</p>
</li>
<li>
<p><strong>分布式事务</strong>：使用 @GlobalTransactional 注解， 高效并且对业务零侵入地解决分布式事务问题。。</p>
</li>
<li>
<p><strong>阿里云对象存储</strong>：阿里云提供的海量、安全、低成本、高可靠的云存储服务。支持在任何应用、任何时间、任何地点存储和访问任意类型的数据。</p>
</li>
<li>
<p><strong>分布式任务调度</strong>：提供秒级、精准、高可靠、高可用的定时（基于 Cron 表达式）任务调度服务。同时提供分布式的任务执行模型，如网格任务。网格任务支持海量子任务均匀分配到所有 Worker（schedulerx-client）上执行。</p>
</li>
<li>
<p><strong>阿里云短信服务</strong>：覆盖全球的短信服务，友好、高效、智能的互联化通讯能力，帮助企业迅速搭建客户触达通道。</p>
</li>
</ul>
<h4 id="1023">10.2.3 去哪下<a class="headerlink" href="#1023" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;
            &lt;version&gt;2.2.0.RELEASE&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
</code></pre></div>
<h4 id="1024">10.2.4 怎么玩<a class="headerlink" href="#1024" title="Permanent link">&para;</a></h4>
<p><strong>一整套解决方案，简单理解就是替换Netflix那一套</strong></p>
<p><strong>Sentinel</strong>：把流量作为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</p>
<p><strong>Nacos</strong>：一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。</p>
<p><strong>RocketMQ</strong>：一款开源的分布式消息系统，基于高可用分布式集群技术，提供低延时的、高可靠的消息发布与订阅服务。</p>
<p><strong>Dubbo</strong>：Apache Dubbo™ 是一款高性能 Java RPC 框架。</p>
<p><strong>Seata</strong>：阿里巴巴开源产品，一个易于使用的高性能微服务分布式事务解决方案。</p>
<p><strong>Alibaba Cloud ACM</strong>：一款在分布式架构环境中对应用配置进行集中管理和推送的应用配置中心产品。</p>
<p><strong>Alibaba Cloud OSS</strong>: 阿里云对象存储服务（Object Storage Service，简称 OSS），是阿里云提供的海量、安全、低成本、高可靠的云存储服务。您可以在任何应用、任何时间、任何地点存储和访问任意类型的数据。</p>
<p><strong>Alibaba Cloud SchedulerX</strong>: 阿里中间件团队开发的一款分布式任务调度产品，提供秒级、精准、高可靠、高可用的定时（基于 Cron 表达式）任务调度服务。</p>
<p><strong>Alibaba Cloud SMS</strong>: 覆盖全球的短信服务，友好、高效、智能的互联化通讯能力，帮助企业迅速搭建客户触达通道。 </p>
<h3 id="103-springcloud-alibaba">10.3 SpringCloud alibaba学习资料获取<a class="headerlink" href="#103-springcloud-alibaba" title="Permanent link">&para;</a></h3>
<p>官网：<a href="https://spring.io/projects/spring-cloud-alibaba#overview">https://spring.io/projects/spring-cloud-alibaba#overview</a></p>
<p><img alt="image-20201216210851582" src="../imgs/image-20201216210851582.png" /></p>
<p><img alt="image-20201216210907247" src="../imgs/image-20201216210907247.png" /></p>
<p>英文</p>
<p><a href="https://github.com/alibaba/spring-cloud-alibaba">https://github.com/alibaba/spring-cloud-alibaba</a></p>
<p><a href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html</a></p>
<p>中文</p>
<p><a href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md">https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md</a></p>
<h2 id="11-springcloud-alibaba-nacos">11. SpringCloud Alibaba Nacos服务注册和配置中心<a class="headerlink" href="#11-springcloud-alibaba-nacos" title="Permanent link">&para;</a></h2>
<h3 id="111-nacos">11.1 Nacos简介<a class="headerlink" href="#111-nacos" title="Permanent link">&para;</a></h3>
<h4 id="1111-nacos">11.1.1 为什么叫Nacos<a class="headerlink" href="#1111-nacos" title="Permanent link">&para;</a></h4>
<p>前四个字母分别为Naming和Configuration的前两个字母，最后的s为Service</p>
<h4 id="1112">11.1.2 是什么<a class="headerlink" href="#1112" title="Permanent link">&para;</a></h4>
<p>一个更易于构建云原生应用的动态服务发现，配置管理和服务管理中心</p>
<p>Nacos：Dynamic Naming and Configuration Service</p>
<p>Nacos就是注册中心+配置中心的组合</p>
<p>等价于：Nacos = Eureka+Config+Bus</p>
<h4 id="1113">11.1.3 能干嘛<a class="headerlink" href="#1113" title="Permanent link">&para;</a></h4>
<p><strong>替代Eureka做服务注册中心</strong></p>
<p><strong>替代Config做服务配置中心</strong></p>
<h4 id="314_1">3.1.4.    去哪下<a class="headerlink" href="#314_1" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Nacos">https://github.com/alibaba/Nacos</a></p>
<p><img alt="image-20201216211049647" src="../imgs/image-20201216211049647.png" /></p>
<p>官网文档</p>
<p><a href="https://nacos.io/zh-cn/index.html">https://nacos.io/zh-cn/index.html</a></p>
<p><img alt="image-20201216211106567" src="../imgs/image-20201216211106567.png" /></p>
<p><img alt="image-20201216211125274" src="../imgs/image-20201216211125274.png" /></p>
<p><img alt="image-20201216211144152" src="../imgs/image-20201216211144152.png" /></p>
<p><a href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html</a></p>
<p><img alt="image-20201216211209330" src="../imgs/image-20201216211209330.png" /></p>
<h4 id="1115">11.1.5 各种注册中心比较<a class="headerlink" href="#1115" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216211231979" src="../imgs/image-20201216211231979.png" /></p>
<p>据说nacos在阿里巴巴内部有超过10万的实例运行，已经过了类似双十一等各种大型流量的考验</p>
<p>CAP原则又称CAP定理，指的是在一个分布式系统中，一致性（Consistency）、可用性（Availability）、分区容错性（Partition tolerance）。CAP 原则指的是，这三个要素最多只能同时实现两点，不可能三者兼顾。</p>
<h3 id="112-nacos">11.2 安装并运行Nacos<a class="headerlink" href="#112-nacos" title="Permanent link">&para;</a></h3>
<h4 id="1121-java8mavenok">11.2.1 本地Java8+Maven环境已经OK<a class="headerlink" href="#1121-java8mavenok" title="Permanent link">&para;</a></h4>
<h4 id="1122-nacos">11.2.2 先从官网下载Nacos<a class="headerlink" href="#1122-nacos" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/nacos/releases/tag/1.1.4">https://github.com/alibaba/nacos/releases/tag/1.1.4</a></p>
<h4 id="1123-binstartupcmd">11.2.3 解压安装包，直接运行bin/startup.cmd<a class="headerlink" href="#1123-binstartupcmd" title="Permanent link">&para;</a></h4>
<h4 id="1124">11.2.4 命令运行成功后直接访问<a class="headerlink" href="#1124" title="Permanent link">&para;</a></h4>
<p><a href="http://localhost:8848/nacos">http://localhost:8848/nacos</a></p>
<p>默认账号密码都是nacos</p>
<h4 id="1125">11.2.5 登录结果页面<a class="headerlink" href="#1125" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216211401731" src="../imgs/image-20201216211401731.png" /></p>
<h3 id="113-nacos">11.3 Nacos作为服务注册中心演示<a class="headerlink" href="#113-nacos" title="Permanent link">&para;</a></h3>
<h4 id="1131">11.3.1 官网文档<a class="headerlink" href="#1131" title="Permanent link">&para;</a></h4>
<p><a href="https://spring.io/projects/spring-cloud-alibaba#learn">https://spring.io/projects/spring-cloud-alibaba#learn</a></p>
<p><a href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html</a></p>
<p><img alt="image-20201216211433810" src="../imgs/image-20201216211433810.png" /></p>
<h4 id="1132-nacos">11.3.2 基于Nacos的服务提供者<a class="headerlink" href="#1132-nacos" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloudalibaba-provider-payment9001">1.   新建Module：cloudalibaba-provider-payment9001<a class="headerlink" href="#1-modulecloudalibaba-provider-payment9001" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_8">2.   POM<a class="headerlink" href="#2-pom_8" title="Permanent link">&para;</a></h5>
<ul>
<li>父POM</li>
</ul>
<div class="highlight"><pre><span></span><code>&lt;!--spring cloud alibaba 2.1.0.RELEASE--&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
  &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;
  &lt;version&gt;2.1.0.RELEASE&lt;/version&gt;
  &lt;type&gt;pom&lt;/type&gt;
  &lt;scope&gt;import&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre></div>
<ul>
<li>本模块POM</li>
</ul>
<div class="highlight"><pre><span></span><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
        &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre></div>
<h5 id="3-yml_8">3.   YML<a class="headerlink" href="#3-yml_8" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 9001

spring:
  application:
    name: nacos-payment-provider
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 #配置Nacos地址

management:
  endpoints:
    web:
      exposure:
        include: &#39;*&#39;  #默认只公开了/health和/info端点，要想暴露所有端点只需设置成星号
</code></pre></div>
<h5 id="4_11">4.   主启动<a class="headerlink" href="#4_11" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@EnableDiscoveryClient
@SpringBootApplication
public class PaymentMain9001 {
    public static void main(String[] args) {
        SpringApplication.run(PaymentMain9001.class,args);
    }
}
</code></pre></div>
<h5 id="5_8">5.   业务类<a class="headerlink" href="#5_8" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class PaymentController{
    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(value = &quot;/payment/nacos/{id}&quot;)
    public String getPayment(@PathVariable(&quot;id&quot;) Long id) {
        return &quot;nacos registry, serverPort: &quot;+ serverPort+&quot;\t id&quot;+id;
    }
}
</code></pre></div>
<h5 id="6_4">6.   测试<a class="headerlink" href="#6_4" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost:9001/payment/nacos/1">http://localhost:9001/payment/nacos/1</a></p>
<p>nacos控制台</p>
<p><img alt="image-20201216211651875" src="../imgs/image-20201216211651875.png" /></p>
<p>nacos服务注册中心+服务提供者9001都ok了</p>
<h5 id="7-nacos90019002">7.   为了下一章节演示nacos的负载均衡，参照9001新建9002<a class="headerlink" href="#7-nacos90019002" title="Permanent link">&para;</a></h5>
<p>新建cloudalibaba-provider-payment9002</p>
<p>9002其他步骤你懂的</p>
<p>或者取巧不想新建重复体力劳动，直接拷贝虚拟端口映射</p>
<p><img alt="image-20201216211710633" src="../imgs/image-20201216211710633.png" /></p>
<p><img alt="image-20201216211742127" src="../imgs/image-20201216211742127.png" /></p>
<p><img alt="image-20201216211801598" src="../imgs/image-20201216211801598.png" /></p>
<p><img alt="image-20201216211817847" src="../imgs/image-20201216211817847.png" /></p>
<p><img alt="image-20201216211834273" src="../imgs/image-20201216211834273.png" /> </p>
<h4 id="1133-nacos">11.3.3 基于Nacos的服务消费者<a class="headerlink" href="#1133-nacos" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloudalibaba-consumer-nacos-order83">1.   新建Module：cloudalibaba-consumer-nacos-order83<a class="headerlink" href="#1-modulecloudalibaba-consumer-nacos-order83" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_9">2.   POM<a class="headerlink" href="#2-pom_9" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependencies&gt;
    &lt;!--SpringCloud ailibaba nacos --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
    &lt;/dependency&gt;
        &lt;dependency&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
        &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
        &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt; 
</code></pre></div>
<p>为什么nacos支持负载均衡</p>
<p><img alt="image-20201216211956463" src="../imgs/image-20201216211956463.png" /></p>
<h5 id="3-yml_9">3.   YML<a class="headerlink" href="#3-yml_9" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 83

spring:
  application:
    name: nacos-order-consumer
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
#消费者将要去访问的微服务名称(注册成功进nacos的微服务提供者【可选】，注意：nacos-payment-provider含有IP和端口)
service-url:
  nacos-user-service: http://nacos-payment-provider
</code></pre></div>
<h5 id="4_12">4.   主启动<a class="headerlink" href="#4_12" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@EnableDiscoveryClient
@SpringBootApplication
public class OrderNacosMain83{
    public static void main(String[] args){
        SpringApplication.run(OrderNacosMain83.class,args);
    }
}
</code></pre></div>
<h5 id="5_9">5.   业务类<a class="headerlink" href="#5_9" title="Permanent link">&para;</a></h5>
<p>ApplicationContextBean</p>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.config;

import org.springframework.cloud.client.loadbalancer.LoadBalanced;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;

@Configuration
public class ApplicationContextConfig{
    @Bean
    @LoadBalanced
    public RestTemplate getRestTemplate(){
        return new RestTemplate();
    }
}
</code></pre></div>
<h5 id="6-ordernacoscontroller">6.   OrderNacosController<a class="headerlink" href="#6-ordernacoscontroller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;
import javax.annotation.Resource;

@RestController
@Slf4j
public class OrderNacosController{
    @Resource
    private RestTemplate restTemplate;

    @Value(&quot;${service-url.nacos-user-service}&quot;)
    private String serverURL;

    @GetMapping(value = &quot;/consumer/payment/nacos/{id}&quot;)
    public String paymentInfo(@PathVariable(&quot;id&quot;) Long id){
        return restTemplate.getForObject(serverURL+&quot;/payment/nacos/&quot;+id,String.class);
    }

}
</code></pre></div>
<h5 id="7_1">7.   测试<a class="headerlink" href="#7_1" title="Permanent link">&para;</a></h5>
<p>nacos控制台</p>
<p><img alt="image-20201216212127998" src="../imgs/image-20201216212127998.png" /></p>
<p><a href="http://localhost:83/consumer/payment/nacos/1">http://localhost:83/consumer/payment/nacos/1</a></p>
<p>83访问9001/9002，轮询负载OK</p>
<h4 id="1134">11.3.4 服务注册中心对比<a class="headerlink" href="#1134" title="Permanent link">&para;</a></h4>
<h5 id="1-nacoscap">1.   Nacos和CAP<a class="headerlink" href="#1-nacoscap" title="Permanent link">&para;</a></h5>
<p>CAP原则又称CAP定理，指的是在一个分布式系统中， Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。</p>
<p>一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（等同于所有节点访问同一份最新的数据副本）</p>
<p>可用性（A）：在集群中一部分节点故障后，集群整体是否还能响应客户端的读写请求。（对数据更新具备高可用性）</p>
<p>分区容忍性（P）：以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择。</p>
<p>CAP原则的精髓就是要么AP，要么CP，要么AC，但是不存在CAP。</p>
<p>如果在某个分布式系统中数据无副本， 那么系统必然满足强一致性条件， 因为只有独一数据，不会出现数据不一致的情况，此时C和P两要素具备，但是如果系统发生了网络分区状况或者宕机，必然导致某些数据不可以访问，此时可用性条件就不能被满足，即在此情况下获得了CP系统，但是CAP不可同时满足。</p>
<p>因此在进行分布式架构设计时，必须做出取舍。当前一般是通过分布式缓存中各节点的最终一致性来提高系统的性能，通过使用多节点之间的数据异步复制技术来实现集群化的数据一致性。</p>
<p><img alt="image-20201216212214151" src="../imgs/image-20201216212214151.png" /></p>
<h5 id="2-nacosapcp">2.   Nacos支持AP和CP模式的切换<a class="headerlink" href="#2-nacosapcp" title="Permanent link">&para;</a></h5>
<p>curl -X PUT '$NACOS_SERVER:8848/nacos/v1/ns/operator/switches?entry=serverMode&amp;value=CP'</p>
<h3 id="114-nacos">11.4 Nacos作为服务配置中心演示<a class="headerlink" href="#114-nacos" title="Permanent link">&para;</a></h3>
<h4 id="1141-nacos-">11.4.1 Nacos作为配置中心-基础配置<a class="headerlink" href="#1141-nacos-" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloudalibaba-config-nacos-client3377">1.   创建Module：cloudalibaba-config-nacos-client3377<a class="headerlink" href="#1-modulecloudalibaba-config-nacos-client3377" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_10">2.   POM<a class="headerlink" href="#2-pom_10" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependencies&gt;
    &lt;!--nacos-config--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!--nacos-discovery--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!--web + actuator--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!--一般基础配置--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
        &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre></div>
<h5 id="3-yml_10">3.   YML<a class="headerlink" href="#3-yml_10" title="Permanent link">&para;</a></h5>
<p>Nacos同springcloud-config一样，在项目初始化时，要保证先从配置中心进行配置拉取，拉取配置之后，才能保证项目的正常启动</p>
<p>springboot中配置文件的加载是存在优先级顺序的，bootstrap优先级高于application</p>
<p><strong>bootstrap.yml</strong></p>
<div class="highlight"><pre><span></span><code>server:
  port: 3377

spring:
  application:
    name: nacos-config-client
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 #服务注册中心地址
      config:
        server-addr: localhost:8848 #配置中心地址
        file-extension: yaml #指定yaml格式的配置（yml和yaml都可以）

#${spring.application.name}-${spring.profile.active}.${spring.cloud.nacos.config.file-extension}
#nacos-config-client-dev.yaml  (一定要与file-extension值保持一致)
</code></pre></div>
<p><strong>application.yml</strong></p>
<div class="highlight"><pre><span></span><code>spring:
  profiles:
    active: dev #表示开发环境 
</code></pre></div>
<h5 id="4_13">4.   主启动<a class="headerlink" href="#4_13" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@EnableDiscoveryClient
@SpringBootApplication
public class NacosConfigClientMain3377{
    public static void main(String[] args) {
        SpringApplication.run(NacosConfigClientMain3377.class, args);
    }
}
</code></pre></div>
<h5 id="5-configclientcontroller">5.   业务类:ConfigClientController<a class="headerlink" href="#5-configclientcontroller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.cloud.context.config.annotation.RefreshScope;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RefreshScope   //通过SpringCould原生注解@RefreshScope实现配置自动更新
public class ConfigClientController{
    @Value(&quot;${config.info}&quot;) //对应nacos配置:nacos-config-client-dev.yaml
    private String configInfo;

    @GetMapping(&quot;/config/info&quot;)
    public String getConfigInfo() {
        return configInfo;
    }
}
</code></pre></div>
<h5 id="6-nacos">6.   在Nacos中添加配置信息<a class="headerlink" href="#6-nacos" title="Permanent link">&para;</a></h5>
<p>Nacos中的匹配规则</p>
<p>Nacos中的dataid的组成格式与SpringBoot配置文件中的匹配规则</p>
<p>官网 <a href="https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html">https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html</a></p>
<p><img alt="image-20201216212444449" src="../imgs/image-20201216212444449.png" /></p>
<p>最后公式：</p>
<p><span class="arithmatex"><span class="MathJax_Preview">{spring.application.name}-</span><script type="math/tex">{spring.application.name}-</script></span>{spring.profiles.active}.${spring.cloud.nacos.config.file-extension}</p>
<p>nacos-config-client-dev.yaml</p>
<p>Nacos界面配置对应</p>
<div class="highlight"><pre><span></span><code>config:
  info: &quot;config info for dev,from nacos config center.&quot;
</code></pre></div>
<p><img alt="image-20201216212548448" src="../imgs/image-20201216212548448.png" />         </p>
<p><strong>设置DataId</strong></p>
<p>公式: <span class="arithmatex"><span class="MathJax_Preview">{spring.application.name}-</span><script type="math/tex">{spring.application.name}-</script></span>{spring.profile.active}.${spring.cloud.nacos.config.file-extension}</p>
<p><strong>小总结说明</strong></p>
<p><img alt="image-20201216212609440" src="../imgs/image-20201216212609440.png" /></p>
<p><strong>历史配置：</strong>Nacos会记录配置文件的历史版本默认保留30天</p>
<h5 id="7_2">7.   测试<a class="headerlink" href="#7_2" title="Permanent link">&para;</a></h5>
<p>启动前需要在nacos客户端-配置管理-配置管理栏目下有没有对应的yaml配置文件</p>
<p>运行cloud-config-nacos-client3377的主启动类</p>
<p>调用接口查看配置信息： <a href="http://localhost:3377/config/info">http://localhost:3377/config/info</a></p>
<h5 id="8">8.   自带动态刷新<a class="headerlink" href="#8" title="Permanent link">&para;</a></h5>
<p>修改Nacos中的yaml配置文件，查看配置已经刷新  </p>
<h4 id="1142-nacos-">11.4.2 Nacos作为配置中心-分类配置<a class="headerlink" href="#1142-nacos-" title="Permanent link">&para;</a></h4>
<h5 id="1_6">1.   问题<a class="headerlink" href="#1_6" title="Permanent link">&para;</a></h5>
<p>多环境多项目管理</p>
<p><strong>问题1</strong></p>
<ul>
<li>
<p>实际开发中，通常一个系统会准备</p>
</li>
<li>
<p>dev开发环境</p>
</li>
<li>
<p>test测试环境</p>
</li>
<li>
<p>prod生产环境</p>
</li>
<li>
<p>如何保证指定环境启动时服务能正确读取到 Nacos上相应环境的配置文件呢?</p>
</li>
</ul>
<p><strong>问题2</strong></p>
<ul>
<li>
<p>一个大型分布式微服务心痛会有很多微服务子项目</p>
</li>
<li>
<p>每一个微服务项目又会相应的开发环境、测试环境、预发环境、正式环境….</p>
</li>
<li>
<p>那怎么对这些微服务配置进行管理呢？</p>
</li>
</ul>
<h5 id="2-nacos">2.   Nacos的图形化管理界面<a class="headerlink" href="#2-nacos" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>配置管理</strong></li>
</ul>
<p><img alt="image-20201216212751734" src="../imgs/image-20201216212751734.png" /></p>
<ul>
<li><strong>命名空间</strong></li>
</ul>
<p><img alt="image-20201216212822554" src="../imgs/image-20201216212822554.png" /></p>
<h5 id="3-namespacegroupdata-id">3.   Namespace+Group+Data ID三者关系？为什么这么设计？<a class="headerlink" href="#3-namespacegroupdata-id" title="Permanent link">&para;</a></h5>
<p>最外层的namespace是可以用于区分部署环境的，Group和DataID逻辑上区分两个目标对象。</p>
<p><img alt="image-20201216212840855" src="../imgs/image-20201216212840855.png" /></p>
<p>默认情况：Namespace=public，Group=DEFAULT_GROUP，默认Cluster是DEFAULT</p>
<ul>
<li>Nacos默认的命名空间是public，Namespace主要用来实现隔离。</li>
</ul>
<p>比方说我们现在有三个环境：开发、测试、生产环境，我们就可以创建三个Namespace，不同的 Namespace之间是隔离的。</p>
<ul>
<li>Group默认是DEFAULT_GROUP，Group可以把不同的微服务划分到同一个分组里面去。Service就是微服务；一个Service可以包含多个Cluster(集群)，Nacos默认Cluster是DEFAULT，Cluster是对指定微服务的一个虚拟划分。</li>
</ul>
<p>比方说为了容灾，将Service微服务分别部署在了杭州机房和广州机房，这时就可以给杭州机房的Service微服务起一个集群名称(HZ)，给广州机房的Service微服务起一个集群名字(GZ)，还可以尽量让同一个机房的微服务互相调用，以提升性能。</p>
<ul>
<li>最后是Instance，就是微服务的实例。</li>
</ul>
<h5 id="4-case">4.   Case<a class="headerlink" href="#4-case" title="Permanent link">&para;</a></h5>
<h6 id="1-dataid">1)  DataID方案<a class="headerlink" href="#1-dataid" title="Permanent link">&para;</a></h6>
<p>指定spring.profile.active和配置文件的DataID来使不同环境下读取不同的配置</p>
<p><strong>默认空间+默认分组+新建dev和test两个DataID</strong></p>
<p>新建dev配置DataID</p>
<p><img alt="image-20201216212958214" src="../imgs/image-20201216212958214.png" /></p>
<p>新建test配置DataID</p>
<p><img alt="image-20201216213014303" src="../imgs/image-20201216213014303.png" /></p>
<p>通过spring.profile.active属性就能进行多环境下配置文件的读取</p>
<p><img alt="image-20201216213030175" src="../imgs/image-20201216213030175.png" /></p>
<p>测试</p>
<p><a href="http://localhost:3377/config/info">http://localhost:3377/config/info</a></p>
<p>配置是什么就加载什么</p>
<p><img alt="image-20201216213044680" src="../imgs/image-20201216213044680.png" /></p>
<h6 id="2-group">2)  Group方案<a class="headerlink" href="#2-group" title="Permanent link">&para;</a></h6>
<p>通过Group实现环境区分</p>
<p>新建Group</p>
<p><img alt="image-20201216213103948" src="../imgs/image-20201216213103948.png" /></p>
<p><img alt="image-20201216213121863" src="../imgs/image-20201216213121863.png" /></p>
<p>在nacos图形界面控制台上面新建配置文件DataID</p>
<p><img alt="image-20201216213146919" src="../imgs/image-20201216213146919.png" /></p>
<p>bootstrap+application</p>
<p><img alt="image-20201216213201460" src="../imgs/image-20201216213201460.png" /></p>
<p>在config下增加一条group的配置即可。可配置为DEV_GROUP或TEST_GROUP</p>
<h6 id="3-namespace">3)  Namespace方案<a class="headerlink" href="#3-namespace" title="Permanent link">&para;</a></h6>
<p>新建dev/test的Namespace</p>
<p><img alt="image-20201216213218171" src="../imgs/image-20201216213218171.png" /></p>
<p><img alt="image-20201216213233503" src="../imgs/image-20201216213233503.png" /></p>
<p>回到服务管理-服务列表查看</p>
<p><img alt="image-20201216213250496" src="../imgs/image-20201216213250496.png" /></p>
<p>按照域名配置填写</p>
<div class="highlight"><pre><span></span><code>nacos-config-client-dev.yaml

config: 
  info: 9f62d48c-ef2e-4d83-a9fb-c9db5833f93b DEFAULT_GROUP nacos-config-client-dev.yaml
</code></pre></div>
<p><img alt="image-20201216213326125" src="../imgs/image-20201216213326125.png" /></p>
<p>YML</p>
<p>bootstrap</p>
<div class="highlight"><pre><span></span><code># nacos配置
server:
  port: 3377

spring:
  application:
    name: nacos-config-client
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 #Nacos服务注册中心地址
      config:
        server-addr: localhost:8848 #Nacos作为配置中心地址
        file-extension: yaml #指定yaml格式的配置
        group: DEV_GROUP
        namespace: 7d8f0f5a-6a53-4785-9686-dd460158e5d4

# ${spring.application.name}-${spring.profile.active}.${spring.cloud.nacos.config.file-extension}
# nacos-config-client-dev.yaml 
</code></pre></div>
<p>application </p>
<div class="highlight"><pre><span></span><code>spring:
  profiles:
    active: dev # 表示开发环境
    #active: test # 表示测试环境
    #active: info
</code></pre></div>
<p>图解：</p>
<p><img alt="image-20201216213441391" src="../imgs/image-20201216213441391.png" /></p>
<p>测试结果：</p>
<p><img alt="image-20201216213457309" src="../imgs/image-20201216213457309.png" /></p>
<h3 id="115-nacos">11.5 Nacos集群和持久化配置（重要）<a class="headerlink" href="#115-nacos" title="Permanent link">&para;</a></h3>
<h4 id="1151">11.5.1 官网说明<a class="headerlink" href="#1151" title="Permanent link">&para;</a></h4>
<p><a href="https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html">https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html</a></p>
<h5 id="1_7">1.   官网架构图<a class="headerlink" href="#1_7" title="Permanent link">&para;</a></h5>
<p>集群部署架构图</p>
<p>推荐用户把所有服务列表放到一个vip下面，然后挂到一个域名下面</p>
<p><a href="http://ip1/">http://ip1</a>:port/openAPI 直连ip模式，机器挂则需要修改ip才可以使用。</p>
<p><a href="http://vip/">http://VIP</a>:port/openAPI 挂载VIP模式，直连vip即可，下面挂server真实ip，可读性不好。</p>
<p><a href="http://nacos.com/">http://nacos.com</a>:port/openAPI 域名 + VIP模式，可读性好，而且换ip方便，推荐模式</p>
<p><img alt="image-20201216213547369" src="../imgs/image-20201216213547369.png" /></p>
<h5 id="2_10">2.   上图官网翻译，真实情况<a class="headerlink" href="#2_10" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201216213603423" src="../imgs/image-20201216213603423.png" /></p>
<h5 id="3_6">3.   说明<a class="headerlink" href="#3_6" title="Permanent link">&para;</a></h5>
<p>默认Nacos使用嵌入式数据库实现数据的存储。所以，如果启动多个默认配置下的Nacos节点，数据存储是存在一致性问题多的。</p>
<p>为了解决这个问题，<strong>Nacos采用了集中式存储的方式来支持集群化部署，目前只支持MySQL 的存储。</strong></p>
<p><img alt="image-20201216213635998" src="../imgs/image-20201216213635998.png" /></p>
<p><img alt="image-20201216213658427" src="../imgs/image-20201216213658427.png" /></p>
<p><a href="https://nacos.io/zh-cn/docs/deployment.html">https://nacos.io/zh-cn/docs/deployment.html</a> </p>
<h4 id="1152-nacos">11.5.2 Nacos持久化配置解释<a class="headerlink" href="#1152-nacos" title="Permanent link">&para;</a></h4>
<h5 id="1-nacosderby">1.   Nacos默认自带的是嵌入式数据库derby<a class="headerlink" href="#1-nacosderby" title="Permanent link">&para;</a></h5>
<p><a href="https://github.com/alibaba/nacos/blob/develop/config/pom.xml">https://github.com/alibaba/nacos/blob/develop/config/pom.xml</a></p>
<h5 id="2-derbymysql">2.   derby到mysql切换配置步骤<a class="headerlink" href="#2-derbymysql" title="Permanent link">&para;</a></h5>
<p>nacos-server-1.1.4\nacos\conf目录下找到sql脚本</p>
<p>nacos-mysql.sql</p>
<p>执行脚本</p>
<p>nacos-server-1.1.4\nacos\conf目录下找到application.properties</p>
<div class="highlight"><pre><span></span><code>spring.datasource.platform=mysql

db.num=1
db.url.0=jdbc:mysql://11.162.196.16:3306/nacos_devtest?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true
db.user=nacos_devtest
db.password=youdontknow
</code></pre></div>
<h5 id="3-nacosderby">3.   启动nacos，可以看到是个全新的空记录界面，以前是记录进derby<a class="headerlink" href="#3-nacosderby" title="Permanent link">&para;</a></h5>
<h5 id="4-mysql">4.   测试：新建配置，发现配置信息写入了MySQL数据库<a class="headerlink" href="#4-mysql" title="Permanent link">&para;</a></h5>
<h4 id="1153-linuxnacosmysql">11.5.3 Linux版Nacos+MySQL生产环境配置<a class="headerlink" href="#1153-linuxnacosmysql" title="Permanent link">&para;</a></h4>
<h4 id="1-1nginx3nacos1mysql">1.   预计需要，1个nginx+3个nacos注册中心+1个mysql<a class="headerlink" href="#1-1nginx3nacos1mysql" title="Permanent link">&para;</a></h4>
<h4 id="2-nacoslinux">2.   Nacos下载linux版本<a class="headerlink" href="#2-nacoslinux" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216213832558" src="../imgs/image-20201216213832558.png" /></p>
<p><a href="https://github.com/alibaba/nacos/releases/tag/1.1.4">https://github.com/alibaba/nacos/releases/tag/1.1.4</a></p>
<p>nacos-server-1.1.4.tar.gz</p>
<h4 id="3_7">3.   集群配置步骤（重点）<a class="headerlink" href="#3_7" title="Permanent link">&para;</a></h4>
<h5 id="1linuxmysql">1.Linux服务器上mysql数据库配置<a class="headerlink" href="#1linuxmysql" title="Permanent link">&para;</a></h5>
<ul>
<li>SQL脚本在哪里</li>
</ul>
<p><img alt="image-20201216213908952" src="../imgs/image-20201216213908952.png" /></p>
<ul>
<li>Linux上创建Mysql数据库</li>
</ul>
<p><img alt="image-20201216213921798" src="../imgs/image-20201216213921798.png" /></p>
<h5 id="2applicationproperties">2.application.properties配置<a class="headerlink" href="#2applicationproperties" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>spring.datasource.platform=mysql

db.num=1
db.url.0=jdbc:mysql://192.168.137.128:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true
db.user=zhang3
db.password=123456
</code></pre></div>
<h5 id="3linuxnacosclusterconf">3.Linux服务器上nacos的集群配置cluster.conf<a class="headerlink" href="#3linuxnacosclusterconf" title="Permanent link">&para;</a></h5>
<p>梳理出3台nacos机器的不同服务端口号</p>
<p>复制出cluster.conf</p>
<p><img alt="image-20201216214000387" src="../imgs/image-20201216214000387.png" /></p>
<p>内容</p>
<div class="highlight"><pre><span></span><code>192.168.137.128:3333
192.168.137.128:4444
192.168.137.128:5555
</code></pre></div>
<p>这个IP不能写127.0.0.1,必须是Linux命令hostname -i能够识别的IP</p>
<p><img alt="image-20201216214042710" src="../imgs/image-20201216214042710.png" /></p>
<h5 id="4nacosstartupsh">4.编辑Nacos的启动脚本startup.sh，使它能够接受不同的启动端<a class="headerlink" href="#4nacosstartupsh" title="Permanent link">&para;</a></h5>
<p>/mynacos/nacos/bin目录下有startup.sh</p>
<p>在什么地方，修改什么，怎么修改</p>
<p>思考</p>
<p>/mynacos/nacos/bin目录下有startup.sh</p>
<p>平时单机版的启动，都是./startup.sh即可。</p>
<p>但是</p>
<p>集群启动，我们希望可以类似其它软件的shell命令，传递不同的端口号启动不同的nacos实例。</p>
<p>命令：./startup.sh <strong>-p</strong> 3333表示启动端口号为3333的nacos服务器实例，和上一步的cluster.conf配置的一致。</p>
<p>修改内容</p>
<p><img alt="image-20201216214119602" src="../imgs/image-20201216214119602.png" /></p>
<ul>
<li>修改前 </li>
</ul>
<p><img alt="image-20201216214204917" src="../imgs/image-20201216214204917.png" /></p>
<ul>
<li>修改后</li>
</ul>
<p><img alt="image-20201216214238107" src="../imgs/image-20201216214238107.png" /></p>
<ul>
<li>修改前</li>
</ul>
<p><img alt="image-20201216214328327" src="../imgs/image-20201216214328327.png" /></p>
<ul>
<li>修改后</li>
</ul>
<p><img alt="image-20201216214356656" src="../imgs/image-20201216214356656.png" /></p>
<p>执行方式</p>
<p>启动时，需要修改内存大小，否则，内存可能不够用。</p>
<p><img alt="image-20201216214415753" src="../imgs/image-20201216214415753.png" /></p>
<p><img alt="image-20201216214435527" src="../imgs/image-20201216214435527.png" /></p>
<p>查看进程：ps -ef | grep nacos   </p>
<p><img alt="image-20201216214450907" src="../imgs/image-20201216214450907.png" /></p>
<h5 id="5nginx">5.Nginx的配置，由它作为负载均衡器<a class="headerlink" href="#5nginx" title="Permanent link">&para;</a></h5>
<p>修改nginx的配置文件：vim /usr/local/nginx/conf/nginx.conf</p>
<p>nginx.conf</p>
<div class="highlight"><pre><span></span><code>upstream cluster{ 
    server 192.168.137.128:3333;
    server 192.168.137.128:4444;
    server 192.168.137.128:5555;
}

server{               
    listen 1111;
    server_name 192.168.137.128;
    location / {
         proxy_pass http://cluster;                        
    }
....省略 
</code></pre></div>
<p>启动Nginx：</p>
<p><img alt="image-20201216214553497" src="../imgs/image-20201216214553497.png" /></p>
<h5 id="61nginx3nacos1mysql">6.截止到此处，1个Nginx+3个nacos注册中心+1个mysql<a class="headerlink" href="#61nginx3nacos1mysql" title="Permanent link">&para;</a></h5>
<p>测试通过nginx访问nacos</p>
<p><a href="https://写你自己虚拟机的ip:1111/nacos/#/login">https:// 192.168.137.128:1111/nacos/#/login</a></p>
<p><img alt="image-20201216214641179" src="../imgs/image-20201216214641179.png" /></p>
<p>新建一个配置测试</p>
<p><img alt="image-20201216214657253" src="../imgs/image-20201216214657253.png" /></p>
<p>linux服务器的mysql插入一条记录</p>
<p><img alt="image-20201216214714929" src="../imgs/image-20201216214714929.png" /></p>
<h4 id="4_14">4.   测试<a class="headerlink" href="#4_14" title="Permanent link">&para;</a></h4>
<p>微服务cloudalibaba-provider-payment9002启动注册进nacos集群</p>
<p>yml</p>
<p>server-addr: 写你自己的虚拟机ip:1111</p>
<p><img alt="image-20201216214743428" src="../imgs/image-20201216214743428.png" /></p>
<p>结果</p>
<p><img alt="image-20201216214756835" src="../imgs/image-20201216214756835.png" /></p>
<h4 id="5_10">5.   高可用小总结<a class="headerlink" href="#5_10" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201216214811880" src="../imgs/image-20201216214811880.png" /></p>
<h2 id="12-springcloud-alibaba-sentinel">12. SpringCloud Alibaba Sentinel实现熔断与限流<a class="headerlink" href="#12-springcloud-alibaba-sentinel" title="Permanent link">&para;</a></h2>
<h3 id="121-sentinel">12.1 Sentinel介绍<a class="headerlink" href="#121-sentinel" title="Permanent link">&para;</a></h3>
<h4 id="1211">12.1.1 官网<a class="headerlink" href="#1211" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Sentinel">https://github.com/alibaba/Sentinel</a></p>
<p>中文</p>
<p><a href="https://github.com/alibaba/Sentinel/wiki/介绍">https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B%E7%BB%8D</a></p>
<h4 id="1212">12.1.2 是什么<a class="headerlink" href="#1212" title="Permanent link">&para;</a></h4>
<p>一句话解释，之前我们讲解过的Hystrix</p>
<p><img alt="image-20201217090636989" src="../imgs/image-20201217090636989.png" />                               </p>
<p><img alt="image-20201217090705293" src="../imgs/image-20201217090705293.png" /></p>
<h4 id="1213">12.1.3 能干嘛<a class="headerlink" href="#1213" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201217090752905" src="../imgs/image-20201217090752905.png" /></p>
<p><img alt="image-20201217090810284" src="../imgs/image-20201217090810284.png" /></p>
<h4 id="1214">12.1.4 去哪下<a class="headerlink" href="#1214" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Sentinel/releases">https://github.com/alibaba/Sentinel/releases</a></p>
<h4 id="1215">12.1.5 怎么玩<a class="headerlink" href="#1215" title="Permanent link">&para;</a></h4>
<p><a href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_sentinel">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_sentinel</a></p>
<p><img alt="image-20201217090858346" src="../imgs/image-20201217090858346.png" /></p>
<ul>
<li>服务使用中的各种问题</li>
<li>服务雪崩</li>
<li>服务降级</li>
<li>服务熔断</li>
<li>服务限流 </li>
</ul>
<h3 id="122-sentinel">12.2 安装Sentinel控制台<a class="headerlink" href="#122-sentinel" title="Permanent link">&para;</a></h3>
<h4 id="1221-sentinel2">12.2.1 sentinel组件由2部分组成<a class="headerlink" href="#1221-sentinel2" title="Permanent link">&para;</a></h4>
<p>Sentinel 分为两个部分:</p>
<p>核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</p>
<p>控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</p>
<ul>
<li>
<p>后台</p>
</li>
<li>
<p>前台8080</p>
</li>
</ul>
<h4 id="1222">12.2.2 安装步骤<a class="headerlink" href="#1222" title="Permanent link">&para;</a></h4>
<h5 id="1_8">1.   下载<a class="headerlink" href="#1_8" title="Permanent link">&para;</a></h5>
<p><a href="https://github.com/alibaba/Sentinel/releases">https://github.com/alibaba/Sentinel/releases</a></p>
<p>下载到本地sentinel-dashboard-1.7.0.jar</p>
<h5 id="2_11">2.   运行命令<a class="headerlink" href="#2_11" title="Permanent link">&para;</a></h5>
<p>前提</p>
<p><strong>java8环境OK</strong></p>
<p><strong>8080端口不能被占用</strong></p>
<p>命令</p>
<p>java -jar sentinel-dashboard-1.7.0.jar </p>
<h5 id="3-sentinel">3.   访问sentinel管理界面<a class="headerlink" href="#3-sentinel" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost:8080">http://localhost:8080</a></p>
<p>登录账号密码均为sentinel</p>
<h3 id="123">12.3 初始化演示工程<a class="headerlink" href="#123" title="Permanent link">&para;</a></h3>
<h4 id="1231-nacos8848">12.3.1 启动Nacos8848成功<a class="headerlink" href="#1231-nacos8848" title="Permanent link">&para;</a></h4>
<p><a href="http://localhost:8848/nacos/#/login">http://localhost:8848/nacos/#/login</a></p>
<h4 id="1232">12.3.2 案例<a class="headerlink" href="#1232" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloudalibaba-sentinel-service8401">1.   创建Module：cloudalibaba-sentinel-service8401<a class="headerlink" href="#1-modulecloudalibaba-sentinel-service8401" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_11">2.   POM<a class="headerlink" href="#2-pom_11" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloudalibaba-sentinel-service8401&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt;
            &lt;artifactId&gt;sentinel-datasource-nacos&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;cn.hutool&lt;/groupId&gt;
            &lt;artifactId&gt;hutool-all&lt;/artifactId&gt;
            &lt;version&gt;4.6.3&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h5 id="3-yml_11">3.   YML<a class="headerlink" href="#3-yml_11" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 8401

spring:
  application:
    name: cloudalibaba-sentinel-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    sentinel:
      transport:
        dashboard: localhost:8080
        port: 8719  #默认8719，应用与Sentinel控制台交互的端口，应用本地会起一个该端口占用HttpServer

management:
  endpoints:
    web:
      exposure:
        include: &#39;*&#39;
</code></pre></div>
<p><img alt="image-20201217091351253" src="../imgs/image-20201217091351253.png" /></p>
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-endpoints">https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-endpoints</a></p>
<p><img alt="image-20201217091410176" src="../imgs/image-20201217091410176.png" /></p>
<h5 id="4_15">4.   主启动<a class="headerlink" href="#4_15" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@EnableDiscoveryClient
@SpringBootApplication
public class MainApp8401{
    public static void main(String[] args) {
        SpringApplication.run(MainApp8401.class, args);
    }
}
</code></pre></div>
<h5 id="5-flowlimitcontroller">5.   业务类FlowLimitController<a class="headerlink" href="#5-flowlimitcontroller" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@Slf4j
public class FlowLimitController{
    @GetMapping(&quot;/testA&quot;)
    public String testA() {
        return &quot;------testA&quot;;
    }

    @GetMapping(&quot;/testB&quot;)
    public String testB() {
        return &quot;------testB&quot;;
    }
}
</code></pre></div>
<h4 id="1233-sentinel8080">12.3.3 启动Sentinel8080<a class="headerlink" href="#1233-sentinel8080" title="Permanent link">&para;</a></h4>
<p>java -jar sentinel-dashboard-1.7.0</p>
<h4 id="1234-8401">12.3.4 启动微服务8401<a class="headerlink" href="#1234-8401" title="Permanent link">&para;</a></h4>
<h4 id="1235-8401sentienl">12.3.5 启动8401微服务后查看sentienl控制台<a class="headerlink" href="#1235-8401sentienl" title="Permanent link">&para;</a></h4>
<p>空空如也，啥都没有</p>
<p>Sentinel采用的懒加载说明</p>
<p>执行一次访问即可</p>
<p><a href="http://localhost:8401/testA">http://localhost:8401/testA</a></p>
<p><a href="http://localhost:8401/testB">http://localhost:8401/testB</a></p>
<p>效果</p>
<p><img alt="image-20201217091922615" src="../imgs/image-20201217091922615.png" /></p>
<p>结论</p>
<p>sentinel8080正在监控微服务8401</p>
<h3 id="124">12.4 流控规则<a class="headerlink" href="#124" title="Permanent link">&para;</a></h3>
<h4 id="1241">12.4.1 基本介绍<a class="headerlink" href="#1241" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201217092118633" src="../imgs/image-20201217092118633.png" /></p>
<p>进一步解释说明</p>
<p><img alt="image-20201217092210631" src="../imgs/image-20201217092210631.png" /></p>
<p><img alt="image-20201217092219675" src="../imgs/image-20201217092219675.png" /></p>
<h4 id="1242">12.4.2 流控模式<a class="headerlink" href="#1242" title="Permanent link">&para;</a></h4>
<h5 id="1_9">1.   直接（默认）<a class="headerlink" href="#1_9" title="Permanent link">&para;</a></h5>
<ul>
<li>直接-&gt;快速失败</li>
<li>
<p>系统默认</p>
</li>
<li>
<p>测试QPS</p>
</li>
<li>配置及说明<ul>
<li>表示1秒钟内查询1次就是OK,若超过次数1，就直接-快速失败，报默认错误</li>
</ul>
</li>
</ul>
<p><img alt="image-20201217092402381" src="../imgs/image-20201217092402381.png" /></p>
<ul>
<li>
<p>快速点击访问： <a href="http://localhost:8401/testA">http://localhost:8401/testA</a></p>
</li>
<li>
<p>结果</p>
</li>
<li>
<p>Blocked by Sentinel (flow limiting)</p>
</li>
<li>
<p>测试线程数</p>
</li>
</ul>
<p><img alt="image-20201217092654621" src="../imgs/image-20201217092654621.png" /></p>
<ul>
<li>
<p>快速点击访问： <a href="http://localhost:8401/testA">http://localhost:8401/testA</a></p>
</li>
<li>
<p>结果</p>
</li>
<li>不会出现Blocked by Sentinel (flow limiting)（线程处理请求很快）</li>
</ul>
<p><img alt="image-20201217093016961" src="../imgs/image-20201217093016961.png" /></p>
<p>但是，在映射方法里添加sleep后，同样也会出现Blocked by Sentinel (flow limiting)默认提示信息。</p>
<ul>
<li>思考？？？</li>
<li>直接调用默认报错信息，技术方面OK but，是否应该有我们自己的后续处理？</li>
<li>类似有一个fallback的兜底方法？</li>
</ul>
<h5 id="2_12">2.   关联<a class="headerlink" href="#2_12" title="Permanent link">&para;</a></h5>
<ul>
<li>是什么？</li>
<li>当关联的资源达到阈值时，就限流自己</li>
<li>当与A关联的资源B达到阈值后，就限流自己</li>
<li>
<p>B惹事，A挂了</p>
</li>
<li>
<ul>
<li></li>
</ul>
</li>
</ul>
<h5 id="3-a">3.   配置A<a class="headerlink" href="#3-a" title="Permanent link">&para;</a></h5>
<ul>
<li>设置效果：</li>
<li>
<p>当关联资源/testB的QPS阀值超过1时，就限流/testA的REST访问地址，当关联资源到阀值后闲置配置的的资源名。</p>
</li>
<li>
<ul>
<li><img alt="image-20201217093424147" src="../imgs/image-20201217093424147.png" /></li>
</ul>
</li>
</ul>
<h5 id="4-postmantestb">4.   postman模拟并发密集访问testB<a class="headerlink" href="#4-postmantestb" title="Permanent link">&para;</a></h5>
<ul>
<li>访问testB成功</li>
</ul>
<p><img alt="image-20201217093448293" src="../imgs/image-20201217093448293.png" /></p>
<ul>
<li>postman里新建多线程集合组，将请求保存到集合组</li>
</ul>
<p><img alt="image-20201217093523967" src="../imgs/image-20201217093523967.png" /></p>
<ul>
<li>运行线程集合组</li>
</ul>
<p><img alt="image-20201217093608092" src="../imgs/image-20201217093608092.png" /></p>
<ul>
<li>设置并发访问参数</li>
</ul>
<p><img alt="image-20201217093637824" src="../imgs/image-20201217093637824.png" /></p>
<ul>
<li>
<p>Run</p>
</li>
<li>
<p>大批量线程高并发访问B，导致A失效了</p>
</li>
<li>
<p>运行后发现testA挂了</p>
</li>
<li>点击访问http://localhost:8401/testA</li>
<li>结果<ul>
<li>Blocked by Sentinel (flow limiting)</li>
</ul>
</li>
</ul>
<h5 id="5_11">5.   链路<a class="headerlink" href="#5_11" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>多个请求调用了同一个微服务</p>
</li>
<li>
<p>家庭作业试试</p>
</li>
</ul>
<h4 id="1243">12.4.3 流控效果<a class="headerlink" href="#1243" title="Permanent link">&para;</a></h4>
<h5 id="1-">1.   直接-&gt;快速失败（默认的流控处理）<a class="headerlink" href="#1-" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>直接失败，抛出异常：Blocked by Sentinel (flow limiting)</p>
</li>
<li>
<p>源码：com.alibaba.csp.sentinel.slots.block.flow.controller.DefaultController</p>
</li>
</ul>
<h5 id="2_13">2.   预热<a class="headerlink" href="#2_13" title="Permanent link">&para;</a></h5>
<ul>
<li>说明</li>
<li>
<p>公式：阈值除以coldFactor（默认值为3），经过预热时长后才会达到阈值</p>
</li>
<li>
<p>官网： <a href="https://github.com/alibaba/Sentinel/wiki/流量控制#基于qps并发数的流量控制">https://github.com/alibaba/Sentinel/wiki/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6#%E5%9F%BA%E4%BA%8Eqps%E5%B9%B6%E5%8F%91%E6%95%B0%E7%9A%84%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6</a></p>
</li>
</ul>
<p><img alt="image-20201217095753063" src="../imgs/image-20201217095753063.png" /></p>
<p><img alt="image-20201217095814807" src="../imgs/image-20201217095814807.png" /></p>
<ul>
<li>限流 冷启动</li>
</ul>
<p><a href="https://github.com/alibaba/Sentinel/wiki/限流---冷启动">https://github.com/alibaba/Sentinel/wiki/%E9%99%90%E6%B5%81---%E5%86%B7%E5%90%AF%E5%8A%A8</a></p>
<ul>
<li>
<p>源码</p>
</li>
<li>
<p>com.alibaba.csp.sentinel.slots.block.flow.controller.WarmUpController</p>
</li>
</ul>
<p><img alt="image-20201217095948158" src="../imgs/image-20201217095948158.png" /></p>
<ul>
<li>Warmup配置</li>
</ul>
<p>默认 coldFactor 为 3，即请求 QPS 从 threshold / 3 开始，经预热时长逐渐升至设定的 QPS 阈值。
  - 案例：阈值为10 + 预热时长设置5秒。
  - 系统初始化的阈值为10/3约等于3，即阈值刚开始为3；然后过了5秒后阈值才慢慢升高，恢复到10</p>
<p><img alt="image-20201217100032982" src="../imgs/image-20201217100032982.png" /></p>
<ul>
<li>
<p>多次点击http://localhost:8401/testB</p>
</li>
<li>
<p>刚开始不行，后续慢慢OK</p>
</li>
<li>
<p>应用场景</p>
</li>
<li>如：秒杀系统在开启的瞬间，会有很多流量上来，很有可能把系统打死，预热方式就是为了保护系统，可慢慢的把流量放进来，慢慢的把阈值增长到设置的阈值。</li>
</ul>
<h5 id="3_8">3.   排队等待<a class="headerlink" href="#3_8" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>匀速排队，让请求以均匀的速度通过，阈值类型必须设置成QPS，否则无效。</p>
</li>
<li>
<p>设置含义：/testB每秒1次请求，超过的话就排队等待，等待的超时时间为20000毫秒。</p>
</li>
</ul>
<p><img alt="image-20201217100144771" src="../imgs/image-20201217100144771.png" /></p>
<ul>
<li>官网</li>
</ul>
<p><img alt="image-20201217100229034" src="../imgs/image-20201217100229034.png" /></p>
<ul>
<li>
<p>源码：com.alibaba.csp.sentinel.slots.block.flow.controller.RateLimiterController</p>
</li>
<li>
<p>测试</p>
</li>
<li>
<p>增加打印语句</p>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/testB&quot;)
public String testB() {
log.info(Thread.currentThread().getName()+&quot;\t ...testB&quot;);
return &quot;------testB&quot;;
}
</code></pre></div>
</li>
<li>
<p>增加线程组：直接10个线程并发，排队被依次处理</p>
</li>
</ul>
<p><img alt="image-20201217100413985" src="../imgs/image-20201217100413985.png" /></p>
<h3 id="125">12.5 降级规则<a class="headerlink" href="#125" title="Permanent link">&para;</a></h3>
<h4 id="1251">12.5.1 官网<a class="headerlink" href="#1251" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Sentinel/wiki/熔断降级">https://github.com/alibaba/Sentinel/wiki/%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7</a></p>
<p><img alt="image-20201217100458544" src="../imgs/image-20201217100458544.png" /></p>
<h4 id="1252">12.5.2 基本介绍<a class="headerlink" href="#1252" title="Permanent link">&para;</a></h4>
<p>整体介绍</p>
<p><img alt="image-20201217100522015" src="../imgs/image-20201217100522015.png" /></p>
<ul>
<li><strong>RT(平均响应时间,秒级)</strong></li>
<li>
<p>平均响应时间 (DEGRADE_GRADE_RT)：<strong>超过阈值</strong> <strong>且</strong> <strong>时间窗口内的请求&gt;=5</strong>，两个条件同时满足后触发降级，窗口期过后关闭断路器</p>
</li>
<li>
<p>RT 最大4900 ms，更大的需要通过启动配置项 </p>
<p>-Dcsp.sentinel.statistic.max.rt=xxx 来配置。</p>
</li>
<li>
<p><strong>异常比例（秒级）</strong></p>
</li>
<li>
<p>QPS&gt;=5且异常比例（秒级统计）超过阈值时，触发降级；时间窗口结束后，关闭降级</p>
</li>
<li>
<p><strong>异常数（分钟级）</strong></p>
</li>
<li>
<p>异常数（分钟统计）超过阈值时，触发降级；时间窗口结束后，关闭降级</p>
</li>
</ul>
<p>o  进一步说明</p>
<ul>
<li>
<p>Sentinel熔断降级会在调用链路中某个资源出现不稳定状态时（例如：调用超时或异常比例升高），对这个资源的调用进行限制，让请求快速失败，避免影响到其他的资源而导致级联错误。</p>
</li>
<li>
<p>当资源被降级后，在接下来的降级时间窗口之内，对该资源的调用都自动熔断（默认行为是抛出DegradeException）。</p>
</li>
</ul>
<p>o  Sentinel的断路器是没有半开状态的</p>
<ul>
<li>
<p>半开的状态系统自动去检测是否请求有异常，没有异常就关闭断路器恢复使用，有异常则继续打开断路器不可用。具体可以参考Hystrix</p>
</li>
<li>
<p>复习Hystrix</p>
</li>
</ul>
<p><img alt="image-20201217100759623" src="../imgs/image-20201217100759623.png" /></p>
<h4 id="1253">12.5.3 降级策略实战<a class="headerlink" href="#1253" title="Permanent link">&para;</a></h4>
<h5 id="1-rt">1.   RT<a class="headerlink" href="#1-rt" title="Permanent link">&para;</a></h5>
<ul>
<li>是什么</li>
</ul>
<p><img alt="image-20201217100904375" src="../imgs/image-20201217100904375.png" /></p>
<p><img alt="image-20201217100919189" src="../imgs/image-20201217100919189.png" /></p>
<ul>
<li>测试</li>
<li>代码</li>
</ul>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/testD&quot;)
public String testD(){
        try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { e.printStackTrace(); }
        log.info(&quot;testD 测试RT&quot;);
        return &quot;------testD&quot;;
}
</code></pre></div>
<ul>
<li>配置</li>
</ul>
<p><img alt="image-20201217101212210" src="../imgs/image-20201217101212210.png" /></p>
<ul>
<li>jmeter压测</li>
</ul>
<p><img alt="image-20201217101242952" src="../imgs/image-20201217101242952.png" /></p>
<p><img alt="image-20201217101307385" src="../imgs/image-20201217101307385.png" /></p>
<ul>
<li>
<p>结论</p>
<p>永远一秒钟打进来10个线程（大于5个了）调用testD，我们希望200毫秒处理完本次任务，</p>
<p>如果超过200毫秒还没处理完，在未来1秒钟的时间窗口内，断路器打开（保险丝跳闸）微服务不可用，保险丝跳闸断电了</p>
<p>后续停止jmeter,没有这么大的访问量了，断路器关闭（保险丝恢复），微服务恢复OK</p>
</li>
</ul>
<h5 id="2_14">2.   异常比例<a class="headerlink" href="#2_14" title="Permanent link">&para;</a></h5>
<ul>
<li>是什么</li>
</ul>
<p><img alt="image-20201217101347804" src="../imgs/image-20201217101347804.png" /></p>
<p><img alt="image-20201217101401892" src="../imgs/image-20201217101401892.png" /></p>
<ul>
<li>
<p>测试</p>
</li>
<li>
<p>代码</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/testD&quot;)
public String testD() {
        log.info(&quot;testD 测试异常比例&quot;);
        int age = 10/0;
        return &quot;------testD&quot;;
}
</code></pre></div>
<ul>
<li>配置</li>
</ul>
<p><img alt="image-20201217101642630" src="../imgs/image-20201217101642630.png" /></p>
<ul>
<li>jmeter</li>
</ul>
<p><img alt="image-20201217101703548" src="../imgs/image-20201217101703548.png" /></p>
<ul>
<li>演示</li>
</ul>
<p><img alt="image-20201217101729535" src="../imgs/image-20201217101729535.png" /></p>
<p><img alt="image-20201217101749052" src="../imgs/image-20201217101749052.png" /></p>
<ul>
<li>
<p>结论</p>
<ul>
<li>按照上述配置</li>
<li>单独访问一次，必然来一次报错一次（int age=10/0;）,调一次错一次</li>
</ul>
<p><img alt="image-20201217101817818" src="../imgs/image-20201217101817818.png" /></p>
<ul>
<li>开启jmeter后，直接高并发送请求，多次调用达到我们的配置条件了。</li>
<li>断路器开启（保险丝跳闸），微服务不可用了，不再报错error 而是服务降级了。 </li>
</ul>
</li>
</ul>
<h5 id="3_9">3.   异常数<a class="headerlink" href="#3_9" title="Permanent link">&para;</a></h5>
<ul>
<li>是什么</li>
</ul>
<p><img alt="image-20201217101851197" src="../imgs/image-20201217101851197.png" /></p>
<p><strong>时间窗口一定要大于等于60秒</strong>。</p>
<p><img alt="image-20201217101908252" src="../imgs/image-20201217101908252.png" /></p>
<ul>
<li>测试</li>
<li>代码</li>
</ul>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/testE&quot;)
public String testE(){
    log.info(&quot;testE 测试异常数&quot;);
    int age = 10/0;
    return &quot;------testE 测试异常数&quot;;
}
</code></pre></div>
<ul>
<li>
<p>配置</p>
<ul>
<li><a href="http://localhost:8401/testE">http://localhost:8401/testE</a></li>
<li>第一次访问绝对报错，因为除数不能为零，我们看到error窗口，但是达到5次报错后，进入熔断后降级。</li>
</ul>
<p><img alt="image-20201217102116330" src="../imgs/image-20201217102116330.png" /></p>
</li>
<li>
<p>手动连续点5次后，进入降级</p>
</li>
</ul>
<h3 id="126-key">12.6 热点key限流<a class="headerlink" href="#126-key" title="Permanent link">&para;</a></h3>
<h4 id="1261">12.6.1 基本介绍<a class="headerlink" href="#1261" title="Permanent link">&para;</a></h4>
<ul>
<li>是什么</li>
</ul>
<p><img alt="image-20201217102208788" src="../imgs/image-20201217102208788.png" /></p>
<h4 id="1262">12.6.2 官网<a class="headerlink" href="#1262" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Sentinel/wiki/热点参数限流">https://github.com/alibaba/Sentinel/wiki/热点参数限流</a></p>
<p><img alt="image-20201217102234242" src="../imgs/image-20201217102234242.png" /></p>
<h4 id="1263">12.6.3 承上启下复习<a class="headerlink" href="#1263" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>兜底方法</p>
</li>
<li>
<p>分为系统默认和客户自定义，两种</p>
</li>
<li>之前的case，限流出问题后，都是用sentinel系统默认的提示： Blocked by Sentinel(flow limiting)</li>
<li>我们能不能自定义？类似hystrix,某个方法出现问题了，就找对应的兜底降级方法？</li>
<li>结论<ul>
<li><strong>从@HystrixCommand到@SentinelResource</strong></li>
</ul>
</li>
</ul>
<h4 id="1264">12.6.4 代码<a class="headerlink" href="#1264" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/testHotKey&quot;)
@SentinelResource(value = &quot;testHotKey&quot;,blockHandler = &quot;deal_testHotKey&quot;)
public String testHotKey(@RequestParam(value = &quot;p1&quot;,required = false) String p1,
                         @RequestParam(value = &quot;p2&quot;,required = false) String p2) {
    //int age = 10/0;
    return &quot;------testHotKey&quot;;
}

//兜底方法
public String deal_testHotKey (String p1, String p2, BlockException exception){
    return &quot;------deal_testHotKey,o(╥﹏╥)o&quot;;  
}
</code></pre></div>
<p>com.alibaba.csp.sentinel.slots.block.BlockException</p>
<h4 id="1265">12.6.5 配置<a class="headerlink" href="#1265" title="Permanent link">&para;</a></h4>
<ul>
<li>配置</li>
</ul>
<p><img alt="image-20201217102430040" src="../imgs/image-20201217102430040.png" /></p>
<p><img alt="image-20201217102515704" src="../imgs/image-20201217102515704.png" /></p>
<ul>
<li>默认</li>
<li>@SentinelResource(value = "testHotKey")</li>
<li>异常打到了前台用户界面，不友好</li>
</ul>
<p><img alt="image-20201217102606440" src="../imgs/image-20201217102606440.png" /></p>
<ul>
<li>自定义</li>
<li>@SentinelResource(value = "testHotKey",blockHandler = "deal_testHotKey") //value值与资源名一致即可</li>
<li>
<p>方法testHostKey里面第一个参数只要QPS超过每秒1次，马上降级处理</p>
</li>
<li>
<p>测试</p>
</li>
<li>
<p>error （1秒1下可以，但是，超过则降级，和p1参数有关）</p>
<p><a href="http://localhost:8401/testHotKey?p1=abc">http://localhost:8401/testHotKey?p1=abc</a></p>
</li>
<li>
<p>error（1秒1下可以，但是，超过则降级，和p1参数有关）</p>
<p><a href="http://localhost:8401/testHotKey?p1=abc&amp;p2=33">http://localhost:8401/testHotKey?p1=abc&amp;p2=33</a></p>
</li>
<li>
<p>right（狂点不会触发降级，与p2参数无关）</p>
<p><a href="http://localhost:8401/testHotKey?p2=abc">http://localhost:8401/testHotKey?p2=abc</a></p>
</li>
</ul>
<h4 id="1266">12.6.6 参数例外项<a class="headerlink" href="#1266" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>上述案例演示了第一个参数p1,当QPS超过1秒1次点击后马上被限流</p>
</li>
<li>
<p>特殊情况</p>
</li>
<li>普通<ul>
<li>超过1秒钟一个后，达到阈值1后马上被限流</li>
</ul>
</li>
<li>我们期望p1参数当它是某个特殊值时，它的限流值和平时不一样</li>
<li>
<p>特例</p>
<ul>
<li>假如当p1的值等于5时，它的阈值可以达到200</li>
</ul>
</li>
<li>
<p>配置</p>
</li>
<li>添加按钮不能忘</li>
</ul>
<p><img alt="image-20201217102933096" src="../imgs/image-20201217102933096.png" /></p>
<ul>
<li>测试</li>
</ul>
<p><a href="http://localhost:8401/testHotKey?p1=5">http://localhost:8401/testHotKey?p1=5</a> 对</p>
<p><a href="http://localhost:8401/testHotKey?p1=3">http://localhost:8401/testHotKey?p1=3</a> 错
  - 当p1等于5的时候，阈值变为200
  - 当p1不等于5的时候，阈值就是平常的1</p>
<ul>
<li>
<p>前提条件</p>
</li>
<li>
<p>热点参数的注意点，参数必须是基本类型或者String</p>
</li>
</ul>
<p><img alt="image-20201217103034786" src="../imgs/image-20201217103034786.png" /></p>
<h4 id="1267">12.6.7 其他<a class="headerlink" href="#1267" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>手贱添加异常看看....</p>
</li>
<li>
<p>@SentinelResource</p>
</li>
<li>
<p>处理的是Sentinel控制台配置的违规情况，有blockHandler方法配置的兜底处理</p>
</li>
<li>
<p>RuntimeException</p>
</li>
<li>
<p>Int age = 10/0;这个是java运行时报出的运行时异常RuntimeException，@SentinelResource不管</p>
</li>
<li>
<p>总结：</p>
</li>
<li>@SentinelResource主管配置出错，运行出错该走异常走异常</li>
</ul>
<h3 id="127">12.7 系统规则<a class="headerlink" href="#127" title="Permanent link">&para;</a></h3>
<h4 id="1271">12.7.1 是什么<a class="headerlink" href="#1271" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Sentinel/wiki/系统自适应限流">https://github.com/alibaba/Sentinel/wiki/%E7%B3%BB%E7%BB%9F%E8%87%AA%E9%80%82%E5%BA%94%E9%99%90%E6%B5%81</a></p>
<h4 id="1272">12.7.2 各项配置参数说明<a class="headerlink" href="#1272" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201217103215173" src="../imgs/image-20201217103215173.png" /></p>
<h4 id="1273-qps">12.7.3 配置全局QPS<a class="headerlink" href="#1273-qps" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201217103232770" src="../imgs/image-20201217103232770.png" /></p>
<p><img alt="image-20201217103247227" src="../imgs/image-20201217103247227.png" /></p>
<h3 id="128-sentinelresource">12.8 @SentinelResource<a class="headerlink" href="#128-sentinelresource" title="Permanent link">&para;</a></h3>
<h4 id="1281">12.8.1 按资源名称限流+后续处理<a class="headerlink" href="#1281" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>启动Nacos成功</strong></p>
</li>
<li>
<p><strong>启动Sentinel成功</strong></p>
</li>
<li>
<p><strong>Module</strong></p>
</li>
<li>cloudalibaba-sentinel-service8401</li>
<li>POM</li>
<li>YML</li>
</ul>
<div class="highlight"><pre><span></span><code>server:
  port: 8401

spring:
  application:
    name: cloudalibaba-sentinel-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    sentinel:
      transport:
        dashboard: localhost:8080
        port: 8719  #默认8719，应用与Sentinel控制台交互的端口，应用本地会起一个该端口占用的HttpServer

management:
  endpoints:
    web:
      exposure:
        include: &#39;*&#39;
</code></pre></div>
<ul>
<li>业务类RateLimitController</li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import com.alibaba.csp.sentinel.annotation.SentinelResource;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.atguigu.springcloud.alibaba.entities.CommonResult;
import com.atguigu.springcloud.alibaba.entities.Payment;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class RateLimitController{
    @GetMapping(&quot;/byResource&quot;)
    @SentinelResource(value = &quot;byResource&quot;,blockHandler = &quot;handleException&quot;)
    public CommonResult byResource(){
        return new CommonResult(200,&quot;按资源名称限流测试OK&quot;,new Payment(2020L,&quot;serial001&quot;));
    }
    public CommonResult handleException(BlockException exception){
        return new CommonResult(444,exception.getClass().getCanonicalName()+&quot;\t 服务不可用&quot;);
    }
}
</code></pre></div>
<ul>
<li>主启动</li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@EnableDiscoveryClient
@SpringBootApplication
public class MainApp8401{
    public static void main(String[] args) {
        SpringApplication.run(MainApp8401.class, args);
    }
}
</code></pre></div>
<ul>
<li>配置流控规则</li>
<li>配置步骤</li>
</ul>
<p><img alt="image-20201217103759466" src="../imgs/image-20201217103759466.png" /></p>
<ul>
<li>图形配置和代码关系</li>
<li>
<p>表示1秒钟内查询次数大于1，就跑到我们自定义的处理，限流</p>
</li>
<li>
<p>测试</p>
</li>
<li>1秒钟点击1下，OK</li>
<li>超过上述问题，疯狂点击，返回了自己定义的限流处理信息，限流发生</li>
</ul>
<p><img alt="image-20201217103844906" src="../imgs/image-20201217103844906.png" /></p>
<ul>
<li>额外问题</li>
<li>此时关闭微服务8401看看</li>
<li>
<p>Sentinel控制台，流控规则消失了？？？？？</p>
</li>
<li>
<ul>
<li>
<ul>
<li>临时/持久？</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="1282-url">12.8.2 按照Url地址限流+后续处理<a class="headerlink" href="#1282-url" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>通过访问的URL来限流，会返回Sentinel自带默认的限流处理信息</strong></p>
</li>
<li>
<p><strong>业务类RateLimitController</strong></p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/rateLimit/byUrl&quot;)
@SentinelResource(value = &quot;byUrl&quot;)
public CommonResult byUrl(){
    return new CommonResult(200,&quot;按url限流测试OK&quot;,new Payment(2020L,&quot;serial002&quot;));
}
</code></pre></div>
<ul>
<li>
<p>访问一次</p>
</li>
<li>
<p>Sentinel控制台配置</p>
</li>
</ul>
<p><img alt="image-20201217104045682" src="../imgs/image-20201217104045682.png" /></p>
<ul>
<li>测试</li>
<li>疯狂点击http://localhost:8401/rateLimit/byUrl</li>
<li>
<p>结果</p>
</li>
<li>
<ul>
<li>
<ul>
<li>会返回Sentinel自带的限流处理结果</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img alt="image-20201217104123914" src="../imgs/image-20201217104123914.png" /></p>
<h4 id="1283">12.8.3 上面兜底方法面临的问题<a class="headerlink" href="#1283" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>系统默认的，没有体现我们自己的业务要求。</p>
</li>
<li>
<p>依照现有条件，我们自定义的处理方法又和业务代码耦合在一起，不直观。</p>
</li>
<li>
<p>每个业务方法都增加一个兜底的，那代码膨胀加剧。</p>
</li>
<li>
<p>全局统一的处理方法没有体现。</p>
</li>
</ul>
<h4 id="1284">12.8.4 客户自定义限流处理逻辑<a class="headerlink" href="#1284" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>创建customerBlockHandler类用于自定义限流处理逻辑</strong></p>
</li>
<li>
<p><strong>自定义限流处理类</strong></p>
</li>
<li><strong>方法必须是public static修饰的。</strong></li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.myhandler;

import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.atguigu.springcloud.entities.CommonResult;

public class CustomerBlockHandler {
    public static CommonResult handleException(BlockException exception){
        return new CommonResult(2020,&quot;自定义限流处理信息.... CustomerBlockHandler --- 1&quot;);
    }

    public static CommonResult handleException2(BlockException exception){
        return new CommonResult(2020,&quot;自定义限流处理信息.... CustomerBlockHandler --- 2&quot;);
    }
}
</code></pre></div>
<ul>
<li>RateLimitController</li>
</ul>
<div class="highlight"><pre><span></span><code>@GetMapping(&quot;/rateLimit/customerBlockHandler&quot;)
@SentinelResource(value = &quot;customerBlockHandler&quot;,
        blockHandlerClass = CustomerBlockHandler.class, blockHandler = &quot;handleException2&quot;)
public CommonResult customerBlockHandler(){
    return new CommonResult(200,&quot;按客戶自定义&quot;,new Payment(2020L,&quot;serial003&quot;));
}
</code></pre></div>
<ul>
<li>启动微服务后先调用一次</li>
</ul>
<p>​   <a href="http://localhost:8401/rateLimit/customerBlockHandler">http://localhost:8401/rateLimit/customerBlockHandler</a></p>
<ul>
<li>
<p>Sentinel控制台配置</p>
</li>
<li>
<p>测试后我们自定义的出来了</p>
</li>
<li>
<p>进一步说明</p>
</li>
</ul>
<p><img alt="image-20201217104406915" src="../imgs/image-20201217104406915.png" /></p>
<h4 id="1285">12.8.5 更多注解属性说明<a class="headerlink" href="#1285" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/alibaba/Sentinel/wiki/注解支持">https://github.com/alibaba/Sentinel/wiki/%E6%B3%A8%E8%A7%A3%E6%94%AF%E6%8C%81</a></p>
<p><img alt="image-20201217104449882" src="../imgs/image-20201217104449882.png" /></p>
<h3 id="129">12.9 服务熔断功能<a class="headerlink" href="#129" title="Permanent link">&para;</a></h3>
<h4 id="1291-sentinelribbonopenfeignfallback">12.9.1 sentinel整合ribbon+openFeign+fallback<a class="headerlink" href="#1291-sentinelribbonopenfeignfallback" title="Permanent link">&para;</a></h4>
<h4 id="1292-ribbon">12.9.2 Ribbon系列<a class="headerlink" href="#1292-ribbon" title="Permanent link">&para;</a></h4>
<h4 id="1-nacossentinel">1.   启动nacos和sentinel<a class="headerlink" href="#1-nacossentinel" title="Permanent link">&para;</a></h4>
<h4 id="2-90039004">2.   提供者9003/9004<a class="headerlink" href="#2-90039004" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloudalibaba-provider-payment90039004">1)  新建Module：cloudalibaba-provider-payment9003/9004<a class="headerlink" href="#1-modulecloudalibaba-provider-payment90039004" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_12">2)  POM<a class="headerlink" href="#2-pom_12" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependencies&gt;
    &lt;!--SpringCloud ailibaba nacos --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;&lt;!-- 引入自己定义的api通用包，可以使用Payment支付Entity --&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
        &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- SpringBoot整合Web组件 --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!--日常通用jar包配置--&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
        &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre></div>
<h5 id="3-yml_12">3)  YML<a class="headerlink" href="#3-yml_12" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 9003

spring:
  application:
    name: nacos-payment-provider
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 #配置Nacos地址

management:
  endpoints:
    web:
      exposure:
        include: &#39;*&#39;
</code></pre></div>
<ul>
<li><strong>记得修改不同的端口号</strong></li>
</ul>
<h5 id="4_16">4)  主启动<a class="headerlink" href="#4_16" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;

@SpringBootApplication
@EnableDiscoveryClient
public class PaymentMain9003{
    public static void main(String[] args) {
        SpringApplication.run(PaymentMain9003.class, args);
    }
}
</code></pre></div>
<h5 id="5_12">5)  业务类<a class="headerlink" href="#5_12" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import com.atguigu.springcloud.alibaba.entities.CommonResult;
import com.atguigu.springcloud.alibaba.entities.Payment;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;
import java.util.HashMap;

@RestController
public class PaymentController{
    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    public static HashMap&lt;Long, Payment&gt; hashMap = new HashMap&lt;&gt;();
    static{
        hashMap.put(1L,new Payment(1L,&quot;28a8c1e3bc2742d8848569891fb42181&quot;));
        hashMap.put(2L,new Payment(2L,&quot;bba8c1e3bc2742d8848569891ac32182&quot;));
        hashMap.put(3L,new Payment(3L,&quot;6ua8c1e3bc2742d8848569891xt92183&quot;));
    }

    @GetMapping(value = &quot;/paymentSQL/{id}&quot;)
    public CommonResult&lt;Payment&gt; paymentSQL(@PathVariable(&quot;id&quot;) Long id){
        Payment payment = hashMap.get(id);
        CommonResult&lt;Payment&gt; result = new CommonResult(200,&quot;from mysql,serverPort:  &quot;+serverPort,payment);
        return result;
    }

}
</code></pre></div>
<h5 id="6_5">6)  测试地址<a class="headerlink" href="#6_5" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost:9003/paymentSQL/1">http://localhost:9003/paymentSQL/1</a></p>
<p><a href="http://localhost:9004/paymentSQL/1">http://localhost:9004/paymentSQL/1</a></p>
<h4 id="3-84">3.   消费者84<a class="headerlink" href="#3-84" title="Permanent link">&para;</a></h4>
<h5 id="1-modulecloudalibaba-consumer-nacos-order84">1)  新建Module：cloudalibaba-consumer-nacos-order84<a class="headerlink" href="#1-modulecloudalibaba-consumer-nacos-order84" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_13">2)  POM<a class="headerlink" href="#2-pom_13" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;cloud2020&lt;/artifactId&gt;
        &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;artifactId&gt;cloudalibaba-consumer-nacos-order84&lt;/artifactId&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt;
            &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt;
            &lt;version&gt;${project.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre></div>
<h5 id="3-yml_13">3)  YML<a class="headerlink" href="#3-yml_13" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 84

spring:
  application:
    name: nacos-order-consumer
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    sentinel:
      transport:           
        dashboard: localhost:8080 #配置Sentinel dashboard地址
        port: 8719 #默认8719，应用与Sentinel控制台交互的端口，应用本地会起一个该端口占用的HttpServer

service-url:
  nacos-user-service: http://nacos-payment-provider
</code></pre></div>
<h5 id="4_17">4)  主启动<a class="headerlink" href="#4_17" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.openfeign.EnableFeignClients;

@EnableDiscoveryClient
@SpringBootApplication
@EnableFeignClients
public class OrderNacosMain84{
    public static void main(String[] args) {
        SpringApplication.run(OrderNacosMain84.class, args);
    }
}
</code></pre></div>
<h5 id="5_13">5)  业务类<a class="headerlink" href="#5_13" title="Permanent link">&para;</a></h5>
<ul>
<li>ApplicationContextConfig</li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.config;

import org.springframework.cloud.client.loadbalancer.LoadBalanced;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;

@Configuration
public class ApplicationContextConfig{
    @Bean
    @LoadBalanced
    public RestTemplate getRestTemplate() {
        return new RestTemplate();
    }
}
</code></pre></div>
<ul>
<li>CircleBreakerController的全部源码</li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.controller;

import com.alibaba.csp.sentinel.annotation.SentinelResource;
import com.alibaba.csp.sentinel.slots.block.BlockException;
import com.atguigu.springcloud.alibaba.entities.CommonResult;
import com.atguigu.springcloud.alibaba.entities.Payment;
import com.atguigu.springcloud.alibaba.service.PaymentService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;
import javax.annotation.Resource;

@RestController
@Slf4j
public class CircleBreakerController {

    public static final String SERVICE_URL = &quot;http://nacos-payment-provider&quot;;

    @Resource
    private RestTemplate restTemplate;

    @RequestMapping(&quot;/consumer/fallback/{id}&quot;)
    @SentinelResource(value = &quot;fallback&quot;) //没有配置
    //@SentinelResource(value = &quot;fallback&quot;,blockHandler = &quot;blockHandler&quot;) //blockHandler只负责sentinel控制台配置违规
    //@SentinelResource(value = &quot;fallback&quot;,fallback = &quot;handlerFallback&quot;,blockHandler = &quot;blockHandler&quot;, exceptionsToIgnore = {IllegalArgumentException.class})
    public CommonResult&lt;Payment&gt; fallback(@PathVariable(&quot;id&quot;) Long id) {
        CommonResult&lt;Payment&gt; result = restTemplate.getForObject(SERVICE_URL + &quot;/paymentSQL/{id}&quot;, CommonResult.class,id);
        if (id == 4) {
            throw new IllegalArgumentException (&quot;IllegalArgumentException,非法参数异常....&quot;);
        }else if (result.getData() == null) {
            throw new NullPointerException (&quot;NullPointerException,该ID没有对应记录,空指针异常&quot;);
        }
        return result;
    }
}
</code></pre></div>
<h4 id="4_18">4.   目的<a class="headerlink" href="#4_18" title="Permanent link">&para;</a></h4>
<p>fallback管运行异常</p>
<p>blockHandler管配置违规</p>
<p>测试地址：实现84对9003/9004的负载均衡</p>
<p><a href="http://localhost:84/consumer/fallback/1">http://localhost:84/consumer/fallback/1</a></p>
<h5 id="1_10">实验1.没有任何配置<a class="headerlink" href="#1_10" title="Permanent link">&para;</a></h5>
<p>@SentinelResource(value = "fallback")//没有配置</p>
<p>给客户error页面，不友好</p>
<p><img alt="image-20201217105014825" src="../imgs/image-20201217105014825.png" /></p>
<p><img alt="image-20201217105040289" src="../imgs/image-20201217105040289.png" /></p>
<h5 id="2fallback">实验2.只配置fallback<a class="headerlink" href="#2fallback" title="Permanent link">&para;</a></h5>
<p>@SentinelResource(value = "fallback",fallback = "handlerFallback") //fallback只负责业务异常</p>
<div class="highlight"><pre><span></span><code> //fallback
 public CommonResult&lt;Payment&gt; handlerFallback(@PathVariable(&quot;id&quot;)  Long id,Throwable e) {
        Payment payment = new Payment(id,&quot;null&quot;);
        return new CommonResult&lt;Payment&gt;(444,&quot;兜底异常handlerFallback,exception内容  &quot;+e.getMessage(),payment);
 }
</code></pre></div>
<p>测试，出现异常，会采用兜底方法展示错误消息</p>
<p><a href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a></p>
<p><img alt="image-20201217105147226" src="../imgs/image-20201217105147226.png" /></p>
<h5 id="3blockhandler">实验3.只配置blockHandler<a class="headerlink" href="#3blockhandler" title="Permanent link">&para;</a></h5>
<p>@SentinelResource(value="fallback",blockHandler="blockHandler")//blockHandler只负责sentinel控制台配置违规</p>
<div class="highlight"><pre><span></span><code>//blockHandler
public CommonResult&lt;Payment&gt; blockHandler(@PathVariable(&quot;id&quot;)  Long id, BlockException blockException) {
Payment payment = new Payment(id,&quot;null&quot;);
return new CommonResult&lt;Payment&gt;(445,&quot;blockHandler-sentinel限流,无此流水: blockException  &quot;+blockException.getMessage(),payment);
} 
</code></pre></div>
<ul>
<li>测试，出现Java异常，无人管</li>
</ul>
<p><a href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a></p>
<p><img alt="image-20201217105345529" src="../imgs/image-20201217105345529.png" /></p>
<ul>
<li>测试，出现查找不到数据异常，无人管</li>
</ul>
<p><a href="http://localhost:84/consumer/fallback/44">http://localhost:84/consumer/fallback/44</a></p>
<p><img alt="image-20201217105405495" src="../imgs/image-20201217105405495.png" /></p>
<ul>
<li>根据异常数进行降级处理</li>
</ul>
<p><img alt="image-20201217105445613" src="../imgs/image-20201217105445613.png" /></p>
<ul>
<li>测试，出现异常数超过2个，降级处理</li>
</ul>
<p><img alt="image-20201217105516627" src="../imgs/image-20201217105516627.png" /></p>
<h5 id="4fallbackblockhandler">实验4.fallback和blockHandler都配置<a class="headerlink" href="#4fallbackblockhandler" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201217105532039" src="../imgs/image-20201217105532039.png" /></p>
<ul>
<li>结论</li>
</ul>
<p><a href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a></p>
<p>allback和blockHandler都配置：不超过降级规则执行fallback兜底处理；超过降级规则抛BlockException异常，被blockHandler处理</p>
<h5 id="5_14">实验5.忽略属性…<a class="headerlink" href="#5_14" title="Permanent link">&para;</a></h5>
<p>exceptionsToIgnore = {IllegalArgumentException.class}</p>
<p>不考虑降级违规情况，发生IllegalArgumentException异常是不走兜底方法的。</p>
<h4 id="1293-feign">12.9.3 Feign系列<a class="headerlink" href="#1293-feign" title="Permanent link">&para;</a></h4>
<h4 id="1-84">1.   修改84模块<a class="headerlink" href="#1-84" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>84消费者调用提供者9003</p>
</li>
<li>
<p>Feign组件一般是消费者</p>
</li>
</ul>
<h4 id="2-pom_14">2.   POM<a class="headerlink" href="#2-pom_14" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h4 id="3-yml_14">3.   YML<a class="headerlink" href="#3-yml_14" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>server:
  port: 84

spring:
  application:
    name: nacos-order-consumer
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    sentinel:
      transport:
        dashboard: localhost:8080
        port: 8719

service-url:
  nacos-user-service: http://nacos-payment-provider

#对Feign的支持
feign:
  sentinel:
    enabled: true
</code></pre></div>
<h4 id="4_19">4.   业务类<a class="headerlink" href="#4_19" title="Permanent link">&para;</a></h4>
<ul>
<li>带@FeignClient注解的业务接口</li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.service;

import com.atguigu.springcloud.alibaba.entities.CommonResult;
import com.atguigu.springcloud.alibaba.entities.Payment;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;

@Component
@FeignClient(value = &quot;nacos-payment-provider&quot;,fallback = PaymentFallbackService.class)
public interface PaymentFeignService{
    @GetMapping(value = &quot;/paymentSQL/{id}&quot;)
    public CommonResult&lt;Payment&gt; paymentSQL(@PathVariable(&quot;id&quot;) Long id);
}
</code></pre></div>
<ul>
<li>
<p>fallback = PaymentFallbackService.class</p>
</li>
<li>
<p>PaymentFallbackService实现类</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>package com.atguigu.springcloud.alibaba.service;

import com.atguigu.springcloud.alibaba.entities.CommonResult;
import com.atguigu.springcloud.alibaba.entities.Payment;
import org.springframework.stereotype.Component;

@Component
public class PaymentFallbackService implements PaymentService{
    @Override
    public CommonResult&lt;Payment&gt; paymentSQL(@PathVariable(&quot;id&quot;) Long id){
        return new CommonResult&lt;&gt;(44444,&quot;服务降级返回,---PaymentFallbackService&quot;,new Payment(id,&quot;errorSerial&quot;));
    }
}
</code></pre></div>
<ul>
<li>CircleBreakerController</li>
</ul>
<div class="highlight"><pre><span></span><code>// OpenFeign
@Resource
private PaymentFeignService paymentService;

@GetMapping(value = &quot;/consumer/paymentSQL/{id}&quot;)
public CommonResult&lt;Payment&gt; paymentSQL(@PathVariable(&quot;id&quot;) Long id) {
    return paymentService.paymentSQL(id);
}
</code></pre></div>
<h4 id="5_15">5.   主启动<a class="headerlink" href="#5_15" title="Permanent link">&para;</a></h4>
<ul>
<li>添加@EnableFeignClients启动Feign的功能</li>
</ul>
<h4 id="6-httplocalhost84consumerpaymentsql1">6.   <a href="http://localhost:84/consumer/paymentSQL/1">http://localhost:84/consumer/paymentSQL/1</a><a class="headerlink" href="#6-httplocalhost84consumerpaymentsql1" title="Permanent link">&para;</a></h4>
<h4 id="7-849003900384">7.   测试84调用9003，此时故意关闭9003微服务提供者，看84消费侧自动降级，不会被耗死<a class="headerlink" href="#7-849003900384" title="Permanent link">&para;</a></h4>
<h4 id="194">1.9.4.    熔断框架比较<a class="headerlink" href="#194" title="Permanent link">&para;</a></h4>
<p><img alt="image-20201217105935117" src="../imgs/image-20201217105935117.png" /></p>
<h3 id="1210">12.10 规则持久化<a class="headerlink" href="#1210" title="Permanent link">&para;</a></h3>
<h4 id="12101">12.10.1 是什么<a class="headerlink" href="#12101" title="Permanent link">&para;</a></h4>
<p>一旦我们重启应用，Sentinel规则将消失，生产环境需要将配置规则进行持久化</p>
<h4 id="12102">12.10.2 怎么玩<a class="headerlink" href="#12102" title="Permanent link">&para;</a></h4>
<p>将限流配置规则持久化进Nacos保存，只要刷新8401某个rest地址，sentinel控制台的流控规则就能看到，只要Nacos里面的配置不删除，针对8401上Sentinel上的流控规则持续有效</p>
<h4 id="12103">12.10.3 步骤<a class="headerlink" href="#12103" title="Permanent link">&para;</a></h4>
<h5 id="1-cloudalibaba-sentinel-service8401">1.   修改：cloudalibaba-sentinel-service8401<a class="headerlink" href="#1-cloudalibaba-sentinel-service8401" title="Permanent link">&para;</a></h5>
<h5 id="2-pom_15">2.   POM<a class="headerlink" href="#2-pom_15" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt;
    &lt;artifactId&gt;sentinel-datasource-nacos&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div>
<h5 id="3-yml_15">3.   YML<a class="headerlink" href="#3-yml_15" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>server:
  port: 8401

spring:
  application:
    name: cloudalibaba-sentinel-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848 #Nacos服务注册中心地址
    sentinel:
      transport:
        dashboard: localhost:8080 #配置Sentinel dashboard地址
        port: 8719
      datasource:
        ds1:
          nacos:
            server-addr: localhost:8848
            dataId: cloudalibaba-sentinel-service
            groupId: DEFAULT_GROUP
            data-type: json
            rule-type: flow

management:
  endpoints:
    web:
      exposure:
        include: &#39;*&#39;

feign:
  sentinel:
    enabled: true # 激活Sentinel对Feign的支持
</code></pre></div>
<h5 id="4-nacos">4.   添加Nacos业务规则配置<a class="headerlink" href="#4-nacos" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201217110115433" src="../imgs/image-20201217110115433.png" /></p>
<ul>
<li>内容解析</li>
</ul>
<div class="highlight"><pre><span></span><code>[
    {
         &quot;resource&quot;: &quot;/rateLimit/byUrl&quot;,
         &quot;limitApp&quot;: &quot;default&quot;,
         &quot;grade&quot;: 1,
         &quot;count&quot;: 1,
         &quot;strategy&quot;: 0,
         &quot;controlBehavior&quot;: 0,
         &quot;clusterMode&quot;: false 
    }
]
</code></pre></div>
<p><img alt="image-20201217110158160" src="../imgs/image-20201217110158160.png" /></p>
<h5 id="5-8401sentinel">5.   启动8401后刷新sentinel发现业务规则有了<a class="headerlink" href="#5-8401sentinel" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201217110213567" src="../imgs/image-20201217110213567.png" /></p>
<h5 id="6_6">6.   快速访问测试接口<a class="headerlink" href="#6_6" title="Permanent link">&para;</a></h5>
<p><a href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a></p>
<p>默认</p>
<p><img alt="image-20201217110228376" src="../imgs/image-20201217110228376.png" /></p>
<h5 id="7-8401sentinel">7.   停止8401再看sentinel<a class="headerlink" href="#7-8401sentinel" title="Permanent link">&para;</a></h5>
<p><img alt="image-20201217110246120" src="../imgs/image-20201217110246120.png" /></p>
<h5 id="8-8401sentinel">8.   重新启动8401再看sentinel<a class="headerlink" href="#8-8401sentinel" title="Permanent link">&para;</a></h5>
<p>扎一看还是没有，稍等一会儿</p>
<p>多次调用</p>
<p><a href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a></p>
<p>重新配置出现了，持久化验证通过</p>

              
			  <hr><span id="busuanzi_container_page_pv"><font size="3" color="grey">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</font></span><br/>
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../SpringBoot/SpringBoot/" class="md-footer__link md-footer__link--prev" aria-label="Previous: SpringBoot" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              SpringBoot
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/git/Git%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/" class="md-footer__link md-footer__link--next" aria-label="Next: git" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              git
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 尚硅谷
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.1514a9a0.min.js"></script>
      
        <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      
    
  </body>
</html>